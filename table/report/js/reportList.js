var ReportList=function(A,C,B){this.curPage=parseInt(A);this.endEPage=parseInt(C);this.relative=B};ReportList.prototype={init:function(){var list=this;var endEPage=1;var curPage=1;if(!isNaN(this.endEPage)){endEPage=this.endEPage}if(!isNaN(this.curPage)){curPage=this.curPage}$("#endEPage").val(endEPage);if($("#pagination").length>0){$("#pagination").bootpag({total:endEPage,page:curPage,maxVisible:5,leaps:true,firstLastUse:true,first:"首页",last:"尾页",wrapClass:"pagination",activeClass:"active",disabledClass:"disabled",nextClass:"next",prevClass:"prev",lastClass:"last",firstClass:"first"}).on("page",function(event,num){$("#curPage").val(num);report.loadContentWithParam()})}$(".panel-st").each(function(){var title=$(this).attr("title");var panelId="";$(this).find(".panel-body-st").each(function(){panelId=$(this).attr("id")});var html='<div class="panel-heading-rpt">';html+='  <span class="panel-title panel-title-rpt">'+title+"</span>";html+='  <div class="panel-tools">';html+='    <a href="javascript:void(0)" onclick="report.reloadBox(\''+panelId+"')\">";html+='      <i class="icon iconfont icon-0101"></i>';html+="    </a>";html+="  </div>";html+="</div>";$(this).prepend(html)});$(".order-by").click(function(){var type=0;if($(this).hasClass("icon-sort-alpha-desc")){$(this).removeClass("icon-sort-alpha-desc").addClass("icon-sortalphaasc")}else{type=1;$(this).removeClass("icon-sortalphaasc").addClass("icon-sort-alpha-desc")}var _typeInput=$("#reportQuery-form").find("input[name=_order-type]");if(_typeInput.length==0){_typeInput=$("<input type='hidden' name='_order-type'>");$("#reportQuery-form").append(_typeInput)}_typeInput.val(type);var _colInput=$("#reportQuery-form").find("input[name=_order-col]");if(_colInput.length==0){_colInput=$("<input type='hidden' name='_order-col'>");$("#reportQuery-form").append(_colInput)}_colInput.val($(this).attr("columns"));report.loadContentWithParam()});var idx=0;$("td[points]").each(function(){var json=eval($(this).attr("points"));if(json==undefined||json.length==0){return true}var offset=$(this).css("vertical-align","top").offset();var paperDiv=$("<div id='"+idx+"' style='position:absolute;z-index:51'></div>");paperDiv.width($(this).width()+2);paperDiv.height($(this).height()+2);$("#dv").append(paperDiv);paperDiv.offset({top:offset.top,left:offset.left});var paper=new SVG(""+idx);for(var i=0;i<json.length;i+=2){paper.path("M0,0L"+json[i]+","+json[i+1]).attr({"stroke":"#000000"})}idx++});var totalWidth=$("body").width()-$(".leftbar-fixed").width();var tableWidth=$("table.tg").width();if(tableWidth>totalWidth){$("#contentDiv").width(tableWidth+5)}$("i.fold").click(function(){list.fold($(this),true)});$("i.fold").each(function(){var isHidde=$(this).hasClass("icon-minussquareo");if(isHidde){$(this).trigger("click")}else{$(this).removeClass("icon-plussquareo").addClass("icon-minussquareo")}});list.foldInit();list.initArg();$("div.pbox").each(function(){new SimpleBar($(this)[0])})},initApp:function(){var C=this.endEPage;var A=this.curPage;if(A>0&&C>1){try{AppInterface.setPage(A,C)}catch(B){}}$(".panel-st").each(function(){var F=$(this).attr("title");var E="";$(this).find(".panel-body-st").each(function(){E=$(this).attr("id")});var D='<div class="panel-heading-rpt">';D+='  <span class="panel-title panel-title-rpt">'+F+"</span>";D+='  <div class="panel-tools">';D+='    <a href="javascript:void(0)" onclick="report.reloadBox(\''+E+"')\">";D+='      <i class="icon iconfont icon-0101"></i>';D+="    </a>";D+="  </div>";D+="</div>";$(this).prepend(D)})},initForm:function(){this.init();$("input[type=radio]").iCheck({radioClass:"iradio_minimal-green"});$("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal-green"});$("input[type=radio]").on("ifChecked",function(A){$(this).attr("checked","checked")}).on("ifUnchecked",function(A){$(this).removeAttr("checked")});$("input[type=checkbox]").on("ifChecked",function(A){$(this).attr("checked","checked")}).on("ifUnchecked",function(A){$(this).removeAttr("checked")})}};ReportList.prototype.initArg=function(){var list=$("#tg");list.find("input[type=radio]").iCheck({radioClass:"iradio_minimal-green"});list.find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal-green"});var radioLinkage=function(_radioObj){var _span=_radioObj.parent().parent("span");if(_span.length==0){return false}var obj=_span.find("input[type=radio]:checked");var key=obj.attr("name");var val=obj.val();var jsons=eval("("+_span.attr("linkage")+")");for(var i=0;i<jsons.length;i++){var json=jsons[i];json.params[key]=val}report.rptLinkage(jsons)};var checkLinkage=function(_checkObj){var _span=_checkObj.parent().parent("span");if(_span.length==0){return false}var obj=_span.find("input[type=checkbox]:checked");var jsons=eval("("+_span.attr("linkage")+")");var key="";var vals=new Array();obj.each(function(){key=$(this).attr("name");vals.push($(this).val())});if(key!=""){for(var i=0;i<jsons.length;i++){var json=jsons[i];json.params[key]=vals}}report.rptLinkage(jsons)};list.find("input[type=radio]").on("ifChecked",function(event){$(this).attr("checked","checked");if($(this).attr("tq")!=undefined){radioLinkage($(this))}}).on("ifUnchecked",function(event){$(this).removeAttr("checked")});list.find("input[type=checkbox]").on("ifChecked",function(event){$(this).attr("checked","checked");if($(this).attr("tq")!=undefined){checkLinkage($(this))}}).on("ifUnchecked",function(event){$(this).removeAttr("checked");if($(this).attr("tq")!=undefined){checkLinkage($(this))}});list.find(".form_time").each(function(){report.initDate($(this));if($(this).attr("tq")!=undefined){$(this).change(function(){var _span=$(this).parent("span");if(_span.length==0){return false}var key=$(this).attr("name");var val=$(this).val();var jsons=eval("("+_span.attr("linkage")+")");for(var i=0;i<jsons.length;i++){var json=jsons[i];json.params[key]=val}report.rptLinkage(jsons)})}});list.find(".selectpicker").each(function(){var multiple=$(this).attr("multi");if(multiple=="1"){$(this).attr("title","").selectpicker({iconBase:"icon iconfont",tickIcon:"icon-check red"})}else{$(this).attr("title","").selectpicker()}if($(this).attr("tq")!=undefined){$(this).change(function(){var _span=$(this).parent().parent("span");if(_span.length==0){return false}var key=$(this).attr("name");var val=$(this).val();var jsons=eval("("+_span.attr("linkage")+")");for(var i=0;i<jsons.length;i++){var json=jsons[i];json.params[key]=val}report.rptLinkage(jsons)})}});list.find("input.input-tree").each(function(idx){var treeObj=new TreeObj(idx);treeObj.init($(this));var iconColor=$(this).attr("icon-color");if(iconColor!=undefined&&iconColor!=""){$(this).next().next().css("color",iconColor)}if($(this).attr("tq")!=undefined){$(this).change(function(){var _span=$(this).parent("span");if(_span.length==0){return false}var key=$(this).next().attr("name");var val=$(this).next().val();var jsons=eval("("+_span.attr("linkage")+")");for(var i=0;i<jsons.length;i++){var json=jsons[i];json.params[key]=val}report.rptLinkage(jsons)})}});list.find("input[type=button]").each(function(){var linkage=$(this).parent().attr("linkage");if(linkage){$(this).click(function(){var _span=$(this).parent("span");if(_span.length==0){return false}var jsons=eval("("+_span.attr("linkage")+")");report.rptLinkage(jsons)})}})};ReportList.prototype.center=function(){var A=$("body").width();var B=0;$("#contentDiv > table.tg").each(function(){var D=$(this).offset().left;B=Math.max(B,$(this).width()+D)});$("div.divclass").each(function(){var E=$(this).offset().left;var D=E+$(this).width();B=Math.max(B,D)});if(B>=A){return }var C=(A-B)/2;$("#contentDiv > table.tg").each(function(){var D=$(this).offset();$(this).offset({top:D.top,left:C+D.left})});$("div.divclass").each(function(){var D=$(this).offset();$(this).offset({top:D.top,left:C+D.left})});$("#dv").css("left",C+$("#dv").position().left).css("position","absolute")};function fixTable(J,H,O,B,M){var C=$("#"+J);if(H>=0){var I=C.find("tr");if(I.length==0){return }var A=I.parent("tbody").length>0;if(!A){C.find("tr:lt("+(settings.fixedRow+1)+")").wrapAll("<thead></thead>");C.find("tr:gt("+settings.fixedRow+")").wrapAll("<tbody></tbody>")}else{var L=$("<thead></thead>");L.append(C.find("tr:lt("+(H+1)+")").clone());L.insertBefore(C.find("tbody"));C.find("tbody > tr:lt("+(H+1)+")").remove()}}if($("#"+J+"_tableLayout").length!=0){$("#"+J+"_tableLayout").before($("#"+J));$("#"+J+"_tableLayout").empty()}else{if($("#pagination").length>0){M-=($("#pagination").parent().height()+5)}$("#"+J).after("<div id='"+J+"_tableLayout' style='overflow:hidden;height:"+M+"px; width:"+B+"px;'></div>")}$('<div id="'+J+'_tableFix"></div><div id="'+J+'_tableHead"></div><div id="'+J+'_tableColumn"></div><div id="'+J+'_tableData"></div>').appendTo("#"+J+"_tableLayout");var G=$("#"+J);var E=G.clone(true);E.attr("id",J+"_tableFixClone");$("#"+J+"_tableFix").append(E);var F=G.clone(true);F.attr("id",J+"_tableHeadClone");$("#"+J+"_tableHead").append(F);var K=G.clone(true);K.attr("id",J+"_tableColumnClone");$("#"+J+"_tableColumn").append(K);$("#"+J+"_tableData").append(G);$("#"+J+"_tableLayout table").each(function(){$(this).css("margin","0")});var D=$("#"+J+"_tableHead thead").height();D+=2;$("#"+J+"_tableHead").css("height",D);$("#"+J+"_tableFix").css("height",D);var N=0;var P=0;$("#"+J+"_tableColumn colgroup:first col:lt("+O+")").each(function(){N+=$(this).outerWidth(true);P++});$("#"+J+"_tableColumn").css("width",N);$("#"+J+"_tableFix").css("width",N);$("#"+J+"_tableData").scroll(function(){$("#"+J+"_tableHead").scrollLeft($("#"+J+"_tableData").scrollLeft());$("#"+J+"_tableColumn").scrollTop($("#"+J+"_tableData").scrollTop())});$("#"+J+"_tableFix").css({"overflow":"hidden","position":"relative","z-index":"50","background-color":"#fff"});$("#"+J+"_tableHead").css({"overflow":"hidden","width":B-17,"position":"relative","z-index":"45","background-color":"#fff"});$("#"+J+"_tableColumn").css({"overflow":"hidden","height":M-17,"position":"relative","z-index":"40","background-color":"#fff"});$("#"+J+"_tableData").css({"overflow":"auto","width":B,"height":M,"position":"relative","z-index":"35"});if($("#"+J+"_tableHead").width()>$("#"+J+"_tableFix table").width()){$("#"+J+"_tableHead").css("width",$("#"+J+"_tableFix table").width());$("#"+J+"_tableData").css("width",$("#"+J+"_tableFix table").width()+17)}if($("#"+J+"_tableColumn").height()>$("#"+J+"_tableColumn table").height()){$("#"+J+"_tableColumn").css("height",$("#"+J+"_tableColumn table").height());$("#"+J+"_tableData").css("height",$("#"+J+"_tableColumn table").height()+17)}$("#"+J+"_tableFix").offset($("#"+J+"_tableLayout").offset());$("#"+J+"_tableHead").offset($("#"+J+"_tableLayout").offset());$("#"+J+"_tableColumn").offset($("#"+J+"_tableLayout").offset());$("#"+J+"_tableData").offset($("#"+J+"_tableLayout").offset())}ReportList.prototype.fixedCell=function(D,C){if(D==-1&&C==-1){return }var B=$("body").width()-$(".leftbar-fixed").width()-13;var A=$("#table-content").height()-5;$("#table-content").css("overflow","hidden");fixTable("tg",D,C+1,B,A)};ReportList.prototype.foldInit=function(){if($("i.fold").length==0){return }$("table.tg").find("tr").each(function(){$(this).css("height","auto")});var A=$("table.tg").find("colgroup");var E="<tr>";var D=A.find("col");for(var B=0;B<D.length;B++){E+="<td style='width:"+$(D[B]).css("width")+"'></td>"}E+="</tr>";A.remove();$(E).insertBefore($("table.tg").find("tr:first"));var C=$("table.tg").find("td");C.each(function(){var F=$(this).attr("ti");if(F){if($("table.tg").find("td[tpi="+F+"]").length==0){$(this).attr("leaf",true)}}})};ReportList.prototype.fold=function(F,E){var C=this;var G=F.hasClass("icon-minussquareo");var B=F.attr("dt");var H=F.parent("td");var D=H.attr("ti");var A=$("table.tg").find("td[tpi="+D+"]");if(B=="2"){C.crossRow(F,E)}A.each(function(){var J=$(this).attr("rn");var K=$(this).attr("cn");var M=parseInt(J);var I=parseInt(K);if(B=="2"){var N=$("table.tg").find("td[cn="+K+"]");N.each(function(){var O=$(this).attr("rn");if(parseInt(O)>M){if($(this).attr("ti")){return false}if(G){$(this).hide()}else{if(C.rowShow($(this))){$(this).show()}}}})}else{var N=$("table.tg").find("td[rn="+J+"]");N.each(function(){var O=$(this).attr("cn");if(parseInt(O)>I){if($(this).attr("ti")){return false}if(G){$(this).hide()}else{if(C.colShow($(this))){$(this).show()}}}})}if(G){$(this).hide()}else{$(this).show()}if(G){var L=$(this).find("i.fold");if(L.length>0){L.each(function(){var O=$(this).hasClass("icon-minussquareo");if(O){C.fold($(this),false)}})}}});if(G){F.removeClass("icon-minussquareo").addClass("icon-plussquareo")}else{F.removeClass("icon-plussquareo").addClass("icon-minussquareo")}};ReportList.prototype.rowShow=function(E){var C=E.attr("rn");var D=$("table.tg").find("td[rn="+C+"]");var B=false;var A=false;D.each(function(){if($(this).attr("ti")){A=true;if($(this).attr("leaf")&&$(this).is(":visible")){B=true;return false}}});if(!A){return true}return B};ReportList.prototype.colShow=function(E){var D=E.attr("cn");var C=$("table.tg").find("td[cn="+D+"]");var B=false;var A=false;C.each(function(){if($(this).attr("ti")){A=true;if($(this).attr("leaf")&&$(this).is(":visible")){B=true;return false}}});if(!A){return true}return B};ReportList.prototype.crossRow=function(I,C){var A=I.hasClass("icon-minussquareo");var E=I.parent("td");var B=E.attr("ti");var F=$("table.tg").find("td[tpi="+B+"]");var G=0;var H=0;F.each(function(K){var L=$(this).attr("rn");var N=$(this).attr("cn");var M=parseInt(L);var J=parseInt(N);if(K==0){L=M}if(L==M){G+=$(this).attr("colspan")?parseInt($(this).attr("colspan")):1}});var D=E.attr("colspan")?parseInt(E.attr("colspan")):1;if(A){if(D>1){E.attr("colspan",D-G)}}else{E.attr("colspan",D+G)}if(C){this.upCrossRow(I,G,A)}};ReportList.prototype.upCrossRow=function(E,C,F){var B=this;var G=E.parent("td");var A=G.attr("tpi");var D=$("table.tg").find("td[ti="+A+"]");D.each(function(I){var H=$(this).attr("colspan")?parseInt($(this).attr("colspan")):1;if(F){if(H>1){$(this).attr("colspan",H-C)}}else{$(this).attr("colspan",H+C)}B.upCrossRow($(this),C,F)})};ReportList.prototype.resize=function(){if(this.relative=="2"){percentWidth()}else{if(this.relative=="4"){percentHeight()}else{if(this.relative=="6"){percentWidth();percentHeight()}}}chart.reDraw()};ReportList.prototype.areaResize=function(A){if(this.relative=="2"){percentWidthTg(A)}else{if(this.relative=="4"){percentHeightTg(A)}else{if(this.relative=="6"){percentWidthTg(A);percentHeightTg(A)}}}};function percentWidth(){var D=$("#table-content");D.css("overflow-x","hidden");var A=D.width()-14;var C=$("#contentDiv").children("table");var B=C.width();if(C.attr("ow")){B=parseInt(C.attr("ow"))}else{C.attr("ow",C.width())}percentWidthTable(C,B,A);C.find("table.tg").each(function(){var E=$(this).parent("div");percentWidthTg(E)})}function percentWidthTable(C,G,B){var E=B/G;var D=C.children("colgroup");var F=new Array();D.find("col").each(function(){var I=$(this).width();if($(this).attr("ow")){I=parseInt($(this).attr("ow"))}else{$(this).attr("ow",I)}var H=Math.floor(I*E);$(this).width(H);F.push(H)});C.width(B);var A=null;if(C.children("tbody").length>0){A=C.children("tbody").children("tr")}else{A=C.children("tr")}A.each(function(H){$(this).children("td").each(function(M){var S=$(this).children("div");var K=parseInt($(this).attr("colspan"));var N=$(this).attr("id");var I=N.split("_");var J=parseInt(N.split("_")[I.length-1]);var P=0;for(var R=J;R<J+K;R++){P+=F[R]}var Q=$(this).css("padding-left");var O=$(this).css("padding-right");var T=0;if(Q!=undefined){T+=parseInt(Q.substring(0,Q.length-2))}if(O!=undefined){T+=parseInt(O.substring(0,O.length-2))}if(S.length>0){if($(S[0]).hasClass("pbox")){var L=$(S[0]);L.width(P-T);L.children().width(P-T)}else{$(S[0]).width(P-T)}}})})}function percentWidthTg(A){if(A.length>0){var D=A.attr("rv");var C=A.find("table.tg");if(D=="2"||D=="6"){var B=C.width();if(C.attr("ow")){B=parseInt(C.attr("ow"))}else{C.attr("ow",C.width())}percentWidthTable(C,B,A.width())}}}function percentHeight(){var D=$("#table-content");D.css("overflow-y","hidden");var B=D.height()-12;var C=$("#contentDiv").children("table");var A=C.height();if(C.attr("oh")){A=parseInt(C.attr("oh"))}else{C.attr("oh",A)}C.height(B);percentHeighTable(C,A,B);C.find("table.tg").each(function(){var E=$(this).parent("div");percentHeightTg(E)})}function percentHeighTable(C,B,D){var F=D/B;var A=null;if(C.children("tbody").length>0){A=C.children("tbody").children("tr")}else{A=C.children("tr")}if(A!=null){var E=new Array();A.each(function(){var G=$(this).height();if($(this).attr("oh")){G=parseInt($(this).attr("oh"))}else{$(this).attr("oh",G)}var H=Math.floor(G*F);$(this).height(H);E.push(H)});A.each(function(G){$(this).children("td").each(function(M){var O=$(this).children("div");if(O.length>0){var J=$(this).css("padding-top");var P=$(this).css("padding-bottom");var Q=0;if(J!=undefined){Q+=parseInt(J.substring(0,J.length-2))}if(P!=undefined){Q+=parseInt(P.substring(0,P.length-2))}var L=parseInt($(this).attr("rowspan"));var N=0;for(var I=G;I<G+L;I++){N+=E[I]}if($(O[0]).hasClass("pbox")){var K=$(O[0]);K.height(N-Q);var H=K.children();if(H.length==2){$(H[1]).height(N-$(H[0]).height()-Q-5)}}else{$(O[0]).height(N-Q-2)}}})})}}function percentHeightTg(A){if(A.length>0){var D=A.attr("rv");var C=A.find("table.tg");if(D=="4"||D=="6"){var B=C.height();if(C.attr("oh")){B=parseInt(C.attr("oh"))}else{C.attr("oh",B)}percentHeighTable(C,B,A.height()-C.prev().height())}}}