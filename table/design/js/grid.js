(function(A){A.fn.grid=function(E){var M=":",F="=sum",N="=avg",P="=max",O="=min",R="=count",D="=",T="=group";var Q=E.rowNum,H=E.colNum,L=E.id;arg=E.arg;var S=function(){this.isRemove=false;this.mergeCell=null;this.rowSpan=1;this.colSpan=1;this.mark=-2;this.content=new Content()};S.prototype.reset=function(){this.mark=-2;this.content=new Content()};S.prototype.isValid=function(){if(!A.isEmptyObject(this.borderColor)){return true}if(this.content.available()){return true}var V=this.o;var U=B.style(V);if(U["backgroundColor"]){return true}return false};S.prototype.setColumnVal=function(V){var W=this.content;if(W==null){return }if(V==""){W.columnName="";return }W.columnType=0;if(V.indexOf(T)!=-1){W.setColumnTypeFlag(4,true);V=this.getGroupColumnText(V)}else{if(V.indexOf(F)!=-1||V.indexOf(N)!=-1||V.indexOf(P)!=-1||V.indexOf(O)!=-1||V.indexOf(R)!=-1){W.setColumnTypeFlag(5,true);var U=V.indexOf(D);V=A.trim(V.substring(U+1,V.length))}else{if(V.indexOf(D)!=-1){V=V.substr(1);W.setColumnTypeFlag(1,true)}else{W.setColumnTypeFlag(0,true)}}}W.columnName=V};S.prototype.getGroupColumnText=function(X){var Y=this.content;if(Y==null){return""}var U=X.indexOf(T);var W=U;for(var V=U;V<X.length;V++){if(X.charAt(V)==")"){W=V}}if(U!=0||W!=X.length-1){Y.contentType=4;Y.expression=X.substring(0,U+T.length+1)+X.substring(W)}return X.substring(U+T.length+1,W)};S.prototype.setCellMark=function(V){var X=this.mark;var U=this.content.disType;var W=A.trim(V);if(W.startsWith("=")){if(X!=1){this.content=new Content();this.content.disType=U}this.mark=1}else{if(W==""){if(this.mark!=-2){this.content=new Content();this.content.disType=U}this.mark=-2}else{if(this.mark!=0){this.content=new Content();this.content.disType=U}this.mark=0}}};S.prototype.setDisType=function(U){var Y=A(this.o);var X=Y.children("div");var W=Y.find("i");if(U==1){if(W.length==0){var V=A("<div></div>").css("position","absolute").css("right","0px").css("top","0px").append("<i class='icon iconfont icon-arrowsdownline red icon-size-12'></i>");X.append(V)}else{W.removeAttr("class");W.addClass("icon iconfont icon-arrowsdownline red icon-size-12")}}else{if(U==2){if(W.length==0){var V=A("<div></div>").css("position","absolute").css("right","0px").css("top","0px").append("<i class='icon iconfont icon-arrow red icon-size-12'></i>");X.append(V)}else{W.removeAttr("class");W.addClass("icon iconfont icon-arrow red icon-size-12")}}else{if(W.length>0){W.parent("div").remove()}}}};S.prototype.acceptDsColumn=function(V){if(V==""){return }if(this.rowNum>0&&this.colNum>0){var Z=A(this.o);var X=(V.substring(0,1)=="=")&&(!V.startsWith("=sum")&&!V.startsWith("=max")&&!V.startsWith("=min")&&!V.startsWith("=avg"));if(Z.children("div").length==0){var Y=A("<div></div>").css("overflow","hidden").css("position","relative").width(Z.width()).height(Z.height());var U=A("<div></div>").addClass("sv").width(Z.width()).height(Z.height()).append("<span></span>");Y.append(U);if(X){var W=A("<div></div>").css("position","absolute").css("right","0px").css("top","0px").append("<i class='icon iconfont icon-arrowsdownline red icon-size-12'></i>");Y.append(W)}Z.append(Y)}Z.find("span").html(V);this.setCellMark(V);if(X){this.content.disType=1}if(V.startsWith("=group")||V.startsWith("=GROUP")){this.content.joinType=1}}};S.prototype.getDsColumn=function(){var Y=A(this.o);var X=Y.find("span").html();if(X&&X.startsWith("=")){var V=X.split(".");var U=report.ds;if(U){for(var W in U){if("="+W==V[0]){return X}}}}return""};S.prototype.setText=function(V){this.setOnlyText(V);var U=this.content;if(U.contentType==undefined||U.contentType==1){this.setCellMark(V)}};S.prototype.setOnlyText=function(W){var Y=A(this.o);if(Y.find("div").length==0){var V=A("<span></span>").html(W);var U=A("<div></div>").addClass("sv").append(V);var X=A("<div></div>").append(U);X.css("overflow","hidden").css("position","relative").width(Y.width()).height(Y.height()).appendTo(Y);U.width(Y.width()).height(Y.height())}else{Y.find("span").html(W)}};S.prototype.setImage=function(W,V,X){var Z=A(this.o);if(Z.find("div").length==0){var U=A("<div></div>").addClass("sv").append(W);var Y=A("<div></div>").append(U);Y.css("overflow","hidden").css("position","relative").width(V).height(X).appendTo(Z);U.width(V).height(X)}else{Z.find("div.sv").empty().append(W)}};S.prototype.setIcon=function(U,W){var Y=A(this.o);var V=null;if(Y.children("div").length==0){var X=A("<div></div>").css("overflow","hidden").css("position","relative").width(Y.width()).height(Y.height());V=A("<div></div>").addClass("sv").width(Y.width()).height(Y.height()).append("<span></span>");X.append(V);Y.append(X)}else{V=Y.find("div.sv")}V.find("i").remove();if(V.find("span").length==0){V.append(U)}else{if(!W){A(""+U).insertBefore(V.find("span"))}else{V.append(U)}}};S.prototype.changeIconPos=function(W){var X=A(this.o);var U=X.find("div.sv");var V=U.find("i").clone();U.find("i").remove();if(!W){V.insertBefore(U.find("span"))}else{V.insertAfter(U.find("span"))}};S.prototype.setSubReportImage=function(){var W=A(this.o);if(W.find("div").length==0){var U=A("<div></div>").addClass("sv").append("<i class='icon iconfont icon-report fa-lg' style='font-size:16px'></i>");var V=A("<div></div>").append(U);V.css("overflow","hidden").css("position","relative").width(W.width()).height(W.height()).appendTo(W);U.width(W.width()).height(W.height())}else{W.find("div.sv").empty().append("<i class='icon iconfont icon-report fa-lg' style='font-size:16px'></i>")}};S.prototype.setTableIcon=function(){var W=A(this.o);if(W.find("div").length==0){var U=A("<div></div>").addClass("sv").append("<i class='icon iconfont icon-table fa-lg' style='font-size:24px'></i>");var V=A("<div></div>").append(U);V.css("overflow","hidden").css("position","relative").width(W.width()).height(W.height()).appendTo(W);U.width(W.width()).height(W.height())}else{W.find("div.sv").empty().append("<i class='icon iconfont icon-table fa-lg' style='font-size:16px'></i>")}};S.prototype.getText=function(){var U=A(this.o);return U.find("span").text()};var K=function(){this.maxNum=0;this.firstRow=0;this.lastRow=0;this.firstCol=0;this.lastCol=0;this.isRectangle=true;this.setRect=function(U){if(U==null){return }if(U.rowNum<this.firstRow){this.firstRow=U.rowNum;this.isRectangle=false}if(U.rowNum+U.rowSpan-1>this.lastRow){this.lastRow=U.rowNum+U.rowSpan-1;this.isRectangle=false}if(U.colNum<this.firstCol){this.firstCol=U.colNum;this.isRectangle=false}if(U.colNum+U.colSpan-1>this.lastCol){this.lastCol=U.colNum+U.colSpan-1;this.isRectangle=false}this.maxNum++};this.isGoRectangle=function(){if(this.isRectangle||this.maxNum>100){return false}return true}};var J=function(V){this.div=V.tbdiv.find(".tdinput");this.texti=this.div.find("textarea");this.editTd=null;var U=this;var W=0;this.texti.keydown(function(){var X=A(this)[0].scrollWidth;if(W==0){W=X}if(X>W){A(this).width(X);W=A(this)[0].scrollWidth}});this.texti.blur(function(){U.div.hide();if(U.editTd!=null){var a=U.texti.val();a=a.replace(/\n/g,"<br/>");a=a.replace(/\s/g,"&nbsp;");if(U.editTd.find("div").length==0){var Y=A("<span></span>").html(a);var X=A("<div></div>").addClass("sv").append(Y);var b=A("<div></div>").append(X);b.css("overflow","hidden").css("position","relative").width(U.editTd.width()).height(U.editTd.height()).appendTo(U.editTd);X.width(U.editTd.width()).height(U.editTd.height())}else{U.editTd.find("span").html(a)}var Z=U.editTd.data("gc");Z.setCellMark(a)}U.texti.val("");B.showBorderColor()})};J.prototype.startEdit=function(W){this.div.show();B.hideBorderColor();this.editTd=W;var U=W.offset();this.div.offset({left:U.left,top:U.top});this.texti.width(W.width()).height(W.height());var V=W.find("span").html();if(V){V=V.replace(/<br>/g,"\n").replace(/<br\/>/g,"\n").replace(/\&nbsp\;/g," ");this.texti.val(V)}this.texti.focus()};var I=function(){this.x=0;this.w=0;this.y=0;this.h=0};var G=function(){var V=this;this.rowNum=Q?Q:26;this.colNum=H?H:20;this.rect=new I();this.colWidth=90;this.firstColWidth=40;this.rowHeight=19;this.d=A(document);this.tb=A("#"+L);this.tbdoc=document.getElementById(L);this.tbdiv=this.tb.parent("div");this.textedit=new J(V);this.selectedGridCell=null;this.shiftGridCell=null;this.tempGridCell=null;this.tempShiftGridCell=null;this.tdClickHandler=function(Y){if(cellSelectedFlag){V.tempShiftGridCell=null;var W=A(this).data("gc");if(Y.shiftKey){V.tempShiftGridCell=W}else{V.tempGridCell=W}V.cellSelectBorderColor();return false}V.shiftGridCell=null;var X=true;var W=A(this).data("gc");if(Y.shiftKey){V.shiftGridCell=W}else{V.selectedGridCell=W}V.cellBorderColor();if(X){anyExcel.setToolMenuStyle(A(this));anyExcel.setRightProperty(A(this));anyExcel.setRightArgProperty(A(this))}if(A("li.tl-cell-line").hasClass("tl-hover")){V.startDrawCellLine(V.selectedGridCell);A("li.tl-cell-line").removeClass("tl-hover")}};this.tddbClickHandler=function(Y){var X=V.selectedGridCell;if(X==null){return false}if(X.mark==2){return false}if(X.mark==3){anyExcel.chartsettting(X.content);return false}if(X.mark==6){A("li.tl-insert-sub-report").trigger("click");return false}if(X.mark==5){A("li.tl-insert-image").trigger("click");return false}if(X.mark==7){return false}if(X.mark==8){var W=X.content.cellPanel;if(W.mark==3){anyExcel.chartsettting(W.chartCell)}else{if(W.mark==6){A("li.tl-insert-cell-panel-subreport").trigger("click")}}return false}V.textedit.startEdit(A(this))};var U=null;this.tdContextmenuHandler=function(Z){var W=function(){U=B.selectedGridCell};var Y=function(){if(U!=null){var c=A(U.o);var a=B.selectedGridCell;if(a!=null){a.content=U.content;a.mark=U.mark;var b=A(a.o);b.empty().append(c.children().clone(true))}U=null}};var X=[{title:"复制",icon:"icon iconfont icon-copy",fn:W},{title:"粘贴",icon:"icon iconfont icon-paste",fn:Y}];basicContext.show(X,Z.originalEvent,true)}};G.prototype={init:function(){this.createFirstGridRow();for(var U=1;U<this.rowNum;U++){this.addGridRow(U)}this.resizable();this.areaDrag();if(!arg){this.syncGridDivs()}},createFirstGridRow:function(){var Y=A("<tr></tr>").addClass("tbheader");var b=0;for(var X=0;X<this.colNum;X++){var W=(X>0)?C.getLetter(X+64):"";var a=A("<td></td>");var Z=A("<div></div>");Z.css("overflow","hidden").html(W).appendTo(a);var V=X==0?this.firstColWidth:this.colWidth;a.width(V).addClass("fr");Z.width(V-1);Y.append(a);b+=V;if(X==0){a.parent().height(this.rowHeight)}var U=new S();U.rowNum=0;U.colNum=X;U.o=a;a.data("gc",U)}this.tb.append(Y);this.tb.parent("div").width(b)},addGridRow:function(Z){var W=document.createDocumentFragment();var X=document.createElement("tr");for(var V=0;V<this.colNum;V++){var b=document.createElement("td");var Y=A(b);if(V==0){var a=document.createElement("div");a.innerHTML=Z;a.style.overflow="hidden";b.appendChild(a);Y.addClass("tbheader").addClass("fc");Y.parent().height(this.rowHeight)}X.appendChild(b);W.appendChild(X);if(V>0){Y.bind("click",this.tdClickHandler);Y.bind("dblclick",this.tddbClickHandler);Y.on("contextmenu",this.tdContextmenuHandler)}var U=new S();U.rowNum=Z;U.colNum=V;U.o=b;Y.data("gc",U)}this.tbdoc.appendChild(W)},insertRow:function(){var Z=this;var V=this.selectedGridCell;if(V==null){return }var d=V.rowNum;var c=Z.tb.find("tr:first").find("td");var e=A("<tr></tr>");for(var W=0;W<c.length;W++){var X=A("<td></td>");if(W>0){X.bind("click",Z.tdClickHandler);X.bind("dblclick",Z.tddbClickHandler);X.on("contextmenu",Z.tdContextmenuHandler)}var Y=new S();Y.rowNum=d;Y.colNum=W;Y.o=X;X.data("gc",Y);if(W==0){var U=A("<div></div>").css("overflow","hidden");U.appendTo(X);U.html(d);X.addClass("tbheader").parent().height(Z.rowHeight);e.append(X);X.on("contextmenu",function(g){anyExcel.fcOnContextmenu(g)});continue}var f=Z.findGridCell(d,W);if(f.isRemove){if(f.rowNum!=f.mergeCell.rowNum){X.hide();Y.isRemove=true;Y.mergeCell=f.mergeCell;if(f.mergeCell.colNum==Y.colNum){f.mergeCell.rowSpan=f.mergeCell.rowSpan+1;var h=A(f.mergeCell.o);h.attr("rowSpan",f.mergeCell.rowSpan)}}}e.append(X)}var b=Z.tb.children(":eq("+d+")");e.insertBefore(b);var a=Z.tb.children(":gt("+d+")");a.each(function(j){var g=A(this);g.children("td").each(function(i){var k=A(this);var l=k.data("gc");l.rowNum=l.rowNum+1;if(i==0){if(k.find("div").length>0){k.find("div").html(l.rowNum)}else{k.html(l.rowNum)}}})});Z.resetResizable();Z.cellBorderColor();Z.rowNum++},insertColumn:function(){var e=this;var X=this.selectedGridCell;if(X==null){return }var V=X.colNum;var f=e.tb.children();for(var d=0;d<f.length;d++){var W=(d==0)?C.getLetter(V+64):"";var b=A("<td></td>");if(d==0){var U=A("<div></div>").css("overflow","hidden");U.appendTo(b);U.html(W).width(e.colWidth);b.on("contextmenu",function(g){anyExcel.frOnContextmenu(g)})}if(d>0){b.bind("click",e.tdClickHandler);b.bind("dblclick",e.tddbClickHandler);b.on("contextmenu",e.tdContextmenuHandler)}var c=new S();c.rowNum=d;c.colNum=V;c.o=b;b.data("gc",c);var a=e.findTd(d,V);var h=a.data("gc");if(d==0){b.width(e.colWidth);b.insertBefore(a);continue}if(h.isRemove){if(h.colNum!=h.mergeCell.colNum){b.hide();c.isRemove=true;c.mergeCell=h.mergeCell;if(h.mergeCell.rowNum==c.rowNum){h.mergeCell.colSpan=h.mergeCell.colSpan+1;var j=A(h.mergeCell.o);j.attr("colspan",h.mergeCell.colSpan)}}}b.insertBefore(a)}for(var d=0;d<f.length;d++){var Z=(d==0)?e.tb.find("tr:first"):A(f[d]);Z.children(":gt("+V+")").each(function(){var g=A(this);var i=g.data("gc");i.colNum=i.colNum+1;if(d==0){if(g.find("div").length>0){g.find("div").html(C.getLetter(i.colNum+64))}else{g.html(C.getLetter(i.colNum+64))}}})}var Y=e.tb.parent("div");Y.width(Y.width()+e.colWidth);e.resetResizable();e.cellBorderColor();e.colNum++},newAddRow:function(X){var V=this;var U=V.tb.children();var W=U.length;V.addGridRow(W);if(!X){V.resetResizable()}V.rowNum++},newAddColumn:function(d){var a=this;var b=a.tb.children();for(var Z=0;Z<b.length;Z++){var W=A(b[Z]);if(Z==0){W=a.tb.find("tr:first")}var X=A("<td></td>");var Y=0;if(Z==0){var U=A("<div></div>").css("overflow","hidden");U.appendTo(X);Y=W.find("td").length;U.html(C.getLetter(Y+64)).width(a.colWidth).height(a.rowHeight-1);X.width(a.colWidth);X.on("contextmenu",function(f){anyExcel.frOnContextmenu(f)})}else{Y=W.children().length;X.bind("click",a.tdClickHandler);X.bind("dblclick",a.tddbClickHandler);X.on("contextmenu",a.tdContextmenuHandler)}var c=new S();c.rowNum=Z;c.colNum=Y;c.o=X;X.data("gc",c);W.append(X)}var V=a.tb.parent("div");V.width(V.width()+a.colWidth);if(!d){a.resetResizable()}a.colNum++},deleteRow:function(){var Y=this;var V=this.selectedGridCell;if(V==null){return }var e=V.rowNum;var b=Y.tb.children(":eq("+e+")");var W=b.children("td");for(var X=0;X<W.length;X++){var h=A(W[X]);var f=h.data("gc");if(f.isRemove&&f.colNum==f.mergeCell.colNum){f.mergeCell.rowSpan=f.mergeCell.rowSpan-1;var d=Y.findTd(f.mergeCell.rowNum,f.mergeCell.colNum);if(d){d.attr("rowspan",f.mergeCell.rowSpan)}}}b.remove();var Z=Y.tb.children();for(var U=e;U<Z.length;U++){var W=A(Z[U]).children("td");for(var a=0;a<W.length;a++){var h=A(W[a]);var V=h.data("gc");V.rowNum=V.rowNum-1;if(a==0){h.find("div").empty().html(V.rowNum)}}}Y.rowNum--;Y.clearCellBorderColor();Y.resetResizable()},deleteCol:function(){var Y=this;var V=this.selectedGridCell;if(V==null){return }var U=V.colNum;var Z=Y.tb.children();for(var X=0;X<Z.length;X++){var W=A(Z[X]);var f=null;if(X==0){f=W.find("td:eq("+U+")")}else{f=W.children("td:eq("+U+")")}var e=f.data("gc");if(e.colNum==0){continue}if(e.isRemove&&e.rowNum==e.mergeCell.rowNum){e.mergeCell.colSpan=e.mergeCell.colSpan-1;var d=Y.findTd(e.mergeCell.rowNum,e.mergeCell.colNum);if(d){d.attr("colspan",e.mergeCell.colSpan)}}f.remove()}for(var X=0;X<Z.length;X++){var W=A(Z[X]);var a=null;if(X==0){a=W.find("td")}else{a=W.children()}for(var b=U;b<a.length;b++){var f=A(a[b]);var V=f.data("gc");V.colNum=V.colNum-1;if(X==0){f.find("div").empty().html(C.getLetter(V.colNum+64))}}}Y.colNum--;Y.clearCellBorderColor();Y.resetResizable()},resetResizable:function(){var U=this.tbdiv.children("div.JCLRgrips");var V=this.tbdiv.children("div.JRWRgrips");U.empty();V.empty();this.resizable()}};G.prototype.isMergeFlag=function(){var U=this;if(U.selectedGridCell==null){return false}if(U.selectedGridCell.rowSpan>1||U.selectedGridCell.colSpan>1){if(U.shiftGridCell!=null&&U.shiftGridCell!=U.selectedGridCell){return false}return true}return false};G.prototype.cellBorderColor=function(){var Z=this;if(Z.selectedGridCell==null){return }if(Z.shiftGridCell!=null){var U=C.calMergeGridCell(Z.selectedGridCell,Z.shiftGridCell,Z.tb.find("tr"));Z.selectedGridCell=Z.findGridCell(U.firstRow,U.firstCol);Z.shiftGridCell=Z.findGridCell(U.lastRow,U.lastCol)}var X=Z.findTd(Z.selectedGridCell.rowNum,Z.selectedGridCell.colNum);var e=X.offset();var c=X.width();var Y=X.height();if(Z.shiftGridCell!=null){var b=Z.shiftGridCell.isRemove?Z.shiftGridCell.mergeCell:Z.shiftGridCell;var d=Z.findTd(b.rowNum,b.colNum);c=d.offset().left-e.left+d.width();Y=d.offset().top-e.top+d.height()}var a=Z.tbdiv.children(".tdborders").find(".selected").find("div.tdborder");for(var W=0;W<a.length;W++){var V=A(a[W]);if(W==0){V.offset({left:e.left,top:e.top}).height(2).width(c)}else{if(W==1){V.offset({left:e.left+c,top:e.top}).height(Y).width(2)}else{if(W==2){V.offset({left:e.left,top:e.top+Y}).height(2).width(c)}else{if(W==3){V.offset({left:e.left,top:e.top}).height(Y).width(2)}else{if(W==4){if(!V.is(":visible")){V.show()}V.offset({left:e.left+c-3,top:e.top+Y-3}).height(5).width(5)}}}}}}Z.rect.x=e.left;Z.rect.y=e.top;Z.rect.w=c;Z.rect.h=Y;Z.selectRowColBgColor();if(Z.selectedGridCell!=null){anyExcel.cellContent(C.getLetter(Z.selectedGridCell.colNum+64)+Z.selectedGridCell.rowNum)}};G.prototype.clearCellBorderColor=function(){this.selectedGridCell=null;this.shiftGridCell=null;this.tb.children().each(function(){A(this).children(":first").removeClass("td-active")});this.tb.children(":first").find("td").removeClass("td-active");var W=this.tbdiv.children(".tdborders").find(".selected").find("div.tdborder");for(var V=0;V<W.length;V++){var U=A(W[V]);if(V==4){U.hide()}else{U.offset({left:0,top:0}).height(0).width(0)}}};G.prototype.hideBorderColor=function(){this.tbdiv.children(".tdborders").find(".selected").hide()};G.prototype.showBorderColor=function(){this.tbdiv.children(".tdborders").find(".selected").show()};G.prototype.canBorderColor=function(e,V,a){var b=this;if(V!=null){var U=C.calMergeGridCell(e,V,b.tb.find("tr"));e=b.findGridCell(U.firstRow,U.firstCol);V=b.findGridCell(U.lastRow,U.lastCol)}a.startCell=e;a.endCell=V;var Z=b.findTd(e.rowNum,e.colNum);var k=Z.offset();var f=Z.outerWidth(false);var Y=Z.height();if(V!=null){var d=V.isRemove?V.mergeCell:V;var j=b.findTd(d.rowNum,d.colNum);f=j.offset().left-k.left+j.outerWidth(false);Y=j.offset().top-k.top+j.height()}var c=b.tbdiv.find(".canselected").find("div.tdborder");for(var X=0;X<c.length;X++){var W=A(c[X]);if(X==0){W.offset({left:k.left,top:k.top}).height(1).width(f)}else{if(X==1){W.offset({left:k.left+f,top:k.top}).height(Y+1).width(1)}else{if(X==2){W.offset({left:k.left,top:k.top+Y}).height(1).width(f+1)}else{if(X==3){W.offset({left:k.left,top:k.top}).height(Y).width(1)}}}}}};G.prototype.clearCanBorderColor=function(){var W=this.tbdiv.find(".canselected").find("div.tdborder");for(var V=0;V<W.length;V++){var U=A(W[V]);U.offset({left:0,top:0});U.height(0).width(0)}};G.prototype.cellSelectBorderColor=function(Y){var c=this;if(c.tempGridCell==null){return }if(c.tempShiftGridCell!=null){var W=C.calMergeGridCell(c.tempGridCell,c.tempShiftGridCell,c.tb.find("tr"));c.tempGridCell=c.findGridCell(W.firstRow,W.firstCol);c.tempShiftGridCell=c.findGridCell(W.lastRow,W.lastCol)}var a=c.findTd(c.tempGridCell.rowNum,c.tempGridCell.colNum);var k=a.offset();var f=a.width();var b=a.height();if(c.tempShiftGridCell!=null){var d=c.tempShiftGridCell.isRemove?c.tempShiftGridCell.mergeCell:c.tempShiftGridCell;var j=c.findTd(d.rowNum,d.colNum);f=j.offset().left-k.left+j.width();b=j.offset().top-k.top+j.height()}var V=this.tbdiv.find(".cellselected").find("div.tdborder-dashed");V.show().offset({left:k.left,top:k.top}).height(b).width(f);var e=c.tempGridCell.rowNum;var U=c.tempGridCell.colNum;var i="";if(this.parent!=undefined){var Z=this.parent;i=C.getLetter(Z.colNum+64)+Z.rowNum;i+="-"}var X=i+C.getLetter(U+64)+e;if(c.tempShiftGridCell!=null){e=c.tempShiftGridCell.rowNum;U=c.tempShiftGridCell.colNum;X+=":"+(i+C.getLetter(U+64)+e)}anyExcel.setSelectCellText(X)};G.prototype.clearSelectBorderColor=function(){this.tempGridCell=null;this.tempShiftGridCell=null;var U=this.tbdiv.find(".cellselected").find("div.tdborder-dashed");U.hide()};G.prototype.selectRowColBgColor=function(){this.tb.children().each(function(){A(this).children(":first").removeClass("td-active")});this.tb.children(":first").find("td").removeClass("td-active");var V=this.tb.children(":first");var W=this.selectedGridCell.colNum;var Y=this.shiftGridCell!=null?this.shiftGridCell.colNum:W+this.selectedGridCell.colSpan-1;var U=this.selectedGridCell.rowNum;var X=this.shiftGridCell!=null?this.shiftGridCell.rowNum:U+this.selectedGridCell.rowSpan-1;V.find("td").each(function(Z){if(Z>=W&&Z<=Y){A(this).addClass("td-active")}});this.tb.children().each(function(a){if(a>=U&&a<=X){var Z=A(this).find("td:first");Z.addClass("td-active")}})};G.prototype.findGridCell=function(W,U){var V=this.tb.children(":eq("+W+")");var X=V.children(":eq("+U+")");return X.data("gc")};G.prototype.findTd=function(V,U){if(V==0){return this.tb.children(":eq("+V+")").find("td:eq("+U+")")}return this.tb.children(":eq("+V+")").children(":eq("+U+")")};G.prototype.mergeCell=function(){var Y=this;if(Y.selectedGridCell==null){return }if(Y.shiftGridCell==null){return }var U=C.calMergeGridCell(Y.selectedGridCell,Y.shiftGridCell,Y.tb.find("tr"));Y.selectedGridCell=Y.findGridCell(U.firstRow,U.firstCol);Y.shiftGridCell=Y.findGridCell(U.lastRow,U.lastCol);for(var X=U.firstRow;X<=U.lastRow;X++){for(var V=U.firstCol;V<=U.lastCol;V++){var W=Y.findTd(X,V);if(X==U.firstRow&&V==U.firstCol){Y.selectedGridCell.rowSpan=U.lastRow-X+1;Y.selectedGridCell.colSpan=U.lastCol-V+1;if(W.length>0){W.attr("rowspan",Y.selectedGridCell.rowSpan).attr("colspan",Y.selectedGridCell.colSpan);var a=W.children("div");a.height(W.height());a.width(W.width());W.find("div.sv").height(W.height());W.find("div.sv").width(W.width())}}else{if(W.length>0){var Z=W.data("gc");Z.isRemove=true;Z.mergeCell=Y.selectedGridCell;W.hide()}}}}};G.prototype.mergeTdCell=function(Y){if(Y.rowSpan>1||Y.colSpan>1){for(var X=Y.rowNum;X<Y.rowNum+Y.rowSpan;X++){for(var V=Y.colNum;V<Y.colNum+Y.colSpan;V++){var W=this.findTd(X,V);if(X==Y.rowNum&&V==Y.colNum){W.attr("rowspan",Y.rowSpan).attr("colspan",Y.colSpan)}else{var U=W.data("gc");U.isRemove=true;U.mergeCell=Y;W.hide()}}}}};G.prototype.divideCell=function(){var X=this;if(X.selectedGridCell.rowSpan>1||X.selectedGridCell.colSpan>1){for(var W=X.selectedGridCell.rowNum;W<X.selectedGridCell.rowNum+X.selectedGridCell.rowSpan;W++){for(var U=X.selectedGridCell.colNum;U<X.selectedGridCell.colNum+X.selectedGridCell.colSpan;U++){var V=X.findTd(W,U);if(V.length==0){continue}var Y=V.data("gc");if(W==X.selectedGridCell.rowNum&&U==X.selectedGridCell.colNum){this.syncGridRowDivs(V,this.getFirstGridCellHeight(Y),true);this.syncGridColDivs(V,this.getFirstGridCellWidth(Y),true);V.attr("rowspan",1).attr("colspan",1)}else{Y.isRemove=false;Y.mergeCell=null;Y.rowSpan=1;Y.colSpan=1;V.attr("rowspan",1).attr("colspan",1);V.show()}}}X.selectedGridCell.rowSpan=1;X.selectedGridCell.colSpan=1;return }};G.prototype.unMergeCell=function(Z){var Y=this;for(var X=Z.rowNum;X<=Z.rowNum+Z.rowSpan;X++){for(var V=Z.colNum;V<=Z.colNum+Z.colSpan;V++){var W=Y.findTd(X,V);if(W.length==0){continue}var U=W.data("gc");if(X==U.rowNum&&V==U.colNum){this.syncGridRowDivs(W,this.getFirstGridCellHeight(U),true);this.syncGridColDivs(W,this.getFirstGridCellWidth(U),true);W.attr("rowspan",1).attr("colspan",1)}else{U.isRemove=false;U.mergeCell=null;W.show()}}}Z.rowSpan=1;Z.colSpan=1};G.prototype.resizable=function(){var V=this;var f="JColResizer";var a="JRWResizer";var d=null;var e=function(m){var l=A(this);l.ox=m.pageX;l.l=l.position().left;l.x=l.l;l.w=l.data("c").width();var n=V.tb.parent("div");l.tw=n.width();V.d.bind("mousemove."+f,h).bind("mouseup."+f,j);d=l};var k=this.tb.find("tr:first");var i=this.tbdiv.children(".JCLRgrips");k.find("td").each(function(l){var n=A(this);var m=A('<div class="JCLRgrip"></div>');m.append('<div class="'+f+'"></div>');i.append(m);if(l>0){m.bind("mousedown",e)}m.height(n.outerHeight(false));m.css({left:n.offset().left-V.tb.offset().left+n.outerWidth(false)});m.data("c",n)});var b=function(m){var l=A(this);l.oy=m.pageY;l.top=l.position().top;l.y=l.top;var n=l.data("c");l.rh=n.height();V.d.bind("mousemove.JRWResizer",X).bind("mouseup.JRWResizer",U);d=l};var g=this.tbdiv.children(".JRWRgrips");var k=this.tb.children();k.each(function(l){var p=A(this);var n=document.createElement("div");n.setAttribute("class","JRWRgrip");var m=document.createElement("div");m.setAttribute("class","JRWResizer");n.appendChild(m);g.append(n);var o=A(n);if(l>0){o.bind("mousedown",b)}var q=p.find("td:first");o.width(q.outerWidth());o.css({top:p.offset().top-V.tb.offset().top+q.outerHeight(false)+"px"});o.data("c",q)});var h=function(n){if(!d){return }var m=n.pageX;var l=m-d.ox+d.l;d.x=l;d.css("left",l+"px");Y();W();V.cellBorderColor();n.preventDefault();return false};var j=function(n){V.d.unbind("mousemove."+f,h).unbind("mouseup."+f,j);if(!d){return }var m=n.pageX;var l=m-d.ox+d.l;d.x=l;d.css("left",l+"px");Y();W();V.cellBorderColor();V.drawExtendUnitsBorder(report.extendUnits);d=null};var X=function(n){if(!d){return }var l=n.pageY;var o=l-d.oy+d.top;var m=5;o=Math.max(m,o);d.y=o;d.css("top",o+"px");c();Z();V.cellBorderColor();n.preventDefault();return false};var U=function(l){V.d.unbind("mouseup.JRWResizer",U).unbind("mousemove.JRWResizer",X);if(!d){return }if(!(d.y-d.top==0)){c();Z();V.cellBorderColor()}V.drawExtendUnitsBorder(report.extendUnits);d=null};var Y=function(){var m=d.x-d.l;var l=d.w+m;var o=V.tb.parent("div");o.width(d.tw+m);var n=d.data("c");n.width(d.w+m);V.syncGridColDivs(n,d.w+m)};var W=function(){var l=V.tb.find("tr:first");var m=V.tbdiv.children(".JCLRgrips").children("div");l.find("td").each(function(n){var o=A(this);A(m[n]).css({left:o.offset().left-V.tb.offset().left+o.outerWidth(false)})})};var c=function(){var m=d.y-d.top;var l=d.rh;var n=d.data("c");n.parent().height(l+m);V.syncGridRowDivs(n,l+m)};var Z=function(){var l=V.tb.children();var m=V.tbdiv.children(".JRWRgrips").children("div");l.each(function(n){var p=A(this);var q=p.find("td:first");var o=A(m[n]);o.css({top:p.offset().top-V.tb.offset().top+q.outerHeight(false)+"px"})})}};G.prototype.syncArgGrips=function(){var U=this.tb.find("tr:first");var V=this.tbdiv.find("div.JCLRgrip");U.find("td").each(function(X){var Z=A(this);var Y=A(V[X]);Y.height(Z.outerHeight(false));Y.css({left:Z.offset().left-B.tb.offset().left+Z.outerWidth(false)})});U=this.tb.find("tr");var W=this.tbdiv.find("div.JRWRgrip");U.each(function(X){var Z=A(this);var Y=A(W[X]);var a=Z.find("td:first");Y.width(a.outerWidth());Y.css({top:Z.offset().top-B.tb.offset().top+a.outerHeight(false)+"px"})})};G.prototype.syncGrids=function(){var U=this.tb.find("tr:first");var V=this.tbdiv.children(".JCLRgrips").children();U.find("td").each(function(X){var Z=A(this);var Y=A(V[X]);Y.height(Z.outerHeight(false));Y.css({left:Z.offset().left-B.tb.offset().left+Z.outerWidth(false)})});U=this.tb.children();var W=this.tbdiv.children(".JRWRgrips").children();U.each(function(X){var Z=A(this);var Y=A(W[X]);var a=Z.find("td:first");Y.width(a.outerWidth());Y.css({top:Z.offset().top-B.tb.offset().top+a.outerHeight(false)+"px"})});this.cellBorderColor()};G.prototype.syncGridDivs=function(){var U=this.tb.find("td");U.each(function(){var V=A(this).children("div");if(V.length>0){V.width(A(this).width());V.height(A(this).height())}V.children(".sv").width(A(this).width()).height(A(this).innerHeight())})};G.prototype.syncGridRowDivs=function(a,V,U){var W=this;var Y=a.data("gc");var Z=Y.rowNum;var X=this.tb.children(":eq("+Z+")");X.children("td").each(function(){var e=A(this).children("div");var d=A(this)[0];var b=d.offsetHeight-d.clientHeight;var c=V-(b>1?b/2:1);e.height(c);e.children(".sv").height(c);if(!U){W.syncMergeGridRowDivs(A(this),c)}})};G.prototype.syncMergeGridRowDivs=function(X,b){var W=X.data("gc");var Y=null;if(W.isRemove){Y=W.mergeCell}if(W.rowSpan>1){Y=W}if(Y==null){return }var U=0;for(var Z=Y.rowNum;Z<Y.rowNum+Y.rowSpan;Z++){var c=this.findTd(Z,Y.colNum);var a=c.data("gc");if(a.rowNum!=W.rowNum){U+=this.getFirstGridCellHeight(a)}else{U+=b}}var d=A(Y.o);var V=d.children("div");V.height(U);V.children(".sv").height(U)};G.prototype.syncGridColDivs=function(a,W,U){var X=this;var Z=a.data("gc");var V=Z.colNum;var Y=this.tb.children();Y.each(function(c){var g=null;if(c==0){g=A(this).find("td:eq("+V+")")}else{g=A(this).children("td:eq("+V+")")}var f=g.children("div");var d=A(this)[0];var e=d.offsetWidth-d.clientWidth;var b=W-(e>1?e/2:1);f.width(b);f.children(".sv").width(b);if(!U){X.syncMergeGridColDivs(g,b)}})};G.prototype.syncMergeGridColDivs=function(X,V){var W=X.data("gc");var Z=null;if(W.isRemove){Z=W.mergeCell}if(W.colSpan>1){Z=W}if(Z==null){return }var Y=0;for(var a=Z.colNum;a<Z.colNum+Z.colSpan;a++){var c=this.findTd(Z.rowNum,a);var b=c.data("gc");if(b.colNum!=W.colNum){Y+=this.getFirstGridCellWidth(b)}else{Y+=V}}var d=A(Z.o);var U=d.children("div");U.width(Y);U.children(".sv").width(Y)};G.prototype.areaDrag=function(){var V=this;var W=null;var U=function(b){V.d.bind("mouseup.area",Z).bind("mousemove.area",Y);var a=A(this);W=a;W.x=A(this).offset().left;W.y=A(this).offset().top};V.tbdiv.find("div.area").mousedown(U);var Y=function(d){if(!W){return }var b=d.pageX;var a=d.pageY;var c=Math.abs(b-W.x);var f=Math.abs(a-W.y);V.drawCanSelectedBorder(b,a,c,f,W);d.preventDefault()};var Z=function(a){V.d.unbind("mouseup.area",Z).unbind("mousemove.area",Y);V.clearCanBorderColor();if(!W){return }if(W.startCell){V.selectedGridCell=W.startCell;V.shiftGridCell=W.endCell;V.cellBorderColor()}W=null};var X=V.tbdiv.find(".tdborders").find(".area");X.bind("mousedown",U)};G.prototype.drawCanSelectedBorder=function(Z,Y,g,d,b){var V=this;var U=this.rect;if(Z>=U.x&&Z<=U.x+U.w&&Y>=U.y&&Y<=U.y+U.h){V.clearCanBorderColor();b.startCell=V.selectedGridCell;b.endCell=V.shiftGridCell;return }var X=null;if(g<d){if(Y>U.y+U.h){var f=this.selectedGridCell;var a=this.shiftGridCell!=null?this.shiftGridCell:f;var e=a.rowNum;var W=a.colNum;var c=this.tb.find("tr:gt("+e+")");c.each(function(h){var j=A(this).find("td:eq("+W+")");if(j.offset().top+A(this).height()/2>Y){return false}X=j.data("gc")});if(X!=null){V.canBorderColor(f,X,b)}}if(Y<U.y){var f=this.shiftGridCell!=null?this.shiftGridCell:this.selectedGridCell;var e=this.selectedGridCell.rowNum;var W=this.selectedGridCell.colNum;var c=this.tb.find("tr:lt("+e+")");c.each(function(j){var k=A(this).find("td:eq("+W+")");if(k.offset().top+A(this).height()/2>Y){var h=k.data("gc");if(h.rowNum==0){return false}X=h;return false}});if(X!=null){V.canBorderColor(f,X,b)}}}else{if(Z>U.x+U.w){var f=this.selectedGridCell;var a=this.shiftGridCell!=null?this.shiftGridCell:f;var e=a.rowNum;var W=a.colNum;if(e==0||W==0){return }var c=this.tb.find("tr:eq("+e+")");c.find("td:gt("+W+")").each(function(h){if(A(this).offset().left+A(this).width()/2>Z){return false}X=A(this).data("gc")});if(X!=null){V.canBorderColor(f,X,b)}}if(Z<U.x){var f=this.shiftGridCell!=null?this.shiftGridCell:this.selectedGridCell;var e=this.selectedGridCell.rowNum;var W=this.selectedGridCell.colNum;var c=this.tb.find("tr:eq("+e+")");c.find("td:lt("+W+")").each(function(j){if(A(this).offset().left+A(this).width()/2>Z){var h=A(this).data("gc");if(h.colNum==0){return false}X=h;return false}});if(X!=null){V.canBorderColor(f,X,b)}}}};G.prototype.drawExtendUnitsBorder=function(a){if(a==undefined||a==null){return }var Z=this;var U=A("div.tdborders").find("div.extendUnits");U.empty();for(var W=0;W<a.length;W++){var c=a[W];if(c.sourceRowCol==""||c.destRowCol==""){continue}var V=C.getCellReference(c.sourceRowCol);var d=C.getCellReference(c.destRowCol);var Y=Z.findTd(V[0],V[1]);var j=Z.findTd(d[0],d[1]);var f=Y.position();var e=j.position().left-f.left+j.width();var X=j.position().top-f.top+j.height();var b=A("<div></div>").css("pointer-events","none").addClass("tdborder-expand-unit");b.offset({left:f.left,top:f.top}).height(X).width(e);U.append(b)}};G.prototype.font=function(W,U){var a=this;if(this.selectedGridCell==null){return }var b=a.selectedGridCell;var Z=a.shiftGridCell!=null?a.shiftGridCell:b;for(var Y=b.rowNum;Y<=Z.rowNum+Z.rowSpan-1;Y++){for(var V=b.colNum;V<=Z.colNum+Z.colSpan-1;V++){var X=a.findTd(Y,V);if(W==0){if(U){X.addClass("bold")}else{X.removeClass("bold")}}else{if(W==1){if(U){X.addClass("italic")}else{X.removeClass("italic")}}else{if(W==2){if(U){X.addClass("underline")}else{X.removeClass("underline")}}}}}}};G.prototype.fontColor=function(W){var a=this;if(this.selectedGridCell==null){return }var c=a.selectedGridCell;var U=a.shiftGridCell!=null?a.shiftGridCell:c;for(var Z=c.rowNum;Z<=U.rowNum+U.rowSpan-1;Z++){for(var Y=c.colNum;Y<=U.colNum+U.colSpan-1;Y++){var d=a.findTd(Z,Y);if(W!=""){d.css("color",W);continue}var X="";var V=d.attr("style");if(V!=undefined&&V!=""){var b=V.split(";");for(var e=0;e<b.length;e++){if(b[e].indexOf("color")!=-1){continue}if(b[e]==""){continue}X+=b[e]+";"}if(X==""){d.removeAttr("style")}else{d.attr("style",X)}}}}};G.prototype.fontSize=function(e){var Z=this;if(this.selectedGridCell==null){return }var b=Z.selectedGridCell;var U=Z.shiftGridCell!=null?Z.shiftGridCell:b;for(var Y=b.rowNum;Y<=U.rowNum+U.rowSpan-1;Y++){for(var X=b.colNum;X<=U.colNum+U.colSpan-1;X++){var c=Z.findTd(Y,X);if(e!=12){c.css("font-size",e);continue}var W="";var V=c.attr("style");if(V!=undefined&&V!=""){var a=V.split(";");for(var d=0;d<a.length;d++){if(a[d].indexOf("font-size")!=-1){continue}if(a[d]==""){continue}W+=a[d]+";"}if(W==""){c.removeAttr("style")}else{c.attr("style",W)}}}}};G.prototype.backgroundColor=function(W){var a=this;if(this.selectedGridCell==null){return }var c=a.selectedGridCell;var U=a.shiftGridCell!=null?a.shiftGridCell:c;for(var Z=c.rowNum;Z<=U.rowNum+U.rowSpan-1;Z++){for(var Y=c.colNum;Y<=U.colNum+U.colSpan-1;Y++){var d=a.findTd(Z,Y);if(W!=""){d.css("background",W);continue}var X="";var V=d.attr("style");if(V!=undefined&&V!=""){var b=V.split(";");for(var e=0;e<b.length;e++){if(b[e].indexOf("background")!=-1){continue}if(b[e]==""){continue}X+=b[e]+";"}if(X==""){d.removeAttr("style")}else{d.attr("style",X)}}}}};G.prototype.style=function(a){var W={};var Z=A(a).attr("style");if(Z!=undefined&&Z!=""){var Y=Z.split(";");for(var V=0;V<Y.length;V++){var U=Y[V].split(":");var X=A.trim(U[1]);if(X.indexOf("rgb")!=-1){X=this.colorRGB2Hex(X)}W[A.trim(U[0])]=X}}return W};G.prototype.colorRGB2Hex=function(V){var W=V.split(",");var Z=parseInt(W[0].split("(")[1]);var Y=parseInt(W[1]);var U=parseInt(W[2].split(")")[0]);var X="#"+((1<<24)+(Z<<16)+(Y<<8)+U).toString(16).slice(1);return X};G.prototype.align=function(a){var Y=this;if(this.selectedGridCell==null){return }var Z=Y.selectedGridCell;var X=Y.shiftGridCell!=null?Y.shiftGridCell:Z;for(var W=Z.rowNum;W<=X.rowNum+X.rowSpan-1;W++){for(var U=Z.colNum;U<=X.colNum+X.colSpan-1;U++){var V=Y.findTd(W,U);V.attr("align",a)}}};G.prototype.valign=function(X){var Z=this;if(this.selectedGridCell==null){return }var a=Z.selectedGridCell;var Y=Z.shiftGridCell!=null?Z.shiftGridCell:a;for(var W=a.rowNum;W<=Y.rowNum+Y.rowSpan-1;W++){for(var U=a.colNum;U<=Y.colNum+Y.colSpan-1;U++){var V=Z.findTd(W,U);V.attr("valign",X);V.removeClass("vtop").removeClass("vmiddle").removeClass("vbottom");if(X=="top"){V.addClass("vtop")}else{if(X=="middle"){V.addClass("vmiddle")}else{if(X=="bottom"){V.addClass("vbottom")}}}}}};G.prototype.clearCell=function(Y){if(Y.isRemove){return }var W=A(Y.o);if(Y.drawing){var X=this.tb.attr("id");Y.drawing=undefined;var Z=Y.rowNum;var V=Y.colNum;A("#"+X+Z+"-"+V).remove();var U=Y.celllines;if(U){for(var a=0;a<U.length;a++){A(U[a]).remove()}}Y.celllines=undefined}W.removeAttr("align");W.removeAttr("valign");W.removeAttr("class");W.removeAttr("style");W.empty();Y.borderColor=undefined;Y.mark=-2;Y.isRemove=false;Y.mergeCell=null;Y.content=new Content()};G.prototype.clear=function(){var Y=this;if(this.selectedGridCell==null){return }var Z=Y.selectedGridCell;var X=Y.shiftGridCell!=null?Y.shiftGridCell:Z;for(var W=Z.rowNum;W<=X.rowNum+X.rowSpan-1;W++){for(var U=Z.colNum;U<=X.colNum+X.colSpan-1;U++){var V=Y.findTd(W,U);this.clearCell(V.data("gc"))}}};G.prototype.formatId=function(b){var Y=this;if(this.selectedGridCell==null){return }var a=Y.selectedGridCell;var X=Y.shiftGridCell!=null?Y.shiftGridCell:a;for(var W=a.rowNum;W<=X.rowNum+X.rowSpan-1;W++){for(var U=a.colNum;U<=X.colNum+X.colSpan-1;U++){var V=Y.findTd(W,U);var Z=V.data("gc");Z.content["formatId"]=b}}};G.prototype.localeUs=function(Z){var Y=this;if(this.selectedGridCell==null){return }var b=Y.selectedGridCell;var X=Y.shiftGridCell!=null?Y.shiftGridCell:b;for(var W=b.rowNum;W<=X.rowNum+X.rowSpan-1;W++){for(var U=b.colNum;U<=X.colNum+X.colSpan-1;U++){var V=Y.findTd(W,U);var a=V.data("gc");a.content["localeUs"]=Z}}};G.prototype.cellAreaBorderColor=function(X,c,V,m){var f=this;if(this.selectedGridCell==null){return }var n=function(g){var i=g.data("gc");var j=i.borderColor;if(j){return j}i.borderColor={};return i.borderColor};var W=f.selectedGridCell;var l=f.shiftGridCell!=null?f.shiftGridCell:W;if(X==0){for(var e=W.rowNum;e<=l.rowNum+l.rowSpan-1;e++){for(var d=W.colNum;d<=l.colNum+l.colSpan-1;d++){if(e==l.rowNum+l.rowSpan-1){var h=f.findTd(e,d);var k=h.data("gc");if(k.isRemove){h=A(k.mergeCell.o)}var U=n(h);var o={};o.borderWidth=m;o.borderStyle=V;o.color=c;U[X]=o;h.css("border-bottom",m+"px "+V+" "+c)}}}}else{if(X==1){for(var e=W.rowNum;e<=l.rowNum+l.rowSpan-1;e++){for(var d=W.colNum;d<=l.colNum+l.colSpan-1;d++){if(e==W.rowNum){var h=f.findTd(e,d);var k=h.data("gc");if(k.isRemove){h=A(k.mergeCell.o);k=k.mergeCell}var U=n(h);var o={};o.borderWidth=m;o.borderStyle=V;o.color=c;U[X]=o;h.css("border-top",m+"px "+V+" "+c)}}}}else{if(X==2){for(var e=W.rowNum;e<=l.rowNum+l.rowSpan-1;e++){for(var d=W.colNum;d<=l.colNum+l.colSpan-1;d++){if(d==W.colNum){var h=f.findTd(e,d);var k=h.data("gc");if(k.isRemove){h=A(k.mergeCell.o);k=k.mergeCell}var U=n(h);var o={};o.borderWidth=m;o.borderStyle=V;o.color=c;U[X]=o;h.css("border-left",m+"px "+V+" "+c)}}}}else{if(X==3){for(var e=W.rowNum;e<=l.rowNum+l.rowSpan-1;e++){for(var d=W.colNum;d<=l.colNum+l.colSpan-1;d++){if(d==l.colNum+l.colSpan-1){var h=f.findTd(e,d);var k=h.data("gc");if(k.isRemove){h=A(k.mergeCell.o)}var U=n(h);var o={};o.borderWidth=m;o.borderStyle=V;o.color=c;U[X]=o;h.css("border-right",m+"px "+V+" "+c)}}}}else{if(X==4){for(var e=W.rowNum;e<=l.rowNum+l.rowSpan-1;e++){for(var d=W.colNum;d<=l.colNum+l.colSpan-1;d++){var h=f.findTd(e,d);var k=h.data("gc");if(k.isRemove){h=A(k.mergeCell.o)}var Y=h.attr("style");var k=h.data("gc");k.borderColor=undefined;if(!C.isUndefined(Y)){var a="";var b=Y.split(";");for(var Z=0;Z<b.length;Z++){if(b[Z]==""){continue}if(b[Z].indexOf("border-bottom")!=-1||b[Z].indexOf("border-top")!=-1||b[Z].indexOf("border-left")!=-1||b[Z].indexOf("border-right")!=-1||b[Z].indexOf("border")!=-1){continue}a+=(b[Z]+";")}if(a==""){h.removeAttr("style")}else{h.attr("style",a)}}}}}else{if(X==5){for(var e=W.rowNum;e<=l.rowNum+l.rowSpan-1;e++){for(var d=W.colNum;d<=l.colNum+l.colSpan-1;d++){var h=f.findTd(e,d);var k=h.data("gc");if(k.isRemove){h=A(k.mergeCell.o);k=k.mergeCell}var U=n(h);var o={};o.borderWidth=m;o.borderStyle=V;o.color=c;U[X]=o;h.css("border",m+"px "+V+" "+c)}}}else{if(X==6){this.cellAreaBorderColor(0,c,V,m);this.cellAreaBorderColor(1,c,V,m);this.cellAreaBorderColor(2,c,V,m);this.cellAreaBorderColor(3,c,V,m)}}}}}}}};G.prototype.tdBorderColor=function(X){if(!X.borderColor){return }var U=A(X.o);var Y=X.borderColor;for(var W in Y){var V=Y[W];this.tdDrawBorderColor(U,W,V)}};G.prototype.tdDrawBorderColor=function(X,Z,Y){var W=Y.color.startsWith("#")?Y.color:"#"+Y.color;var V=Y.borderStyle!=undefined?Y.borderStyle:"solid";var U=Y.borderWidth!=undefined?Y.borderWidth:1;if(Z==0){X.css("border-bottom",U+"px "+V+" "+W)}else{if(Z==1){X.css("border-top",U+"px "+V+" "+W)}else{if(Z==2){X.css("border-left",U+"px "+V+" "+W)}else{if(Z==3){X.css("border-right",U+"px "+V+" "+W)}else{if(Z==5){X.css("border",U+"px "+V+" "+W)}else{if(Z==6){this.tdDrawBorderColor(X,0,Y);this.tdDrawBorderColor(X,1,Y);this.tdDrawBorderColor(X,2,Y);this.tdDrawBorderColor(X,3,Y)}}}}}}};G.prototype.setDyncBackground=function(X){if(this.selectedGridCell==null){return }var b=this.selectedGridCell;var Y=this.shiftGridCell!=null?this.shiftGridCell:b;for(var W=b.rowNum;W<=Y.rowNum+Y.rowSpan-1;W++){for(var U=b.colNum;U<=Y.colNum+Y.colSpan-1;U++){var V=this.findTd(W,U);var a=V.data("gc");var Z={};Z.oddBackgroundColor=X.oddBackgroundColor;Z.evenBackgroundColor=X.evenBackgroundColor;a.content.cellSelectStyle=X}}};G.prototype.getMaxMinCellNum=function(){var a=1;var c=1;var Z=this.tb.children();for(var Y=1;Y<Z.length;Y++){var X=A(Z[Y]).children("td");for(var W=1;W<X.length;W++){var V=A(X[W]);var U=V.data("gc");if(U.mark!=-2||U.isValid()){a=Math.max(a,U.rowNum+U.rowSpan-1);c=Math.max(c,U.colNum+U.colSpan-1)}if(U.mark!=1){continue}var b=V.text();U.setColumnVal(A.trim(b))}}return[a,c]};G.prototype.getArgMaxMinCellNum=function(){var W=0;var Z=0;var U=this.tb.children();for(var X=1;X<U.length;X++){var Y=A(U[X]).children("td");for(var V=1;V<Y.length;V++){var b=A(Y[V]);var a=b.data("gc");if(a.mark==0||a.mark==2||a.isValid()){W=Math.max(W,a.rowNum+a.rowSpan-1);Z=Math.max(Z,a.colNum+a.colSpan-1)}}}if(W==0&&Z==0){return null}return[W,Z]};G.prototype.setReportType=function(c,V,U){var b=this.tb.children();for(var a=1;a<=c;a++){var Z=A(b[a]).children("td");for(var Y=1;Y<Z.length;Y++){var X=A(Z[Y]);var W=X.data("gc");if(W.mark==0||W.mark==1){var d=W.content;if(d.isGroup()){U.rptType=2;break}}}}var b=this.tb.children();for(var a=1;a<=c;a++){var Z=A(b[a]).children("td");for(var Y=1;Y<Z.length;Y++){var X=A(Z[Y]);var W=X.data("gc");if(W.mark==0||W.mark==1){var d=W.content;if(d.disType==2){U.rptType=3;break}}}}var b=this.tb.children();for(var a=1;a<=c;a++){var Z=A(b[a]).children("td");for(var Y=1;Y<Z.length;Y++){var X=A(Z[Y]);var W=X.data("gc");if(W.mark==0||W.mark==1){var d=W.content;if(d.treeType!=undefined&&d.treeType!=0){U.rptType=5;break}}}}};G.prototype.getSelectComps=function(U){var e=new Array();e.push("");var c=this.tb.children();for(var a=1;a<c.length;a++){var Z=A(c[a]).children("td");for(var Y=1;Y<Z.length;Y++){var X=A(Z[Y]);var V=X.data("gc");if(V.isRemove){continue}if(V.mark!=2){continue}var W=V.content;if(W.name==undefined||W.name==""){continue}if(U==W.name){continue}e.push(W.name)}}var d=report.reportArg;if(d!=undefined){var b=d.hiddens;if(b){for(var a=0;a<b.length;a++){e.push(b[a].name)}}}return e};G.prototype.getHtmlCells=function(){var Y=new Array();var U=this.tb.children();for(var W=1;W<U.length;W++){var X=A(U[W]).children("td");for(var V=1;V<X.length;V++){var b=A(X[V]);var Z=b.data("gc");if(Z.isRemove){continue}if(Z.mark==0){var a=b.find("span").html();Y.push({colNum:Z.colNum,text:a})}}}return Y};G.prototype.getArgNames=function(){var d=new Array();d.push("");var b=this.tb.children();for(var Z=1;Z<b.length;Z++){var Y=A(b[Z]).children("td");for(var X=1;X<Y.length;X++){var W=A(Y[X]);var U=W.data("gc");if(U.isRemove){continue}if(U.mark!=2){continue}var V=U.content;if(V.name!=undefined&&V.name!=""){d.push("$"+V.name)}}}var c=report.reportArg;if(c!=undefined){var a=c.hiddens;if(a){for(var Z=0;Z<a.length;Z++){d.push("$"+a[Z].name)}}}d.push("$_userId");d.push("$_userName");d.push("$_personName");d.push("$_orgId");d.push("$_orgName");d.push("$_userPhone");d.push("$_userEmail");return d};G.prototype.startDrawCellLine=function(p,a,Z){var e=a!=undefined?a:50;var d=Z!=undefined?Z:10;var U=this;var Y=A(p.o);var V=Y.position();var q=null;var o=null;var k=this.tbdiv.children(".tdborders").find(".celllines");if(p.drawing||p.drawing!=null){q=p.drawing;o=p.celllines}else{var n=p.rowNum;var W=p.colNum;var j=U.tb.attr("id");var f=A("<div></div>").attr("id",j+n+"-"+W).css("position","absolute").css("pointer-events","none").css("left",V.left).css("top",V.top);k.append(f);var b=SVG(j+n+"-"+W);b.attr({"width":Y.outerWidth(),"height":Y.outerHeight()});p.drawing=b;q=b;o=new Array()}var X=A("<div></div>").css("position","absolute").width(6).height(6).css("border","1px solid red");X.css("left",V.left+e).css("top",V.top+d);k.append(X);var h="M"+0+","+0+"L"+e+","+d;var c=q.path(h);c.attr({"stroke":"#000000","stroke-width":1});X.data("l",c);X.data("t",Y);X.data("x",X.position().left-Y.position().left);X.data("y",X.position().top-Y.position().top);o.push(X);p.celllines=o;var l=null;var g=function(u){var s=u.position();var t=u.data("l");var w=A(u.data("t"));var v=w.position();var r="M"+0+","+0+"L"+(s.left-v.left)+","+(s.top-v.top);t.attr({"d":r})};var i=function(s){if(l==null){return false}var r=l.posix;l.css({"top":s.pageY-r.y,"left":s.pageX-r.x});g(l);return false};var m=function(s){A(document).unbind("mousemove",i).unbind("mouseup",m);if(l==null){return false}var r=l.posix;l.css({"top":s.pageY-r.y,"left":s.pageX-r.x});g(l);l.data("x",l.position().left-Y.position().left);l.data("y",l.position().top-Y.position().top);l=null};X.mousedown(function(t){var v=A("#report-excel").scrollLeft();var s=A("#report-excel").scrollTop();var u=A(this).position();l=A(this);l.posix={x:t.pageX-u.left-v,y:t.pageY-u.top-s};A(document).bind("mousemove",i).bind("mouseup",m);var w=A(A(this).data("t"));var r=w.data("gc");if(r.drawing){r.drawing.attr({"width":w.outerWidth(),"height":w.outerHeight()})}})};G.prototype.setGridCellWidth=function(W){var X=this;var Y=this.selectedGridCell;if(Y==null){return }var U=Y.colNum;var V=X.tb.find("tr:first");var Z=V.find("td:eq("+U+")");X.syncGridColDivs(Z,W);Z.width(W);X.syncGrids()};G.prototype.getFirstGridCellWidth=function(W){var U=W.colNum;var V=this.tb.find("tr:first");var X=V.find("td:eq("+U+")");return X.width()};G.prototype.setFirstGridCellWidth=function(X,W){var U=X.colNum;var V=this.tb.find("tr:first");var Y=V.find("td:eq("+U+")");this.syncGridColDivs(Y,W);Y.width(W);this.syncGrids()};G.prototype.setGridCellHeight=function(U){var V=this;var X=this.selectedGridCell;if(X==null){return }var Y=X.rowNum;var W=V.tb.children(":eq("+Y+")");var Z=W.find("td:first");V.syncGridRowDivs(Z,U);Z.parent().height(U);V.syncGrids()};G.prototype.setFirstGridCellHeight=function(W,U){var X=W.rowNum;var V=this.tb.children(":eq("+X+")");var Y=V.find("td:first");this.syncGridRowDivs(Y,U);Y.parent().height(U);this.syncGrids()};G.prototype.getFirstGridCellHeight=function(V){var W=V.rowNum;var U=this.tb.children(":eq("+W+")");var X=U.find("td:first");return X.height()};G.prototype.getGridCell=function(b,U,a,Z){b=b+1;U=U+1;var c=this.tb.children().length;var W=this.tb.find("tr:eq(0)").children("td").length;if(b+a>=c){for(var Y=0;Y<=((b+a)-c);Y++){this.newAddRow(true)}}if(U+Z>=W){for(var Y=0;Y<=((U+Z)-W);Y++){this.newAddColumn(true)}}var X=this.findTd(b,U);var V=X.data("gc");V.rowSpan=a;V.colSpan=Z;V.rowNum=b;V.colNum=U;this.mergeTdCell(V);return V};G.prototype.clearAll=function(){var a=this;var U=this.tb.children();for(var Y=1;Y<U.length;Y++){var Z=A(U[Y]).children("td");for(var W=1;W<Z.length;W++){var X=A(Z[W]);var b=X.data("gc");this.clearCell(b);if(b.rowSpan>1||b.colSpan>1){this.unMergeCell(b)}}}var V=this.tb.find("tr:eq(0)");V.find("td").each(function(c){var d=A(this);d.find("i").remove();if(c>0){d.width(a.colWidth);d.find("div").width(a.colWidth)}});var U=this.tb.children();for(var Y=1;Y<U.length;Y++){var Z=A(U[Y]).children("td");var X=A(Z[0]);X.find("i").remove();X.parent().height(a.rowHeight);X.find("div").height(a.rowHeight)}A("#div-coor").empty();divCoor=new DivCoor();report=new Report();anyExcel.clearLeftDatasetTree()};var C={isUndefined:function(U){return U==null||U==undefined},getLetter:function(W){var U=64,X=26;if(W<=U){return""}if(W<=U+X){return String.fromCharCode(W)}var Y=W-U;var V=Math.floor(Y/X);if(V>=X){return""}var Z=W-V*X;if(Z==U){Z=U+X;V=V-1}return String.fromCharCode(U+V)+String.fromCharCode(Z)},getCellReference:function(U){var W=U.length;var a=0;for(;a<W;a++){var V=U.charAt(a);if(!isNaN(Number(V))){break}}var X=U.substring(0,a);var Z=U.substr(a);var Y=new Array();Y.push(parseInt(Z));Y.push(C.convertColStringToIndex(X));return Y},convertColStringToIndex:function(X){var Y=0;var V=0;for(var W=X.length-1;W>=0;W--){var U=parseInt(Math.pow(26,Y));V+=(X.charCodeAt(W)-63)*U;Y++}return V-1},calMergeGridCell:function(Z,a,V){var b=0;var Y=0;var W=0;var U=0;if(a.rowNum+a.rowSpan-1>=Z.rowNum+Z.rowSpan-1){b=Z.rowNum+Z.rowSpan-1;Y=a.rowNum+a.rowSpan-1}else{b=a.rowNum+a.rowSpan-1;Y=Z.rowNum+Z.rowSpan-1}if(a.colNum+a.colSpan-1>=Z.colNum+Z.colSpan-1){W=Z.colNum+Z.colSpan-1;U=a.colNum+a.colSpan-1}else{W=a.colNum+a.colSpan-1;U=Z.colNum+Z.colSpan-1}var X=new K();X.firstRow=b;X.lastRow=Y;X.firstCol=W;X.lastCol=U;C.rectangleGridCell(X,V);return X},rectangleGridCell:function(a,U){var Y=A(U[a.firstRow]).find("td");var b;for(var V=a.firstCol;V<=a.lastCol;V++){b=A(Y[V]).data("gc");if(b.isRemove){a.setRect(b.mergeCell)}if(b.mergeCell){a.setRect(b)}}for(var W=a.firstRow+1;W<=a.lastRow;W++){Y=A(U[a.firstRow]).find("td");b=A(Y[a.firstCol]).data("gc");if(b.isRemove){a.setRect(b.mergeCell)}if(b.mergeCell){a.setRect(b)}}for(var X=a.firstRow+1;X<=a.lastRow;X++){Y=A(U[X]).find("td");b=A(Y[a.lastCol]).data("gc");if(b.isRemove){a.setRect(b.mergeCell)}if(b.mergeCell){a.setRect(b)}}for(var Z=a.firstCol+1;Z<a.lastCol;Z++){Y=A(U[a.lastRow]).find("td");b=A(Y[Z]).data("gc");if(b.isRemove){a.setRect(b.mergeCell)}if(b.mergeCell){a.setRect(b)}}if(a.isGoRectangle()){a.isRectangle=true;C.rectangleGridCell(a,U)}}};var B=new G();B.init();return B}})(jQuery)