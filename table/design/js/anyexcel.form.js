var Jform=function(){};var jform=new Jform();var Content=function(){this.contentType=0;this.disType=0;this.joinType=0;this.getOrCreateBarCode=function(){if(this.barCode==undefined){this.barCode={}}return this.barCode};this.getBarCode=function(){return this.barCode};this.available=function(){return this.cellLinked||this.cellImageLinked||this.conditionFormat||this.linkages||this.cellLines||this.dataFilter||this.dataBar||this.diffBar||this.orderBy};this.setColumnTypeFlag=function(B,A){if(A){this.columnType=this.columnType|(1<<B)}else{this.columnType=(~(1<<B))&this.columnType}};this.isGroup=function(){var F=(1<<4)&this.columnType;if(F!=0){var D=(1<<5)&this.columnType;var B=(1<<6)&this.columnType;var E=(1<<7)&this.columnType;var C=(1<<8)&this.columnType;var A=(1<<9)&this.columnType;if(D!=0||B!=0||E!=0||C!=0||A!=0){return false}return true}return false}};var AnyExcel=function(){};String.prototype.endWith=function(A){if(A==null||A==""||this.length==0||A.length>this.length){return false}if(this.substring(this.length-A.length)==A){return true}else{return false}return true};AnyExcel.prototype={init:function(){var E=this;$("#cell-bg").spectrum({allowEmpty:false,clearText:"清除",color:"#fff",showInput:true,containerClassName:"full-spectrum",showInitial:true,showPalette:true,showSelectionPalette:true,maxPaletteSize:10,preferredFormat:"hex",chooseText:"确定",cancelText:"取消",replaceInput:"<a href=''><i class='icon iconfont icon-caret-down-s icon-size-12'></i></a>",change:function(F){$(".cell-bg").css("color",F);E.backgroundColor()},clear:function(){$(".cell-bg").removeAttr("style");E.backgroundColor()},cancel:function(F){$(".cell-bg").css("color",F);E.backgroundColor()},palette:PALETTE});$("#cell-font-color").spectrum({allowEmpty:false,clearText:"清除",color:"#000000",showInput:true,containerClassName:"full-spectrum",showInitial:true,showPalette:true,showSelectionPalette:true,maxPaletteSize:10,preferredFormat:"hex",chooseText:"确定",cancelText:"取消",replaceInput:"<a href=''><i class='icon iconfont icon-caret-down-s icon-size-12'></i></a>",change:function(F){$(".cell-font-color").css("color",F);E.fontColor()},clear:function(){$(".cell-font-color").removeAttr("style");E.fontColor()},cancel:function(F){$(".cell-font-color").css("color",F);E.fontColor()},palette:PALETTE});$("#colorpick-border-color").spectrum({allowEmpty:false,clearText:"清除",color:"#000000",showInput:true,containerClassName:"full-spectrum",showInitial:true,showPalette:true,showSelectionPalette:true,maxPaletteSize:10,preferredFormat:"hex",chooseText:"确定",cancelText:"取消",replaceInput:"<a href='javascript:void(0)'><i class='icon iconfont icon-borderColor fa-lg icon-size-16 colorpick-border-color-demo'></i>线条颜色</a>",change:function(F){$(".colorpick-border-color-demo").css("color",F);$("li.tl-border-color").attr("color",F)},clear:function(){$(".colorpick-border-color-demo").removeAttr("style");$("li.tl-border-color").attr("color","#000000")},cancel:function(F){$(".colorpick-border-color-demo").css("color",F);$("li.tl-border-color").attr("color",F)},palette:PALETTE});$("li.tl-font-bold").click(function(){if($(this).hasClass("tl-hover")){$(this).removeClass("tl-hover");E.getGrid().font(0,false)}else{$(this).addClass("tl-hover");E.getGrid().font(0,true)}});$("li.tl-font-italic").click(function(){if($(this).hasClass("tl-hover")){$(this).removeClass("tl-hover");E.getGrid().font(1,false)}else{$(this).addClass("tl-hover");E.getGrid().font(1,true)}});$("li.tl-font-underline").click(function(){if($(this).hasClass("tl-hover")){$(this).removeClass("tl-hover");E.getGrid().font(2,false)}else{$(this).addClass("tl-hover");E.getGrid().font(2,true)}});$("li.tl-font-color").click(function(){E.fontColor()});$("li.tl-background-color").click(function(){E.backgroundColor()});$("li.tl-fontsize").find("select").change(function(){var F=$(this).val();E.fontSize(parseInt(F))});$(".tl-align-left").click(function(){E.clearAlignStyle();$(this).addClass("tl-hover");E.getGrid().align("left")});$(".tl-align-center").click(function(){E.clearAlignStyle();$(this).addClass("tl-hover");E.getGrid().align("center")});$(".tl-align-right").click(function(){E.clearAlignStyle();$(this).addClass("tl-hover");E.getGrid().align("right")});$(".tl-valign-top").click(function(){E.clearValignStyle();$(this).addClass("tl-hover");E.getGrid().valign("top")});$(".tl-valign-middle").click(function(){E.clearValignStyle();$(this).addClass("tl-hover");E.getGrid().valign("middle")});$(".tl-valign-bottom").click(function(){E.clearValignStyle();$(this).addClass("tl-hover");E.getGrid().valign("bottom")});$("li.tl-cell-line").click(function(){if($(this).hasClass("tl-hover")){$(this).removeClass("tl-hover")}else{$(this).addClass("tl-hover")}});$("li.tl-border-color").click(function(){var G=$(this).attr("val");var F=$(this).attr("color");E.getGrid().cellAreaBorderColor(G,F)});$("li.tl-border li").click(function(){var G=$(this).attr("val");var F=$(this).find("i").attr("class");$("li.tl-border-color i").attr("class",F);$("li.tl-border-color").attr("val",G);$("li.tl-border-color").click()});$(".cell-merge").click(function(){var F=$(".cell-merge").parent("li");if(F.hasClass("tl-hover")){E.getGrid().divideCell();F.removeClass("tl-hover")}else{E.getGrid().mergeCell();F.addClass("tl-hover")}});$("li.tl-cell-clear").click(function(){E.getGrid().clear()});$(".tl-insert-row").click(function(){E.getGrid().insertRow()});$(".tl-insert-col").click(function(){E.getGrid().insertColumn()});$(".tl-add-row").click(function(){E.getGrid().newAddRow()});$(".tl-add-col").click(function(){E.getGrid().newAddColumn()});$("li.tl-delete-row").click(function(){E.getGrid().deleteRow()});$("li.tl-delete-col").click(function(){E.getGrid().deleteCol()});$("#text-cell-content").keyup(function(G){var F=grid.selectedGridCell;if(F==null){return false}F.setText($(this).val())});var B=null;var C=null;var D=function(H){if(B==null){return false}var G=B.scrollTop();var F=B.scrollLeft();if(C){C.css({"top":(H.clientY+G+3)+"px","left":(H.clientX+F+3)+"px"})}return false};var A=function(J){if(B==null){return false}B.unbind("mousemove").unbind("mouseup");C.remove();var M=parseInt(B.type);var K=$(J.target);var L=null;if(K.is("td")){L=K}else{if(K.is("span")){var H=K.parent().parent().parent();if(H.is("td")){L=H;K.remove()}}else{if(K.parent().parent().is("td")){L=K.parent().parent()}}}if(L!=null){var O=L.data("gc");if(O.rowNum>0&&O.colNum>0){if(L.find("div.sv").length==0){var F=$("<div></div>").css("overflow","hidden").width(L.width()).height(L.height());var N=$("<div></div>").addClass("sv").width(L.width()).height(L.height()).appendTo(F);L.append(F)}O.mark=2;var G=anyExcel.getGridCellFormComponent(O);G.editStyle=M;if(TYPE=="app"){G.width=100;G.widthUnit="%"}var I=E.createComponent(M);if(M==1||M==4||M==17||M==7){I.width(150).height(22);L.find("div.sv").empty().append(I)}else{if(M==2||M==10){I.width(150).height(22);L.find("div.sv").empty().append(I)}else{if(M==3){I.width(150).height(22);L.find("div.sv").empty().append(I);G.dataType=5;anyExcel.initDate(I)}else{if(M==5||M==6){L.find("div.sv").append(I)}else{if(M==12||M==23){L.find("div.sv").append(I);G.height=200;G.width=300}else{if(M==8||M==11){I.width(150).height(22);L.find("div.sv").empty().append(I)}}}}}}}}B=null};$("#arg-component").find("li").mousedown(function(F){B=$(document);B.bind("mousemove",D);B.bind("mouseup",A);var G=$(this).text();B.type=$(this).attr("ctype");B.subType=$(this).attr("subType");C=$("<span class='dragUL'>"+G+"</span>");C.appendTo("body");if(F.preventDefault){F.preventDefault()}});if(TYPE=="app"){jform.relative=2}this.initWin()},initWin:function(){var A="<div class='sp-replacer'><div class='sp-preview'><div class='sp-preview-inner'></div></div><div class='sp-dd'>&#9660;</div></div>";$(".color-select").each(function(){var B=$(this).attr("default")?$(this).attr("default"):"#000000";$(this).spectrum({allowEmpty:true,clearText:"清除",color:B,showInput:true,showInitial:true,showPalette:true,showSelectionPalette:true,maxPaletteSize:10,preferredFormat:"hex",chooseText:"确定",cancelText:"取消",replaceInput:A,palette:PALETTE})})}};AnyExcel.prototype.setToolMenuStyle=function(F){if(this.getGrid().isMergeFlag()){$(".cell-merge").parent("li").addClass("tl-hover")}else{$(".cell-merge").parent("li").removeClass("tl-hover")}if(F.hasClass("bold")){$("li.tl-font-bold").addClass("tl-hover")}else{$("li.tl-font-bold").removeClass("tl-hover")}if(F.hasClass("italic")){$("li.tl-font-italic").addClass("tl-hover")}else{$("li.tl-font-italic").removeClass("tl-hover")}if(F.hasClass("underline")){$("li.tl-font-underline").addClass("tl-hover")}else{$("li.tl-font-underline").removeClass("tl-hover")}$("li.tl-fontsize").find("select").selectpicker("val",12);var G=F.attr("style");if(G!=undefined&&G!=""){var M=G.split(";");for(var I=0;I<M.length;I++){if(M[I]==""||M[I].indexOf("font-size")==-1){continue}var J=M[I].split(":")[1];var P=$.trim(J.substring(0,J.length-2));$("li.tl-fontsize").find("select").selectpicker("val",parseInt(P))}}var N=F.attr("align");var H=$("li.tl-align-left");var O=$("li.tl-align-center");var E=$("li.tl-align-right");H.removeClass("tl-hover");O.removeClass("tl-hover");E.removeClass("tl-hover");if(N=="left"){H.addClass("tl-hover")}else{if(N=="center"){O.addClass("tl-hover")}else{if(N=="right"){E.addClass("tl-hover")}}}var D=F.attr("valign");var K=$("li.tl-valign-top");var B=$("li.tl-valign-middle");var C=$("li.tl-valign-bottom");K.removeClass("tl-hover");B.removeClass("tl-hover");C.removeClass("tl-hover");if(D=="top"){K.addClass("tl-hover")}else{if(D=="middle"){B.addClass("tl-hover")}else{if(D=="bottom"){C.addClass("tl-hover")}}}var A=F.data("gc");var L=F.find("span");if(L.length>0){$("#text-cell-content").val(L.text())}else{$("#text-cell-content").val("")}};AnyExcel.prototype.cellMenu=function(H){var S=H.data("gc");var O=S.content;var L=new Array();var F=function(U){if(U.type=="conditionFormat"){$("li.tl-condition-format").trigger("click")}else{if(U.type=="dataBar"){$("li.tl-data-bar").trigger("click")}else{if(U.type=="diffBar"){$("li.tl-diff-bar").trigger("click")}else{if(U.type=="dataFilter"){$("li.tl-data-filter").trigger("click")}else{if(U.type=="cellLinked"){$("li.tl-insert-celllink").trigger("click")}else{if(U.type=="linkage"){$("li.tl-insert-linkages-all").trigger("click")}else{if(U.type=="cellImageLinked"){$("li.tl-insert-image-link").trigger("click")}else{if(U.type=="selectStyle"){$("li.tl-insert-cellSelect-style").trigger("click")}else{if(U.type=="orderBy"){$("li.tl-insert-orderby-icon").trigger("click")}else{if(U.type=="cellFold"){$("li.tl-tree-expand").trigger("click")}}}}}}}}}}};var B=function(U){if(U.type=="conditionFormat"){O.conditionFormat=undefined}else{if(U.type=="dataBar"){O.dataBar=undefined}else{if(U.type=="diffBar"){O.diffBar=undefined}else{if(U.type=="dataFilter"){O.dataFilter=undefined}else{if(U.type=="cellLinked"){O.cellLinked=undefined}else{if(U.type=="linkage"){O.linkages=undefined}else{if(U.type=="cellImageLinked"){O.cellImageLinked=undefined}else{if(U.type=="selectStyle"){O.cellSelectStyle=undefined}else{if(U.type=="orderBy"){O.orderBy=undefined}else{if(U.type=="cellFold"){O.cellFold=undefined}}}}}}}}}}};var J=function(X,V,U){var W={};W.title=X;W.icon="icon iconfont "+V+" fa-lg";W.fn=F;W.dfn=B;W.type=U;W.del=true;return W};var I=O.conditionFormat;if(I!=undefined&&!$.isEmptyObject(I)){L.push(J("条件格式","icon-icon01","conditionFormat"))}var A=O.dataBar;if(A!=undefined&&!$.isEmptyObject(A)){L.push(J("数据条","icon-barh","dataBar"))}var D=O.diffBar;if(D!=undefined&&!$.isEmptyObject(D)){L.push(J("差异图","icon-bars","diffBar"))}var N=O.dataFilter;if(N!=undefined&&!$.isEmptyObject(N)){L.push(J("过滤","icon-filter","dataFilter"))}var G=O.cellLinked;if(G!=undefined&&!$.isEmptyObject(G)){L.push(J("超级链接","icon-link","cellLinked"))}var P=O.linkages;if(P!=undefined&&!$.isEmptyObject(P)){L.push(J("交互设置","icon-jiaohu","linkage"))}var T=O.cellImageLinked;if(T!=undefined&&!$.isEmptyObject(T)){L.push(J("图片链接","icon-image1","cellImageLinked"))}var C=O.cellSelectStyle;if(C!=undefined&&!$.isEmptyObject(C)){L.push(J("动态背景色","icon-bgcolor2","selectStyle"))}var K=O.orderBy;if(K!=undefined&&!$.isEmptyObject(K)&&K.dyn!=1){L.push(J("排序图标","icon-paixu","orderBy"))}var Q=O.cellFold;if(Q!=undefined&&!$.isEmptyObject(Q)){L.push(J("折叠图标","icon-zhedie-jiahao","cellFold"))}if(L.length>0){var E=$("#report-div").offset().left;var M=$("#report-div").offset().top;var R={clientX:H.position().left+H.width()+E,clientY:H.position().top+M};basicContext.show(L,R)}};AnyExcel.prototype.setRightArgProperty=function(E){var A=Math.round(E.width());var L=Math.round(E.height());var H=$("#right-property-arg-cell").find("tr:eq(1)");var G=$("#right-property-arg-cell").find("tr:eq(2)");H.find("input").val(A);G.find("input").val(L);var J=function(){$("#component-tab").children("li:eq(1)").hide();$("#component-style").hide()};var K=function(){var M=$("#right-property-arg");M.find("tr:eq(9)").hide();M.find("tr:eq(10)").hide();M.find("tr:eq(13)").hide();M.find("tr:eq(14)").hide();M.find("tr:eq(15)").hide();$("#right-property-cell-format").hide();$("#right-property-arg-select").hide();$("#right-property-arg-select").find("tr:gt(2)").remove();$("#right-property-arg-ds-select").hide();$("#right-property-arg-tree").hide();$("#right-property-arg-seq").find("tr:gt(2)").remove();$("#component-tab").find("li:eq(2)").hide();J()};var F=function(){var M={};$("#right-property-arg-select").find("tr:gt(2)").each(function(){var R=$(this).find("td:eq(0)");var Q=R.find("input").val();var P=$(this).find("td:eq(1)");var S=P.find("input").val();M[Q]=S});var O=anyExcel.getFormComponent();if(O==null){return false}var N=O.data?O.data:{};N.dataMap=M;O.data=N;if(O.editStyle!=2){setCompLabel(B,M)}};var C=function(l){var Aj={};if(l.components&&l.components.length>0){Aj=l.components[0]}$("#component-tab").children("li:eq(1)").show();$("#component-style").removeAttr("style");var m=$("#right-property-arg");m.show();var AG=m.find("tr:eq(2)");var AM=Aj.name!=undefined?Aj.name:"";AG.find("input").val(AM);var AF=m.find("tr:eq(3)");var f=Aj.desc!=undefined?Aj.desc:"";AF.find("input").val(f);var AE=m.find("tr:eq(4)");var AZ=Aj.width!=undefined?Aj.width:150;AE.find("input").val(AZ);var AJ=Aj.widthUnit!=undefined?Aj.widthUnit:"px";AE.find("select").selectpicker("val",AJ);var AD=m.find("tr:eq(5)");var V=Aj.height!=undefined?Aj.height:22;AD.find("input").val(V);var q=Aj.heightUnit!=undefined?Aj.heightUnit:"px";AD.find("select").selectpicker("val",q);var AB=m.find("tr:eq(6)");var Ai=Aj.readOnly!=undefined?Aj.readOnly:0;AB.find("select").selectpicker("val",Ai);var AA=m.find("tr:eq(7)");var Q=Aj.display!=undefined?Aj.display:0;AA.find("select").selectpicker("val",Q);var y=m.find("tr:eq(8)");var Ah=Aj.dataType!=undefined?Aj.dataType:1;y.find("select").selectpicker("val",Ah);var d=m.find("tr:eq(12)");var U=Aj.defaultValueType!=undefined?Aj.defaultValueType:0;d.find("td:eq(0)").find("select").selectpicker("val",U);var R=Aj.defaultValue!=undefined?Aj.defaultValue:"";var AS=d.find("td:eq(1)");var AW=AS.children();AW.hide();if(U==0||U==1){AS.find("input").val(R);$(AW[0]).show();if(U==1){$(AW[1]).show()}}else{$(AW[2]).show();AS.find("select").selectpicker("val",R)}var Ad=Aj.editStyle;if(Ad){var AI=m.find("tr:eq(1)");if(Ad==1){AI.find("td:eq(1)").html("文本框");var Y=m.find("tr:eq(14)");Y.show();var Af=Y.find("select");if(Aj.formatId!=undefined){var u=Aj.formatId;if(Af.find("option[value="+u+"]").length>0){Af.selectpicker("val",u)}else{var W=$("<option value='"+u+"' selected='selected'>"+formats[u]+"</option>");Af.append(W);Af.selectpicker("refresh")}}else{Af.selectpicker("val","0")}}else{if(Ad==2){var a=Aj["data"]?Aj["data"]:{};AI.find("td:eq(1)").html("下拉框");var x=m.find("tr:eq(9)");x.show();var e=m.find("tr:eq(10)");e.show();var Al=e.find("select");Al.empty();var O=grid.getSelectComps(Aj.name);for(var p=0;p<O.length;p++){var AR=$("<option></option>");AR.attr("value",O[p]).html(O[p]).appendTo(Al)}if(Aj.linkCmopName){var S=Aj.linkCmopName;if(typeof Aj.linkCmopName=="string"){S=Aj.linkCmopName.split(",")}Al.selectpicker("val",S)}Al.selectpicker("refresh");$("#right-property-arg-select").show();var c=a["dataMap"]?a["dataMap"]:{};var AC=$("#right-property-arg-select").find("tr:eq(2)");for(var AL in c){var AQ=AC.clone().show();AQ.appendTo($("#right-property-arg-select"));AQ.find("td:eq(0)").find("input").val(AL);AQ.find("td:eq(1)").find("input").val(c[AL]);AQ.find("input").change(function(){F()})}var w=(Aj.multiselect&&Aj.multiselect==1)?"check":"uncheck";x.find("input").iCheck(w)}else{if(Ad==10){AI.find("td:eq(1)").html("数据集下拉框");var AP=$("#right-property-arg-ds-select");AP.show();var a=Aj["data"]?Aj["data"]:{};var x=m.find("tr:eq(9)");x.show();var e=m.find("tr:eq(10)");e.show();var Al=e.find("select");Al.empty();var O=grid.getSelectComps(Aj.name);for(var p=0;p<O.length;p++){var AR=$("<option></option>");AR.attr("value",O[p]).html(O[p]).appendTo(Al)}if(Aj.linkCmopName){var S=Aj.linkCmopName;if(typeof Aj.linkCmopName=="string"){S=Aj.linkCmopName.split(",")}Al.selectpicker("val",S)}Al.selectpicker("refresh");var AO=a["dataSql"]?a["dataSql"]:{};var AI=AP.find("tr:eq(1)");var AH=anyExcel.getDss();anyExcel.initSelect(AI,AO.dsName,AH);var AG=AP.find("tr:eq(2)");if(AO.dsName){var r=anyExcel.getDsColumns(AO.dsName);anyExcel.initSelect(AG,AO.code,r)}var AF=AP.find("tr:eq(3)");if(AO.dsName){var r=anyExcel.getDsColumns(AO.dsName);anyExcel.initSelect(AF,AO.label,r)}var w=(Aj.multiselect&&Aj.multiselect==1)?"check":"uncheck";x.find("input").iCheck(w)}else{if(Ad==3){AI.find("td:eq(1)").html("下拉日期");var b=m.find("tr:eq(13)");b.show();var AN=Aj.dateFormat!=undefined?Aj.dateFormat:"yyyy-MM-dd";b.find("select").selectpicker("val",AN)}else{if(Ad==4){var a=Aj["data"]?Aj["data"]:{};var AO=a["dataSql"]?a["dataSql"]:{};AI.find("td:eq(1)").html("下拉树型");var AB=m.find("tr:eq(6)");AB.show();var w="uncheck";if(a.multiselect&&a.multiselect==1){w="check"}AB.find("input").iCheck(w);var Ab=$("#right-property-arg-tree");Ab.show();var AH=anyExcel.getDss();var AI=Ab.find("tr:eq(1)");anyExcel.initSelect(AI,AO.dsName,AH);var AG=Ab.find("tr:eq(2)");if(AO.dsName){var r=anyExcel.getDsColumns(AO.dsName);anyExcel.initSelect(AG,AO.pcode,r)}var AF=Ab.find("tr:eq(3)");if(AO.dsName){var r=anyExcel.getDsColumns(AO.dsName);anyExcel.initSelect(AF,AO.code,r)}var AE=Ab.find("tr:eq(4)");if(AO.dsName){var r=anyExcel.getDsColumns(AO.dsName);anyExcel.initSelect(AE,AO.saveCode,r)}var AD=Ab.find("tr:eq(5)");if(AO.dsName){var r=anyExcel.getDsColumns(AO.dsName);anyExcel.initSelect(AD,AO.label,r)}}else{if(Ad==5||Ad==6||Ad==18){var v=Ad==5?"单选按钮":"复选框";AI.find("td:eq(1)").html(v);$("#right-property-arg-select").show();var a=Aj["data"]?Aj["data"]:{};var c=a["dataMap"]?a["dataMap"]:{};var AC=$("#right-property-arg-select").find("tr:eq(2)");for(var AL in c){var AQ=AC.clone().show();AQ.appendTo($("#right-property-arg-select"));AQ.find("td:eq(0)").find("input").val(AL);AQ.find("td:eq(1)").find("input").val(c[AL])}}else{if(Ad==7){AI.find("td:eq(1)").html("密码框")}else{if(Ad==16){AI.find("td:eq(1)").html("隐藏域")}else{if(Ad==8){AI.find("td:eq(1)").html("文本域")}else{if(Ad==17){$("#component-tab").find("li:eq(2)").show();AI.find("td:eq(1)").html("流水号");var n=$("#right-property-arg-seq");var s=Aj.formSequence;if(s!=undefined){var Ae=s.sequences;if(Ae!=undefined){for(var p=0;p<Ae.length;p++){var Ac=Ae[p];if(Ac==null){continue}if(Ac.type==0){var AK=n.find("tr:eq(0)");var k=AK.clone().show();n.append(k);var AX=Ac.text!=undefined?Ac.text:"";k.find("input").val(AX);k.find("input").change(function(){anyExcel.setFormSequence(anyExcel.getFormComponent())});k.find("td:eq(1)").find("a").click(function(){$(this).parent().parent().remove();anyExcel.setFormSequence(anyExcel.getFormComponent())})}else{if(Ac.type==1){var AI=n.find("tr:eq(1)");var h=AI.clone().show();n.append(h);var AN=Ac.dateFormat?Ac.dateFormat:"yyyyMMdd";h.find("select").addClass("selectpicker").selectpicker("refresh");h.find("select").selectpicker("val",AN);h.find("select").change(function(){anyExcel.setFormSequence(anyExcel.getFormComponent())});h.find("td:eq(1)").find("a").click(function(){$(this).parent().parent().remove();anyExcel.setFormSequence(anyExcel.getFormComponent())})}else{if(Ac.type==2){var z=Ac.numCount!=undefined?Ac.numCount:4;var N=Ac.isPrefixZero!=undefined?Ac.isPrefixZero:true;var Ag=Ac.isResetTime!=undefined?Ac.isResetTime:false;var P=Ac.resetTimeUnit!=undefined?Ac.resetTimeUnit:2;var AG=n.find("tr:eq(2)");var g=AG.clone().show();n.append(g);g.find("input[type=text]").val(z);g.find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});g.find("input[name=isPrefixZero]").iCheck(N?"check":"uncheck");g.find("input[name=isResetTime]").iCheck(Ag?"check":"uncheck");g.find("select").addClass("selectpicker").selectpicker("refresh");g.find("select").selectpicker("val",P);g.find("input[type=checkbox]").on("ifChanged",function(i){anyExcel.setFormSequence(anyExcel.getFormComponent())});g.find("input").change(function(){anyExcel.setFormSequence(anyExcel.getFormComponent())});g.find("select").change(function(){anyExcel.setFormSequence(anyExcel.getFormComponent())});g.find("td:eq(1)").find("a").click(function(){$(this).parent().parent().remove();anyExcel.setFormSequence(anyExcel.getFormComponent())})}}}}}var o=s.createType!=undefined?s.createType:0;if(o==0){$("#component-seq-create-type").find("input[type=radio]:eq(0)").iCheck("check")}else{$("#component-seq-create-type").find("input[type=radio]:eq(1)").iCheck("check")}}}else{if(Ad==12){AI.find("td:eq(1)").html("图片");var X=m.find("tr:eq(15)");X.show();var w=(Aj.nowUpload&&Aj.nowUpload==1)?"check":"uncheck";X.find("input").iCheck(w)}else{if(Ad==23){AI.find("td:eq(1)").html("文件上传");var X=m.find("tr:eq(15)");X.show();var w=(Aj.nowUpload&&Aj.nowUpload==1)?"check":"uncheck";X.find("input").iCheck(w)}else{if(Ad==11){AI.find("td:eq(1)").html("文本编辑器")}}}}}}}}}}}}}}var AY=Aj.cmpStyle!=undefined?Aj.cmpStyle:{};var Z=$("#right-property-arg-style");if(AY.border!=undefined){var T=Z.find("tr:eq(0)");T.find("input").val(AY.border)}var Am=Z.find("tr:eq(1)");var w=(AY.percentHeight!=undefined&&AY.percentHeight==100)?"check":"uncheck";Am.find("input[type=checkbox]").iCheck(w);var Ak=Z.find("tr:eq(2)");var j=(AY.percentWidth!=undefined&&AY.percentWidth==100)?"check":"uncheck";Ak.find("input[type=checkbox]").iCheck(j);Am.find("input[type=checkbox]").on("ifChanged",function(Ao){var An=anyExcel.getFormComponent();if(An==null){return false}var i=An.cmpStyle!=undefined?An.cmpStyle:{};i.percentHeight=$(this).is(":checked")?100:0;An.cmpStyle=i});Ak.find("input[type=checkbox]").on("ifChanged",function(Ao){var An=anyExcel.getFormComponent();if(An==null){return false}var i=An.cmpStyle!=undefined?An.cmpStyle:{};i.percentWidth=$(this).is(":checked")?100:0;An.cmpStyle=i});var AV=Z.find("tr:eq(3)");var Aa=AY.background!=undefined?AY.background:null;AV.find("input.color-select").spectrum("set",Aa);var AU=Z.find("tr:eq(4)");var t=AY.borderColor!=undefined?AY.borderColor:null;AU.find("input.color-select").spectrum("set",t);var AT=Z.find("tr:eq(5)");var M=AY.iconColor!=undefined?AY.iconColor:null;AT.find("input.color-select").spectrum("set",M)};var D=function(O){if(O.formatId!=undefined){var P=O.formatId;var M=$("select.tl-data-format-select");if(M.find("option[value="+P+"]").length>0){M.selectpicker("val",P)}else{var N=$("<option value='"+P+"' selected='selected'>"+formats[P]+"</option>");M.append(N);M.selectpicker("refresh")}}else{var M=$("select.tl-data-format-select");M.selectpicker("val","0")}};K();var B=E.data("gc");if(B.mark==2){$("#right-property-arg").show();var I=B.content;C(I)}else{if(B.mark==1){$("#right-property-cell-format").show();$("#right-property-arg").hide();var I=B.content;D(I)}else{$("#right-property-arg").hide()}}};AnyExcel.prototype.appendCellLogicMap=function(D,G){var B=$("#right-property-cell-logic");var F=B.find("tr:eq(2)");var E=F.clone();var C=E.find("td:eq(0)").find("input");var H=E.find("td:eq(1)").find("input");if(D!=undefined){C.val(D)}if(G!=undefined){H.val(G)}B.append(E);E.show();var A=function(){var J=grid.selectedGridCell;if(J==null){return false}var K=J.content;K.logicMap={};var I=B.find("tr:gt(2)");I.each(function(M){var L=$(this).find("td:eq(0)").find("input").val();var N=$(this).find("td:eq(1)").find("input").val();K.logicMap[L]=N})};C.change(function(){A()});H.change(function(){A()})};AnyExcel.prototype.fontColor=function(){var B=$("li.tl-font-color").find("div").attr("style");var A="";if(B!=undefined&&B!=""){A=$.trim(B.split(";")[0].split(":")[1])}this.getGrid().fontColor(A)};AnyExcel.prototype.fontSize=function(A){this.getGrid().fontSize(A)};AnyExcel.prototype.backgroundColor=function(){var B=$("li.tl-background-color").find("div").attr("style");var A="";if(B!=undefined&&B!=""){A=$.trim(B.split(";")[0].split(":")[1])}this.getGrid().backgroundColor(A)};AnyExcel.prototype.clearAlignStyle=function(){var C=$("li.tl-align-left");var A=$("li.tl-align-center");var B=$("li.tl-align-right");C.removeClass("tl-hover");A.removeClass("tl-hover");B.removeClass("tl-hover")};AnyExcel.prototype.clearValignStyle=function(){var A=$("li.tl-valign-top");var C=$("li.tl-valign-middle");var B=$("li.tl-valign-bottom");A.removeClass("tl-hover");C.removeClass("tl-hover");B.removeClass("tl-hover")};AnyExcel.prototype.cellContent=function(A){$("table .cellname").val(A)};AnyExcel.prototype.setColumn3Type=function(A,B,D){var C=function(E){A.find("a.only-a").unbind("click").show();if(E==0){A.find("i").removeClass("icon-down").addClass("icon-collect");A.find("a.only-a").bind("click",columnSelectHandler)}else{if(E==1){A.find("i").removeClass("icon-collect").addClass("icon-down");A.find("a.only-a").bind("click",cellSelectHandler)}else{A.find("a.only-a").hide()}}};A.find("select").change(function(){var E=$(this).val();C(E);A.find("input[type=text]").val("")});A.find("input[type=text]").val(B);if(B==""){A.find("select").selectpicker("val",D)}else{if(B.startsWith("=")){if(B.indexOf(".")!=-1){A.find("select").selectpicker("val",0)}else{A.find("select").selectpicker("val",1)}}else{A.find("select").selectpicker("val",2)}}C(A.find("select").val())};AnyExcel.prototype.setSelectCellText=function(A){$("#win-gridCell-select").find("input").val("="+A)};AnyExcel.prototype.getDss=function(){var B=datasetTree.getNodes();var A=new Array();if(B!=null){for(var C=0;C<B.length;C++){if(B[C].type==1){continue}A.push(B[C].name)}}return A};AnyExcel.prototype.getDsColumns=function(F){var B=datasetTree.getNodes();var A=new Array();if(B!=null){for(var E=0;E<B.length;E++){if(B[E].name==F){var D=B[E].children;if(D!=null){for(var C=0;C<D.length;C++){A.push(D[C].name)}}}}}return A};AnyExcel.prototype.initComponent=function(B){var D=$(B.o);var F=B.content;var J=F.components;if(J==undefined||J.length==0){return }for(var G=0;G<J.length;G++){var C=J[G];var A=$("<div></div>").css("overflow","hidden").width(D.width()).height(D.height());var O=$("<div></div>").addClass("sv").width(D.width()).height(D.height()).appendTo(A);D.append(A);var L=C.editStyle;var I=anyExcel.createComponent(L);if(L==1||L==4||L==17||L==7){I.width(150).height(22);A.find("div.sv").empty().append(I)}else{if(L==2||L==10){I.width(150).height(22);A.find("div.sv").empty().append(I)}else{if(L==3){I.width(150).height(22);A.find("div.sv").empty().append(I);C.dataType=5;anyExcel.initDate(I)}else{if(L==5||L==6){var E=C.data!=undefined?C.data:{};var K=E.dataMap!=undefined?E.dataMap:{};for(var N in K){var H=null;if(C.editStyle==5){H="<input type='radio'/>"}else{if(C.editStyle==6){H="<input type='checkbox'/>"}}if(H!=null){var M=K[N]!=undefined?K[N]:"";H+="<span>"+M+"</span>"}O.append(H)}}else{if(L==12||L==23){A.find("div.sv").append(I)}else{if(L==8||L==11){I.width(150).height(22);A.find("div.sv").empty().append(I)}}}}}}}};AnyExcel.prototype.createComponent=function(D){if(D==1){var B=$("<input type='text'>");return B}else{if(D==2||D==10){var A=$("<select></select>");return A}else{if(D==3){var B=$("<input type='text'>");B.addClass("form_time").attr("data-date-format","yyyy-MM-dd");return B}else{if(D==4){var B=$("<input type='text'>");return B}else{if(D==5){var C=$("<input type='radio'>");return C}else{if(D==6){var E=$("<input type='checkbox'>");return E}else{if(D==7){var B=$("<input type='password'>");return B}else{if(D==8){var B=$("<textarea></textarea>");return B}else{if(D==12){var B=$("<i class='icon iconfont icon-image1'></i>");return B}else{if(D==23){var B=$("<i class='icon iconfont icon-upload1'></i>");return B}else{if(D==11){var B=$("<textarea></textarea>");return B}else{if(D==17){var B=$("<input type='text' value='流水号'>");return B}}}}}}}}}}}}};AnyExcel.prototype.getFormComponent=function(){var D=grid.selectedGridCell;if(D==null){return null}var B=D.content;var A=B.components;if(A==undefined){var C={};A=new Array();A.push(C);B.components=A;return C}else{return A[0]}};AnyExcel.prototype.getGridCellFormComponent=function(D){if(D==null){return null}var B=D.content;var A=B.components;if(A==undefined){var C={};A=new Array();A.push(C);B.components=A;return C}else{return A[0]}};AnyExcel.prototype.formComponentValidator=function(){var B=true;var A=grid.tb.find("tr");for(var D=1;D<A.length;D++){var E=$(A[D]).find("td");for(var C=1;C<E.length;C++){var H=$(E[C]);var G=H.data("gc");if(G.isRemove){continue}if(G.mark!=2){continue}var F=G.getFormComponent();if(F.name==undefined||F.name==""||F.desc==undefined||F.desc==""){H.addClass("comp-error");B=false}}}if(!B){layer.alert("组件名称或是描述不能为空!")}return B};AnyExcel.prototype.selectedFormComponentValidator=function(){var B=grid.selectedGridCell;if(B==null){return }var A=this.getGridCellFormComponent(B);if(A==null){return }var C=$(B.o);if(A.name!=undefined&&A.name!=""&&A.desc!=undefined&&A.desc!=""){C.removeClass("comp-error")}};AnyExcel.prototype.initSelect=function(E,F,A){var D=E.find("select");D.empty();var C=$("<option></option>").appendTo(D);for(var B=0;B<A.length;B++){var C=$("<option></option>");C.attr("value",A[B]).html(A[B]).appendTo(D)}if(F){D.selectpicker("val",F)}D.selectpicker("refresh")};AnyExcel.prototype.initDate=function(A){var G=A.attr("data-date-format");if(A.attr("type")=="hidden"){return true}var F=A.attr("icon-color");if(F!=undefined&&F!=""){A.next().css("color",F)}var D=A.attr("range");var B=D!=undefined&&D=="1"?true:false;var G=A.attr("data-date-format");var E="date";if(G.indexOf("ss")!=-1||G.indexOf("HH")!=-1||G.indexOf("mm")!=-1){if(G.indexOf("dd")!=-1){E="datetime"}else{E="time"}}else{if(G.indexOf("dd")!=-1){E="date"}else{if(G.indexOf("MM")!=-1){E="month"}else{if(G.indexOf("yyyy")!=-1){E="year"}}}}var C={elem:A[0],format:G,type:E,range:B};if(A.attr("tq")!=undefined){if(!A.hasClass(".selectLinkage")){A.change(function(){report.btnQueryWithParam()})}}laydate.render(C);A.next().click(function(H){$(this).prev().trigger("focus");H.stopPropagation()})};AnyExcel.prototype.setFormSequence=function(B){if(B==null){return false}var H=$("#right-property-arg-seq");var F=new Array();H.find("tr:gt(2)").each(function(){var K={};K.id=Utils.uuid();var J=$(this).attr("atype");if(J=="0"){K.type=0;K.text=$(this).find("input").val()}else{if(J=="1"){K.type=1;K.dateFormat=$(this).find("select").val()}else{K.type=2;K.numCount=$(this).find("input[type=text]").val();K.isPrefixZero=$(this).find("input[name=isPrefixZero]").is(":checked");K.isResetTime=$(this).find("input[name=isResetTime]").is(":checked");K.resetTimeUnit=$(this).find("select").val()}}F.push(K)});var C=B.formSequence!=undefined?B.formSequence:{};C.sequences=F;B.formSequence=C;var I="";for(var E=0;E<F.length;E++){var D=F[E];if(D==null){continue}if(D.type==0){I+=D.text!=undefined?D.text:""}else{if(D.type==1){var G=D.dateFormat!=undefined?D.dateFormat:"yyyyMMdd";I+=DateFormat.format(new Date(),G)}else{if(D.type==2){if(D.isPrefixZero){for(var A=0;A<D.numCount;A++){if(A<D.numCount-1){I+="0"}else{I+="1"}}}else{I+="1"}}}}}$("#component-seq-demo").find("span").html(I)};AnyExcel.prototype.initLeftDatasetTree=function(){var F=jform.ds;if(!F){return }for(var G in F){var E=F[G];var G=E.name;var D=datasetTree.addNodes(null,0,{"id":G,"name":G,"ds":true});var A=datasetTree.getNodesByParam("id",G);var C=E.columns;if(C&&C.length>0){for(var B=0;B<C.length;B++){datasetTree.addNodes(A[0],{"id":C[B],"name":C[B],"pId":G},true)}}else{$.ajax({async:false,type:"POST",url:PATH+"/rptMgr/query_ds.htm",data:{sourceName:E.sourceName,sql:E.sql},dataType:"json",success:function(J){var I=J.model;if(I){E.columns=I;if(I.length>0){for(var H=0;H<I.length;H++){datasetTree.addNodes(A[0],{"id":I[H],"name":I[H],"pId":G},true)}}}}})}}};AnyExcel.prototype.clearLeftDatasetTree=function(){if(datasetTree!=null){var B=datasetTree.transformToArray(datasetTree.getNodes());for(var C=0,A=B.length;C<A;C++){if(B[C].id=="_var"||B[C].pId=="_var"){continue}datasetTree.removeNode(B[C])}}};AnyExcel.prototype.fcOnContextmenu=function(E){var G=$(E.currentTarget);var D=G.data("gc");var F=D.rowNum;var B=function(){layer.open({type:1,title:"扩展设置",zIndex:1025,shadeClose:true,area:["400px","250px"],content:$("#win-row-extend"),btn:["确定","取消"],yes:function(H){D.setFirstColIcon("<i class='icon iconfont icon-arrowsdownline red'></i>");var I=jform.rowType!=undefined?jform.rowType:{};I[F]=$("#win-row-extend").find("input").val();jform.rowType=I;layer.close(H)},success:function(){var I=jform.rowType!=undefined?jform.rowType:{};var H=I[F]!=undefined?I[F]:"";$("#win-row-extend").find("input").val(H)}})};var C=function(){var I=$(D.o);I.find("i").remove();var H=jform.rowType!=undefined?jform.rowType:{};H[F]=undefined};var A=[{title:"扩展",icon:"icon iconfont icon-arrowsdownline",fn:B},{title:"取消",icon:"icon iconfont icon-delete",fn:C}];basicContext.show(A,E.originalEvent,true)};AnyExcel.prototype.getGrid=function(){return grid};var Validate={validation:function(B){var A=true;B.find("input").each(function(){var E=$(this).attr("check-type");if(E=="required"){var D=$(this).val();if(D==""){A=false;var C=$(this).attr("required-message");C=C!=""?C:"不能为空";layer.alert(C);return false}}});return A}};var Utils={getString:function(A){if(A==undefined||A==null){return""}return A},containRow:function(B,A){if(A==null){return false}return A.indexOf(B)!=-1},containColumn:function(A,B){if(B==null){return false}return B.indexOf(A)!=-1},setRow:function(B,A){if(Utils.containRow(B,A)){A.splice(A.indexOf(B),1)}else{A.push(B)}},setColumn:function(A,B){if(Utils.containColumn(A,B)){B.splice(B.indexOf(A),1)}else{B.push(A)}},getRowsString:function(C){var A="";for(var B=0;B<C.length;B++){A+=(C[B]-1);if(B<C.length-1){A+=","}}return A},getColumnsString:function(C){var B="";for(var A=0;A<C.length;A++){B+=(C[A]-1);if(A<C.length-1){B+=","}}return B},uuid:function(){var D=[];var A="0123456789abcdef";for(var B=0;B<36;B++){D[B]=A.substr(Math.floor(Math.random()*16),1)}D[14]="4";D[19]=A.substr((D[19]&3)|8,1);D[8]=D[13]=D[18]=D[23]="-";var C=D.join("");return C}};var cellSelectedFlag=false;var formIdx=-1;var cellSelectHandler=function(B){var A=$(this).prev();var C=$(this).prev().val();$("#win-gridCell-select").find("input").val(C);layer.style(formIdx,{"display":"none"});cellSelectedFlag=true;layer.open({type:1,title:"选择单元格",offset:"40px",zIndex:1025,shadeClose:true,shade:false,area:["300px","130px"],content:$("#win-gridCell-select"),btn:["确定","取消"],yes:function(D){var E=$("#win-gridCell-select").find("input").val();if(A.attr("cellType")=="1"){if(E.startsWith("=")){E=E.substr(1)}}else{if(A.attr("cellType")=="2"){E=A.val()+(E.startsWith("=")?E.substr(1):E)}}A.val(E).trigger("change");layer.close(D)},end:function(){cellSelectedFlag=false;$("#win-gridCell-select").find("input").val("");grid.clearSelectBorderColor();layer.style(formIdx,{"display":"block"})}})};var treeSetting={data:{simpleData:{enable:true}}};var dscolumnTree=null;var columnSelectHandler=function(B){var A=$(this).prev();layer.open({type:1,title:"选择数据列",offset:"40px",zIndex:1025,shadeClose:true,shade:false,area:["400px","430px"],content:$("#win-dscolumn-select"),btn:["确定","取消"],yes:function(D){if(dscolumnTree!=null){var G=dscolumnTree.getSelectedNodes();if(G.length>0){var F=G[0];var C=F.getParentNode();if(A.attr("cellType")=="2"){var E=C.name+"."+F.name;A.val(A.val()+E).trigger("change")}else{A.val("="+C.name+"."+F.name).trigger("change")}}}layer.close(D)},success:function(){var C=new Array();var D=datasetTree.getNodes();for(var F=0;F<D.length;F++){var E=D[F];if(E.type==1){continue}C.push(E)}if(dscolumnTree!=null){dscolumnTree.destroy()}dscolumnTree=$.fn.zTree.init($("#win-dscolumn-select-tree"),treeSetting,C)}})};var fxInputSelectHandler=function(C){var B=$(this);var A=$(this).prev();if(A.val()!=null){$(this).data("fx",A.val())}fxHandler(B)};var fxSelectHandler=function(B){var A=$(this);fxHandler(A)};var fxHandler=function(A){formIdx=layer.open({type:1,title:"函数",zIndex:1025,shadeClose:true,shade:false,area:["780px","460px"],content:$("#win-fx"),btn:["确定","取消"],success:function(){var D=false;var C=false;var E=A.data("fx");if(E!=undefined&&E.startWith("=")){var B=E.indexOf("(");if(B==-1){D=false}else{D=true;E=E.substring(1,E.indexOf("("))}}if(D){$("#win-fx-forumula").find("li").each(function(){if($(this).text()==E){C=true;var F=$(this).attr("ptype");$("#win-fx-type").find("li[type="+F+"]").trigger("click");$(this).trigger("click");$("#win-fx-forumula-demo").val(A.data("fx").substring(1))}})}if(!C){$("#win-fx-type").find("li:eq(0)").trigger("click")}},yes:function(B){if(A.attr("type")=="1"){A.prev().val("="+$("#win-fx-forumula-demo").val());A.prev().trigger("change")}else{var C=grid.selectedGridCell;if(C!=null){var D=$("#win-fx-forumula-demo").val();C.setText("="+D);C.setCellMark("="+D)}}layer.close(B)}})};var alertError=function(B,A){layer.open({type:1,title:"错误信息",zIndex:1025,area:["580px","400px"],content:$("#win-error"),btn:["确定"],yes:function(C){layer.close(C)},success:function(){$("#win-error").find("span").html(B);$("#win-error").find("p").html(A)}})};var datasetTree=null;var datasetShareTree=null;$(function(){var AF=new FormXml();var a=$("#win-data-set-sql");var AM=$("#win-data-set-produces");var H=$("#win-data-set-produce-command");a.find("input[type=radio]").iCheck({radioClass:"iradio_minimal",});$("#win-data-set-type").find("div.dataset-restful").iCheck({radioClass:"iradio_minimal",});var AC=function(AO){var AP=AO.columns;var AN=AO.datas;layer.open({type:1,title:"运行结果",zIndex:1025,shadeClose:true,area:["680px","400px"],content:$("#win-sqlset-query"),btn:["确定","取消"],yes:function(AQ){layer.close(AQ)},success:function(){var AQ=$("#win-sqlset-query").find("table");AQ.empty();var AT="<tr class='tbheader'>";if(AP){for(var AS=0;AS<AP.length;AS++){AT+="<td>"+AP[AS]+"</td>"}}AT+="</tr>";if(AN){for(var AS=0;AS<AN.length;AS++){var AU=AN[AS];AT+="<tr>";for(var AR=0;AR<AU.length;AR++){AT+="<td>"+AU[AR]+"</td>"}AT+="</tr>"}}AQ.append(AT)}})};var AJ=$("#win-data-set").find("tr:eq(0)");var p=$("#win-data-set").find("ul.left-menu-ul");p.find("li").click(function(){p.find("li").removeClass("tl-hover");$(this).addClass("tl-hover");a.hide();AM.hide();$("#table-tree").parent().hide();$("#produces-tree").parent().hide();var AO=$(this).attr("type");if(AO=="0"){a.show();$("#table-tree").parent().show()}else{var AN=AM.find("tr:eq(0)");AN.find("select").trigger("change");AM.show();$("#produces-tree").parent().show()}});var AJ=a.find("tr:eq(1)");AJ.find("a").click(function(){if(!Validate.validation($("#win-data-set-sql"))){return false}var Ad=a.find("tr:eq(0)");var AO=Ad.find("select").val();var Ac=a.find("tr:eq(2)");var AP=parseInt(Ac.find("input[type='radio']:checked").val());var AZ=A.getValue();var AN=O(f);var Ae=new Array();var Ab=new Array();var Aa=new Array();var AS=new Array();var Af=new Array();for(var AY=0;AY<AN.length;AY++){var AQ=AN[AY];var AT=AQ.name!=undefined?AQ.name:"";Ae.push(AT);var AX=AQ.dataType!=undefined?AQ.dataType:1;Ab.push(AX);var AV=AQ.dateFormat!=undefined?AQ.dateFormat:"";Aa.push(AV);var AU=AQ.defaultValueType!=undefined?AQ.defaultValueType:0;AS.push(AU);var AW=AQ.defaultValue!=undefined?AQ.defaultValue:"";Af.push(AW)}var AR=layer.load(2,{shade:[0.5,"#fff"]});$.ajax({type:"POST",url:PATH+"/rptMgr/running_sql.htm",data:{sourceName:AO,sql:AZ,parser:AP,argName:Ae,argType:Ab,argDateFormat:Aa,argDefaultValueType:AS,argDefaultValue:Af},dataType:"json",success:function(Ag){layer.close(AR);if(!Ag.success){alertError("sql运行错误",Ag.errorMsg);return false}var Ah=Ag.model;AC(Ah)},error:function(Ag){layer.close(AR);layer.alert("数据集不正确请检查数据源与SQL语句是否正确")}})});var P={data:{simpleData:{enable:true}},callback:{onClick:K}};var e={data:{simpleData:{enable:true}},callback:{onClick:k}};var m={data:{simpleData:{enable:true}},callback:{onClick:o}};function K(AO,AQ,AP){if(!AP.isParent){var AN=AP.name;var AR="select * from "+AN;A.setValue(AR)}}function k(AP,AR,AQ){if(!AQ.isParent){var AO=AQ.name;var AN=AM.find("tr:eq(2)").find("textarea");AN.val(AO)}}function o(AP,AR,AQ){if(!AQ.isParent){var AO=AQ.name;var AN=H.find("tr:eq(2)").find("textarea");AN.val(AO)}}var j=null;var AG=function(AN){$.ajax({type:"POST",url:PATH+"/rptMgr/query_db_names.htm",data:{sourceName:AN},dataType:"json",success:function(AO){if(j!=null){j.destroy()}j=$.fn.zTree.init($("#table-tree"),P,AO)},error:function(AO){if(j!=null){j.destroy()}}})};var r=null;var I=function(AN){$.ajax({type:"POST",url:PATH+"/rptMgr/query_procedures.htm",data:{sourceName:AN},dataType:"json",success:function(AO){if(r!=null){r.destroy()}r=$.fn.zTree.init($("#produces-tree"),e,AO)},error:function(AO){if(r!=null){r.destroy()}}})};var J=null;var x=function(AN){$.ajax({type:"POST",url:PATH+"/rptMgr/query_procedures.htm",data:{sourceName:AN},dataType:"json",success:function(AO){if(J!=null){J.destroy()}J=$.fn.zTree.init($("#produces-command-tree"),m,AO)},error:function(AO){if(J!=null){J.destroy()}}})};var AD=function(){var AN=a.find("tr:eq(1)");AN.find("input").val("");A.setValue("");var AO=a.find("tr:eq(3)");AO.find("input").val("");W(f)};var S=function(){var AN=AM.find("tr:eq(1)");AN.find("input").val("");var AO=AM.find("tr:eq(2)").find("textarea");AO.val("");var AP=AM.find("tr:eq(3)");AP.find("input").val("");v(q)};var N=function(){var AO=$("#win-data-set-type").find("div.sql-command").find("table:eq(0)");var AN=AO.find("tr:eq(1)");AN.find("input").val("");W(l)};var AK=function(){var AN=H.find("tr:eq(1)");AN.find("input").val("");var AO=H.find("tr:eq(2)").find("textarea");AO.val("");var AP=H.find("tr:eq(3)");AP.find("input").val("");v(U)};var T=function(AQ){var AO=a.find("tr:eq(0)");AO.find("select").selectpicker("val",AQ.sourceName);AO.find("select").trigger("change");var AN=a.find("tr:eq(1)");AN.find("input").val(AQ.name);var AS=a.find("tr:eq(2)");var AR=AQ.parser?AQ.parser:0;AS.find("input[value="+AR+"]").iCheck("check");A.setValue(AQ.sql);var AP=a.find("tr:eq(4)");AP.find("input").val(AQ.pageSize);h(f,AQ)};var d=function(AQ){var AP=AM.find("tr:eq(0)");AP.find("select").selectpicker("val",AQ.sourceName);AP.find("select").trigger("change");var AN=AM.find("tr:eq(1)");AN.find("input").val(AQ.name);var AO=AM.find("tr:eq(2)").find("textarea");AO.val(AQ.sql);E(q,AQ)};var C=function(AP){var AQ=$("#win-data-set-type").find("div.sql-command").find("table:eq(0)");var AO=AQ.find("tr:eq(0)");AO.find("select").selectpicker("val",AP.sourceName);AO.find("select").trigger("change");var AN=AQ.find("tr:eq(1)");AN.find("input").val(AP.name);L.setValue(AP.sql);h(l,AP)};var D=function(AQ){var AP=H.find("tr:eq(0)");AP.find("select").selectpicker("val",AQ.sourceName);AP.find("select").trigger("change");var AN=H.find("tr:eq(1)");AN.find("input").val(AQ.name);var AO=H.find("tr:eq(2)").find("textarea");AO.val(AQ.sql);E(U,AQ)};var Y=function(AR){var Aa=false;var Ai=a.find("tr:eq(0)");var AO=Ai.find("select").val();var Ah=a.find("tr:eq(1)");var AT=Ah.find("input").val();var Ag=a.find("tr:eq(2)");var AP=parseInt(Ag.find("input[type='radio']:checked").val());var Ab=A.getValue();var Ad=a.find("tr:eq(4)");var Ae=Ad.find("input").val();var AN=O(f);var Aj=new Array();var Af=new Array();var Ac=new Array();var AS=new Array();var Ak=new Array();for(var AZ=0;AZ<AN.length;AZ++){var AQ=AN[AZ];var AU=AQ.name!=undefined?AQ.name:"";Aj.push(AU);var AY=AQ.dataType!=undefined?AQ.dataType:1;Af.push(AY);var AW=AQ.dateFormat!=undefined?AQ.dateFormat:"";Ac.push(AW);var AV=AQ.defaultValueType!=undefined?AQ.defaultValueType:0;AS.push(AV);var AX=AQ.defaultValue!=undefined?AQ.defaultValue:"";Ak.push(AX)}$.ajax({type:"POST",url:PATH+"/rptMgr/query_ds.htm",async:false,data:{sourceName:AO,sql:Ab,parser:AP,argName:Aj,argType:Af,argDateFormat:Ac,argDefaultValueType:AS,argDefaultValue:Ak},dataType:"json",success:function(Ay){var Am=Ay.code;if(Am==304){alertError("数据集不正确请检查数据源与SQL语句是否正确!",Ay.errorMsg);return false}if(Am==305){var Aq="数据列[ "+Ay.errorMsg+' ]不能包含"("请使用别名!';alertError(Aq,Ay.errorMsg);return false}if(Am==306){var Ap="数据列[ "+Ay.errorMsg+' ]不能包含")"请使用别名!';alertError(Ap,Ay.errorMsg);return false}var Au=$(".tab-source-share").attr("aria-expanded");var Aw=Au=="true";var Av=Aw?datasetShareTree:datasetTree;var Ao=Ay.model;if(Av!=null){var Ax=Av.addNodes(null,0,{"id":AT,"name":AT,"ds":true});var At=Av.getNodesByParam("id",AT);if(At.length>0){for(var As=0;As<Ao.length;As++){Av.addNodes(At[0],{"id":Ao[As],"name":Ao[As],"pId":AT})}}var Ar={};Ar.name=AT;Ar.sourceName=AO;Ar.sql=Ab;Ar.type=0;Ar.parser=AP;Ar.pageSize=Ae;Ar.columns=Ao;Ar.args=AN;if(Aw){$.ajax({type:"POST",url:PATH+"/rptMgr/add_share_dataset.htm",data:{dsName:AT,dsContent:AF.stringifyDataSet(Ar)},dataType:"text",success:function(Az){},error:function(){layer.alert("新增共享数据集失败!")}});var An=jform.shareDs?jform.shareDs:{};An[AT]=Ar;jform.shareDs=An}else{var Al=jform.ds?jform.ds:{};Al[AT]=Ar;jform.ds=Al}}Aa=true;layer.close(AR)},error:function(Al){layer.alert("数据集不正确请检查数据源与SQL语句是否正确")}});return Aa};var u=function(AS){var AU=false;var AR=AM.find("tr:eq(0)");var AO=AR.find("select").val();var AQ=AM.find("tr:eq(1)");var AN=AQ.find("input").val();var AW=AM.find("tr:eq(2)").find("textarea");var AY=AW.val();var AT=z(q);var AV=new Array();var AX=new Array();for(var AP=0;AP<AT.length;AP++){AV.push(AT[AP].dataType);AX.push(AT[AP].modelType)}$.ajax({type:"POST",url:PATH+"/rptMgr/query_procedure_columns.htm",async:false,data:{sourceName:AO,sql:AY,dataType:AV,modelType:AX},dataType:"json",success:function(Ae){var Ag=Ae.code;if(Ag==304){alertError("数据集不正确请检查存储过程是否正确!",Ae.errorMsg);return false}var Ad=Ae.model;var Ac=datasetTree.addNodes(null,0,{"id":AN,"name":AN,"ds":true});var AZ=datasetTree.getNodesByParam("id",AN);if(AZ.length>0){for(var Ab=0;Ab<Ad.length;Ab++){datasetTree.addNodes(AZ[0],{"id":Ad[Ab],"name":Ad[Ab],"pId":AN})}}var Aa={};Aa.name=AN;Aa.sourceName=AO;Aa.sql=AY;Aa.type=1;Aa.columns=Ad;Aa.args=AT;var Af=jform.ds?jform.ds:{};Af[AN]=Aa;jform.ds=Af;AU=true;layer.close(AS)},error:function(AZ){layer.alert("数据集不正确请检查存储过程是否正确")}});return AU};var b=function(AU){var Ag=false;var AT=$("#win-data-set-sql-command");var Am=AT.find("tr:eq(0)");var AP=Am.find("select").val();var Al=AT.find("tr:eq(1)");var AW=Al.find("input").val();var Ai=L.getValue();var AO=O(l);var An=new Array();var Ak=new Array();var Aj=new Array();var AV=new Array();var Ao=new Array();for(var Ah=0;Ah<AO.length;Ah++){var AS=AO[Ah];var AX=AS.name!=undefined?AS.name:"";An.push(AX);var Ad=AS.dataType!=undefined?AS.dataType:1;Ak.push(Ad);var Aa=AS.dateFormat!=undefined?AS.dateFormat:"";Aj.push(Aa);var AY=AS.defaultValueType!=undefined?AS.defaultValueType:0;AV.push(AY);var Ab=AS.defaultValue!=undefined?AS.defaultValue:"";Ao.push(Ab)}var Ac=$(".tab-source-share").attr("aria-expanded");var AQ=Ac=="true";var Af=AQ?datasetShareTree:datasetTree;if(Af!=null){var AN=Af.addNodes(null,0,{"id":AW,"name":AW,"ds":true});var Ae={};Ae.name=AW;Ae.sourceName=AP;Ae.sql=Ai;Ae.type=20;Ae.args=AO;if(AQ){$.ajax({type:"POST",url:PATH+"/rptMgr/add_share_dataset.htm",data:{dsName:AW,dsContent:AF.stringifyDataSet(Ae)},dataType:"text",success:function(Ap){},error:function(){layer.alert("新增共享数据集失败!")}});var AR=jform.shareDs?jform.shareDs:{};AR[AW]=Ae;jform.shareDs=AR}else{var AZ=jform.ds?jform.ds:{};AZ[AW]=Ae;jform.ds=AZ}}Ag=true;layer.close(AU);return Ag};var AI=function(AU){var AW=false;var AT=H.find("tr:eq(0)");var AO=AT.find("select").val();var AS=H.find("tr:eq(1)");var AN=AS.find("input").val();var AZ=H.find("tr:eq(2)").find("textarea");var Ab=AZ.val();var AV=z(U);var AX=new Array();var Aa=new Array();for(var AR=0;AR<AV.length;AR++){AX.push(AV[AR].dataType);Aa.push(AV[AR].modelType)}var AY=datasetTree.addNodes(null,0,{"id":AN,"name":AN,"ds":true});var AQ={};AQ.name=AN;AQ.sourceName=AO;AQ.sql=Ab;AQ.type=21;AQ.args=AV;var AP=jform.ds?jform.ds:{};AP[AN]=AQ;jform.ds=AP;AW=true;layer.close(AU);return AW};var AE=$(window).width();var F=$(window).height();var G=Math.min(860,AE-10);var Q=Math.min(520,F-10);$("li.tl-dataset-add").click(function(){layer.open({type:1,title:"数据集",zIndex:1025,shadeClose:true,shade:false,area:[G+"px",Q+"px"],content:$("#win-data-set-type"),btn:["确定","取消","返回"],yes:function(AP){var AN=$("#win-data-set-type").find("div.dataType").find("li.at");var AO=false;if(AN.length>0){var AQ=AN.attr("dataType");if(AQ=="0"){if(Validate.validation($("#win-data-set-sql"))){AO=Y(AP)}}else{if(AQ=="1"){if(Validate.validation($("#win-data-set-produces"))){AO=u(AP)}}else{if(AQ=="20"){if(Validate.validation($("#win-data-set-sql-command"))){AO=b(AP)}}else{if(AQ=="21"){if(Validate.validation($("#win-data-set-produce-command"))){AO=AI(AP)}}}}}}if(AO){layer.close(AP)}},btn3:function(){var AN=$("#win-data-set-type").parent().parent();AN.find("div.layui-layer-btn").find("a:eq(0)").hide();AN.find("div.layui-layer-btn").find("a:eq(2)").hide();$("#win-data-set-type").children("div").hide();$("#win-data-set-type").children(":eq(0)").show();return false},success:function(){var AN=$("#win-data-set-type").parent().parent();AN.find("div.layui-layer-btn").find("a:eq(0)").hide();AN.find("div.layui-layer-btn").find("a:eq(2)").hide();$("#win-data-set-type").children("div").hide();$("#win-data-set-type").children(":eq(0)").show()}})});$("#win-data-set-type").find("div.dataType").find("li").click(function(){var AP=$(this).attr("dataType");$("#win-data-set-type").find("div.dataType").find("li").removeClass("at");$("#win-data-set-type").find("div.dataType").hide();var AQ=$("#win-data-set-type").parent().parent();AQ.find("div.layui-layer-btn").find("a").show();$(this).addClass("at");if(AP=="0"){$("#win-data-set-type").find("div.sql-query").show();AD();var AN=a.find("tr:eq(0)");var AO=AN.find("select").val();AG(AO);A.refresh()}else{if(AP=="1"){$("#win-data-set-type").find("div.sql-produce").show();S();var AN=AM.find("tr:eq(0)");var AO=AN.find("select").val();I(AO)}else{if(AP=="20"){$("#win-data-set-type").find("div.sql-command").show();N()}else{if(AP=="21"){$("#win-data-set-type").find("div.sql-produce-command").show();AK();var AN=H.find("tr:eq(0)");var AO=AN.find("select").val();x(AO)}}}}});var AB=a.find("tr:eq(0)");AB.find("select").change(function(){AG($(this).val())});AM.find("tr:eq(0)").find("select").change(function(){I($(this).val())});H.find("tr:eq(0)").find("select").change(function(){x($(this).val())});var g={curTarget:null,curTmpTarget:null,dragTree2Dom:function(AO,AN){return !AN[0].isParent},prevTree:function(AO,AN,AP){return !AP.isParent&&AP.parentTId==AN[0].parentTId},nextTree:function(AO,AN,AP){return !AP.isParent&&AP.parentTId==AN[0].parentTId},innerTree:function(AO,AN,AP){return AP!=null&&AP.isParent&&AP.tId==AN[0].parentTId},dragMove:function(AR,AP,AO){var AQ=null,AN="dom_"+AO[0].pId;if(AR.target.id==AN){AQ=$(AR.target)}else{AQ=$(AR.target).parent("#"+AN);if(!AQ.get(0)){AQ=null}}$(".domBtnDiv .active").removeClass("active");if(AQ){AQ.addClass("active")}},dropTree2Dom:function(AU,AR,AQ,AV,Aa){var AS=$(".tab-report-arg").attr("aria-expanded");if(AS=="true"){return false}var AO=AQ[0].name;var AN=AQ[0].getParentNode().name;var AX=$("#left-column-value-type").find("input[type=radio]:checked").val();var AW="="+AN+"."+AO;if(AX=="2"){AW="=group("+(AN+"."+AO)+")"}else{if(AX=="3"){AW="=sum("+(AN+"."+AO)+")"}else{if(AX=="4"){AW="=avg("+(AN+"."+AO)+")"}else{if(AX=="5"){AW="=max("+(AN+"."+AO)+")"}else{if(AX=="6"){AW="=min("+(AN+"."+AO)+")"}}}}}var AT=$(AU.target);if(AT.is("span")){var AP=AT.parent().parent().parent();if(AP.is("td")){AP.empty();var AY=AP.data("gc");var AZ=AQ[0].type==1?AO:AW;AY.acceptDsColumn(AZ)}}if(AT.parent().parent().is("td")){var AP=AT.parent().parent();AP.empty();var AY=AP.data("gc");var AZ=AQ[0].type==1?AO:AW;AY.acceptDsColumn(AZ)}else{if(AT.is("td")){var AY=AT.data("gc");var AZ=AQ[0].type==1?AO:AW;AY.acceptDsColumn(AZ)}}}};var t={edit:{enable:true,showRemoveBtn:s,showRenameBtn:AL,renameTitle:"更新数据集",removeTitle:"删除数据集",drag:{prev:g.prevTree,next:g.nextTree,inner:g.innerTree}},data:{simpleData:{enable:true}},callback:{beforeDrag:g.dragTree2Dom,onDrop:g.dropTree2Dom,onDragMove:g.dragMove,beforeEditName:n,beforeRemove:c},view:{selectedMulti:false}};function n(AR,AQ){var AN=$(".tab-source-share").attr("aria-expanded");var AP=AN=="true";var AS=AQ.name;var AO;layer.open({type:1,title:"数据集",zIndex:1025,shadeClose:true,shade:false,area:[G+"px",Q+"px"],content:$("#win-data-set-type"),btn:["确定","取消"],yes:function(AW){var AY=AP?datasetShareTree:datasetTree;var AV=AY.getNodesByParam("id",AS);if(AP){$.ajax({type:"POST",url:PATH+"/rptMgr/del_share_dataset.htm",data:{dsName:AS},dataType:"text",success:function(AZ){},error:function(){layer.alert("数据集更新失败!")}});var AU=jform.shareDs?jform.shareDs:{};AU[AS]=undefined}else{var AX=jform.ds?jform.ds:{};AX[AS]=undefined}var AT=false;if(AO==0){if(Validate.validation($("#win-data-set-sql"))){AT=Y(AW)}}else{if(AO==1){if(Validate.validation($("#win-data-set-produces"))){AT=u(AW)}}else{if(AO==20){if(Validate.validation($("#win-data-set-sql-command"))){AT=b(AW)}}else{if(AO==21){if(Validate.validation($("#win-data-set-produce-command"))){AT=AI(AW)}}}}}if(AT){if(AV.length>0){AY.removeNode(AV[0])}layer.close(AW)}},success:function(){var AT=AP?jform.shareDs:jform.ds;if(AT!=undefined){var AU=AT[AS];if(AU){AO=AU.type;$("#win-data-set-type").children("div").hide();if(AU.type==0){$("#win-data-set-type").find("div.sql-query").show();AD();T(AU)}else{if(AU.type==1){$("#win-data-set-type").find("div.sql-produce").show();S();d(AU)}else{if(AU.type==20){$("#win-data-set-type").find("div.sql-command").show();N();C(AU)}else{if(AU.type==21){$("#win-data-set-type").find("div.sql-produce-command").show();AK();D(AU)}}}}}}}});return false}function c(AS,AR){var AO=$(".tab-source-share").attr("aria-expanded");var AP=AO=="true";var AT=AR.name;if(AP){$.ajax({type:"POST",url:PATH+"/rptMgr/del_share_dataset.htm",data:{dsName:AT},dataType:"text",success:function(AU){},error:function(){layer.alert("数据集删除失败!")}});var AN=jform.shareDs?jform.shareDs:{};AN[AT]=undefined}else{var AQ=jform.ds?jform.ds:{};AQ[AT]=undefined}}function s(AO,AN){return AN.ds!=undefined}function AL(AO,AN){return AN.ds!=undefined}var Z=[{id:"_var",pId:0,name:"内置变量",type:1},{id:"_userId",pId:"_var",name:"${_userId}",type:1},{id:"_userName",pId:"_var",name:"${_userName}",type:1},{id:"_personName",pId:"_var",name:"${_personName}",type:1},{id:"_orgId",pId:"_var",name:"${_orgId}",type:1},{id:"_orgName",pId:"_var",name:"${_orgName}",type:1},{id:"_userPhone",pId:"_var",name:"${_userPhone}",type:1},{id:"_userEmail",pId:"_var",name:"${_userEmail}",type:1}];datasetTree=$.fn.zTree.init($("#dataset-tree"),t,Z);$("li.tl-dataset-share-add").click(function(){$("li.tl-dataset-add").trigger("click")});$.ajax({type:"POST",url:PATH+"/rptMgr/query_share_dataset.htm",dataType:"json",success:function(AU){var AN={};var AS=new Array();for(var AR=0;AR<AU.length;AR++){var AV=AU[AR];var AT={id:AV.dsName,name:AV.dsName,ds:true};AS.push(AT);var AQ=AF.parseShareDataSet(AV.dsContent);AN[AV.dsName]=AQ;var AO=AQ.columns;for(var AP=0;AP<AO.length;AP++){AT={id:AO[AP],name:AO[AP],pId:AV.dsName};AS.push(AT)}}jform.shareDs=AN;datasetShareTree=$.fn.zTree.init($("#dataset-share-tree"),t,AS)}});var V={data:{simpleData:{enable:true}}};var w=null;var i=function(AR){if(!AR){return }var AT=AR.name;var AQ=datasetTree.addNodes(null,0,{"id":AT,"name":AT,"ds":true});var AN=datasetTree.getNodesByParam("id",AT);var AP=AR.columns;if(AP&&AP.length>0){for(var AO=0;AO<AP.length;AO++){datasetTree.addNodes(AN[0],{"id":AP[AO],"name":AP[AO],"pId":AT})}}var AS=jform.ds?jform.ds:{};AS[AT]=AR;jform.ds=AS};$("li.tl-dataset-add-from-share").click(function(){layer.open({type:1,title:"引用共享数据集",zIndex:1025,shadeClose:true,area:["480px","400px"],content:$("#win-dataset-from-share"),btn:["确定","取消"],yes:function(AP){if(w!=null){var AO=w.getSelectedNodes();if(AO.length>0){var AQ=AO[0];var AN=jform.shareDs;if(AN){i(AN[AQ.name])}}}layer.close(AP)},success:function(){var AN=jform.shareDs;if(AN){var AS=new Array();for(var AT in AN){var AQ=AN[AT];var AR={id:AT,name:AT,ds:true};AS.push(AR);var AP=AQ.columns;if(AP&&AP.length>0){for(var AO=0;AO<AP.length;AO++){if(AQ.type==6){AR={id:AP[AO].name,name:AP[AO].name,pId:AT}}else{AR={id:AP[AO],name:AP[AO],pId:AT}}AS.push(AR)}}}w=$.fn.zTree.init($("#win-dataset-from-share-tree"),V,AS)}}})});var X=AM.find("ul.top-menu");var q=AM.find("table");X.find("li").click(function(){R(q)});var M=H.find("ul.top-menu");var U=H.find("table");M.find("li").click(function(){R(U)});var R=function(AU){var AT=AU.find("tr:eq(1)").clone();AT.show();var AV=AT.find("td:eq(0)");AV.html(AU.find("tr").length-1);AU.append(AT);var AR=AT.find("td:eq(2)");AR.find("select").addClass("selectpicker").selectpicker("refresh");var AQ=AT.find("td:eq(3)");var AS=AQ.find("select");var AO=grid.getArgNames();B(AS,AO);var AP=AT.find("td:eq(4)");AP.find("select").addClass("selectpicker").selectpicker("refresh");var AN=AT.find("td:eq(5)");AN.find("a").click(function(){$(this).parent().parent().remove();AA()})};var AA=function(){q.find("tr:gt(0)").each(function(AN){var AO=$(this).find("td:eq(0)");AO.html(AN)})};var v=function(AN){AN.find("tr:gt(1)").remove()};var E=function(AY,AV){if(!AV){return }var AX=AV.args;if(AX){for(var AW=0;AW<AX.length;AW++){var Aa=AX[AW];var AT=AY.find("tr:eq(1)").clone();AT.show();var AZ=AT.find("td:eq(0)");AZ.html(AY.find("tr").length-1);var AU=AT.find("td:eq(1)");var AN=Aa.name!=undefined?Aa.name:"";AU.find("input").val(AN);var AS=AT.find("td:eq(2)");AS.find("select").addClass("selectpicker").selectpicker("refresh");if(Aa.dataType!=undefined){AS.find("select").selectpicker("val",Aa.dataType)}var AR=AT.find("td:eq(3)");var AQ=grid.getArgNames();B(AR.find("select"),AQ);if(Aa.value){AR.find("select").selectpicker("val",Aa.value)}var AP=AT.find("td:eq(4)");AP.find("select").addClass("selectpicker").selectpicker("refresh");if(Aa.modelType){AP.find("select").selectpicker("val",Aa.modelType)}AY.append(AT);var AO=AT.find("td:eq(5)");AO.find("a").click(function(){$(this).parent().parent().remove();AA()})}}};var B=function(AQ,AR){AQ.empty();for(var AP=0;AP<AR.length;AP++){var AN=AR[AP];var AO=$("<option></option>").attr("value",AN).html(AN);AQ.append(AO)}AQ.selectpicker("refresh")};var z=function(AO){var AN=new Array();AO.find("tr:gt(1)").each(function(){var AP={};var AT=$(this).find("td:eq(1)");AP.name=AT.find("input").val();var AS=$(this).find("td:eq(2)");AP.dataType=AS.find("select").val();var AR=$(this).find("td:eq(3)");AP.value=AR.find("select").val();var AQ=$(this).find("td:eq(4)");AP.modelType=AQ.find("select").val();AN.push(AP)});return AN};var f=a.find("table");var AH=f.parent().prev().find("a").click(function(){y(f)});var l=$("#win-data-set-sql-command").find("table");l.parent().prev().find("a").click(function(){y(l)});var h=function(AR,AQ){W(AR);if(!AQ){return }var AO=AQ.args;if(AO!=undefined&&AO.length>0){for(var AP=0;AP<AO.length;AP++){var AN=AO[AP];y(AR,AN)}}};var y=function(AX,AP){var AP=AP?AP:{};var AQ=AX.find("tr:eq(1)").clone().show();AQ.find("select").addClass("selectpicker").selectpicker("refresh");var AW=AQ.find("td:eq(0)");if(AP.name!=undefined){AW.find("input").val(AP.name)}var AR=AQ.find("td:eq(1)");var AV=AR.find("select:eq(0)");AV.change(function(){var AY=parseInt($(this).val());if(AY==5){$(AR.children("span")[1]).show()}else{$(AR.children("span")[1]).hide()}});if(AP.dataType!=undefined){AV.selectpicker("val",AP.dataType);AV.trigger("change")}var AU=AR.find("select:eq(1)");if(AP.dateFormat!=undefined){AU.selectpicker("val",AP.dateFormat)}var AO=AQ.find("td:eq(2)");var AT=$(AO.children("span")[0]);var AS=$(AO.children("span")[1]);AT.find("select").change(function(){var AY=$(this).val();if(AY=="0"){AS.children("input").show();AS.children("a").hide();AS.children("span").hide()}else{if(AY=="1"){AS.children("input").show();AS.children("a").show();AS.children("span").hide()}else{AS.children("input").hide();AS.children("a").hide();AS.children("span").show()}}});AS.children("a").bind("click",fxInputSelectHandler);if(AP.defaultValueType!=undefined){AT.find("select").selectpicker("val",AP.defaultValueType)}AT.find("select").trigger("change");if(AP.defaultValueType==0||AP.defaultValueType==1){if(AP.defaultValue!=undefined){AS.children("input").val(AP.defaultValue)}}else{AS.find("select").selectpicker("val",AP.defaultValue)}var AN=AQ.find("td:eq(3)");AN.find("a").click(function(){$(this).parent().parent().remove()});AX.append(AQ)};var O=function(AO){var AN=new Array();AO.find("tr:gt(1)").each(function(){var AQ={};var AW=$(this).find("td:eq(0)");AQ.name=AW.find("input").val();var AR=$(this).find("td:eq(1)");var AV=AR.find("select:eq(0)");AQ.dataType=parseInt(AV.val());if(AQ.dataType==5){var AU=AR.find("select:eq(1)");AQ.dateFormat=AU.val()}var AP=$(this).find("td:eq(2)");var AT=$(AP.children("span")[0]);var AS=$(AP.children("span")[1]);var AX=parseInt(AT.find("select").val());AQ.defaultValueType=AX;if(AX==0||AX==1){AQ.defaultValue=AS.children("input").val()}else{AQ.defaultValue=AS.find("select").val()}AN.push(AQ)});return AN};var W=function(AN){AN.find("tr:gt(1)").remove()};var A=CodeMirror.fromTextArea(document.getElementById("win-data-set-sql-sql"),{mode:"text/x-sql",theme:"neat",smartIndent:true,lineNumbers:true,matchBrackets:true});var L=CodeMirror.fromTextArea(document.getElementById("win-data-set-sql-command-sql"),{mode:"text/x-sql",theme:"neat",smartIndent:true,lineNumbers:true,matchBrackets:true})});$(function(){$("td.fc").on("contextmenu",function(A){anyExcel.fcOnContextmenu(A)})});$(function(){var A=null;grid.tb.find("tr:gt(0)").find("td:gt(0)").on("contextmenu",function(E){var B=function(){A=grid.selectedGridCell};var D=function(){if(A!=null){var H=$(A.o);var F=grid.selectedGridCell;if(F!=null){F.content=A.content;F.mark=A.mark;var G=$(F.o);G.empty().append(H.children().clone(true))}A=null}};var C=[{title:"复制",icon:"icon iconfont icon-copy",fn:B},{title:"粘贴",icon:"icon iconfont icon-paste",fn:D}];basicContext.show(C,E.originalEvent,true)})});$(function(){$("a.tl-data-format").click(function(){var A=$(this);layer.open({type:1,title:"数据格式",zIndex:1025,shadeClose:true,area:["480px","400px"],content:$("#win-data-format"),btn:["确定","取消"],yes:function(D){var C=$("#win-data-format").find("input[name=format]");if(C.val()!=""){var B=A.prev().find("select");var E=$("<option value='"+C.attr("code")+"' selected='selected'>"+C.val()+"</option>");B.append(E);B.selectpicker("refresh");B.trigger("change")}layer.close(D)},success:function(){$("#win-data-format").find("div.money-type").hide()}})});$("#win-data-format").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-data-format").find("input[type=checkbox]").on("ifChanged",function(A){anyExcel.getGrid().localeUs($(this).is(":checked"))});$("#win-data-format").find("ul.formatType").children("li").click(function(){var A=$(this).attr("type");$("#win-data-format-content").find("ul").hide();$("#win-data-format").find("div.money-type").hide();if(A=="1"){$("#win-data-format-content").find("ul.number").show()}else{if(A=="2"){$("#win-data-format-content").find("ul.date").show()}else{if(A=="3"){$("#win-data-format-content").find("ul.datetime").show()}else{if(A=="4"){$("#win-data-format-content").find("ul.time").show()}else{if(A=="5"){$("#win-data-format-content").find("ul.money").show();$("#win-data-format").find("div.money-type").show()}else{if(A=="6"){$("#win-data-format-content").find("ul.percent").show()}}}}}}});$("#win-data-format").find("select").change(function(){var A=$(this).val();$("#win-data-format-content").find("ul").hide();if(A=="￥"){$("#win-data-format-content").find("ul.money").show()}else{if(A=="$"){$("#win-data-format-content").find("ul.money1").show()}else{if(A=="US$"){$("#win-data-format-content").find("ul.money2").show()}}}});$("#win-data-format-content").find("li").click(function(){var A=$(this).text();$("#win-data-format").find("input[name=format]").val(A);$("#win-data-format").find("input[name=format]").attr("code",$(this).attr("val"))});$("select.tl-data-format-select").change(function(){var A=$(this).val();anyExcel.getGrid().formatId(A)})});$(function(){$("#right-property-arg").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#component-style").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});var Q=function(o){var q=grid.selectedGridCell;if(q==null){return false}var r=$(q.o);var p=q.content;switch(p.editStyle){case 1:case 3:case 4:case 7:case 16:case 9:r.find("div").find("input").width(o);break;case 2:case 10:r.find("div").find("select").width(o);r.find("div").find("select").attr("data-width",o);r.find("div").find("select").selectpicker("refresh");r.find("div.bootstrap-select").width(o);break}};var R=function(o){var q=grid.selectedGridCell;if(q==null){return false}var r=$(q.o);var p=q.content;switch(p.editStyle){case 1:case 3:case 4:case 7:case 16:case 9:r.find("div").find("input").height(o);break}};var M=$("#right-property-arg");var a=M.find("tr:eq(2)");a.find("input").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.name=$(this).val();anyExcel.selectedFormComponentValidator()});var Z=M.find("tr:eq(3)");Z.find("input").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.desc=$(this).val();anyExcel.selectedFormComponentValidator()});var X=M.find("tr:eq(4)");X.find("input").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.width=$(this).val()});X.find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.widthUnit=$(this).val()});var W=M.find("tr:eq(5)");W.find("input").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.height=$(this).val()});W.find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.heightUnit=$(this).val()});var V=M.find("tr:eq(6)");V.find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.readOnly=$(this).val()});var U=M.find("tr:eq(7)");U.find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.display=$(this).val()});var T=M.find("tr:eq(8)");T.find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.dataType=$(this).val()});var H=function(o){var p=anyExcel.getFormComponent();if(p==null){return false}if(o){p.multiselect=1}else{p.multiselect=0}};var S=M.find("tr:eq(9)");S.find("input").on("ifChecked",function(o){H(true)}).on("ifUnchecked",function(o){H(false)});var i=M.find("tr:eq(10)");i.find("select").selectpicker({iconBase:"fa",tickIcon:"fa-check red"});i.find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.linkCmopName=$(this).val()});var f=M.find("tr:eq(12)");f.find("td:eq(0)").find("select").change(function(){var p=anyExcel.getFormComponent();if(p==null){return false}p.defaultValueType=parseInt($(this).val());var o=f.find("td:eq(1)").children();o.hide();if(p.defaultValueType==0){$(o[0]).show()}else{if(p.defaultValueType==1){$(o[0]).show();$(o[1]).show()}else{$(o[2]).show()}}});f.find("td:eq(1)").find("input").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.defaultValue=$(this).val()});f.find("td:eq(1)").find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.defaultValue=$(this).val()});var d=M.find("tr:eq(13)");d.find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.dateFormat=$(this).val()});var c=M.find("tr:eq(14)");c.find("select").change(function(){var o=anyExcel.getFormComponent();if(o==null){return false}o.formatId=$(this).val()});var b=M.find("tr:eq(15)");b.find("input").on("ifChecked",function(o){var p=anyExcel.getFormComponent();if(p==null){return false}p.nowUpload=1}).on("ifUnchecked",function(o){var p=anyExcel.getFormComponent();if(p==null){return false}p.nowUpload=undefined});var L=function(){var o={};$("#right-property-arg-select").find("tr:gt(2)").each(function(){var u=$(this).find("td:eq(0)");var t=u.find("input").val();var s=$(this).find("td:eq(1)");var v=s.find("input").val();o[t]=v});var r=anyExcel.getFormComponent();if(r==null){return false}var p=r.data?r.data:{};p.dataMap=o;r.data=p;if(r.editStyle!=2){var q=grid.selectedGridCell;if(q!=null){C(q,o)}}};var C=function(u,p){if(!p){return }var t=anyExcel.getFormComponent();if(t==null){return }var s=u.content;var v=$(u.o);v.find("div.sv").empty();for(var r in p){var o=null;if(t.editStyle==5){o="<input type='radio'/>"}else{if(t.editStyle==6||t.editStyle==18){o="<input type='checkbox'/>"}}if(o!=null){var q=p[r]!=undefined?p[r]:"";o+="<span>"+q+"</span>"}v.find("div.sv").append(o)}};var P=$("#right-property-arg-select").find("ul.top-menu");var B=P.children();$(B[0]).click(function(){var p=$("#right-property-arg-select").find("tr:eq(2)");var o=p.clone().show();o.appendTo($("#right-property-arg-select"));o.find("input").bind("change",function(){L()})});$(B[1]).click(function(){var o=$("#right-property-arg-select");var p=o.find("tr:last");if(p.is(":visible")){p.remove();L()}});var G=function(p,r){var s=anyExcel.getFormComponent();if(s==null){return false}var q=s.data?s.data:{};var o=q.dataSql?q.dataSql:{};o[p]=r;q.dataSql=o;s.data=q};var K=$("#right-property-arg-ds-select").find("tr:eq(1)");var J=$("#right-property-arg-ds-select").find("tr:eq(2)");var I=$("#right-property-arg-ds-select").find("tr:eq(3)");K.find("select").change(function(){G("dsName",$(this).val());var o=anyExcel.getDsColumns($(this).val());anyExcel.initSelect(J,"",o);anyExcel.initSelect(I,"",o);J.find("select").trigger("change");I.find("select").trigger("change")});J.find("select").change(function(){G("code",$(this).val())});I.find("select").change(function(){G("label",$(this).val())});var h=$("#right-property-arg-tree");var A=h.find("tr:eq(1)");var n=h.find("tr:eq(2)");var l=h.find("tr:eq(3)");var k=h.find("tr:eq(4)");var j=h.find("tr:eq(5)");A.find("select").change(function(){G("dsName",$(this).val());var o=anyExcel.getDsColumns($(this).val());anyExcel.initSelect(n,"",o);anyExcel.initSelect(l,"",o);anyExcel.initSelect(k,"",o);anyExcel.initSelect(j,"",o);n.find("select").trigger("change");l.find("select").trigger("change");k.find("select").trigger("change");j.find("select").trigger("change")});n.find("select").change(function(){G("pcode",$(this).val())});l.find("select").change(function(){G("code",$(this).val())});k.find("select").change(function(){G("saveCode",$(this).val())});j.find("select").change(function(){G("label",$(this).val())});var g=$("#right-property-arg-cell").find("tr:eq(1)");var e=$("#right-property-arg-cell").find("tr:eq(2)");g.find("input").change(function(){var o=parseInt($(this).val());if(!isNaN(o)){anyExcel.getGrid().setGridCellHeight(o)}});e.find("input").change(function(){var o=parseInt($(this).val());if(!isNaN(o)){anyExcel.getGrid().setGridCellWidth(o)}});$("#component-seq-create-type").find("input[type=radio]").iCheck({radioClass:"iradio_minimal",});$("#component-seq-create-type").find("input[type=radio]").on("ifChanged",function(q){var p=anyExcel.getFormComponent();var o=p.formSequence!=undefined?p.formSequence:{};o.createType=$("#component-seq-create-type").find("input[type=radio]:checked").val();p.formSequence=o});var N=$("#right-property-arg-seq");var O=$("#component-seq").find("ul.top-menu");O.find("li").click(function(){var q=$(this).attr("atype");if(q=="0"){var p=N.find("tr:eq(0)");var t=p.clone().show();N.append(t);t.find("input").change(function(){anyExcel.setFormSequence(anyExcel.getFormComponent())});t.find("td:eq(1)").find("a").click(function(){$(this).parent().parent().remove();anyExcel.setFormSequence(anyExcel.getFormComponent())})}else{if(q=="1"){var o=N.find("tr:eq(1)");var s=o.clone().show();N.append(s);s.find("select").addClass("selectpicker").selectpicker("refresh");s.find("select").change(function(){anyExcel.setFormSequence(anyExcel.getFormComponent())});s.find("td:eq(1)").find("a").click(function(){$(this).parent().parent().remove();anyExcel.setFormSequence(anyExcel.getFormComponent())})}else{if(q=="2"){var u=N.find("tr:eq(2)");var r=u.clone().show();N.append(r);r.find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});r.find("select").addClass("selectpicker").selectpicker("refresh");r.find("input[type=checkbox]").on("ifChanged",function(v){anyExcel.setFormSequence(anyExcel.getFormComponent())});r.find("input").change(function(){anyExcel.setFormSequence(anyExcel.getFormComponent())});r.find("select").change(function(){anyExcel.setFormSequence(anyExcel.getFormComponent())});r.find("td:eq(1)").find("a").click(function(){$(this).parent().parent().remove();anyExcel.setFormSequence(anyExcel.getFormComponent())})}}}anyExcel.setFormSequence(anyExcel.getFormComponent())});var Y=$("#right-property-arg-style");var m=Y.find("tr:eq(0)");m.find("input").change(function(){var p=anyExcel.getFormComponent();if(p==null){return false}var o=p.cmpStyle!=undefined?p.cmpStyle:{};o.border=$(this).val();p.cmpStyle=o});var F=Y.find("tr:eq(3)");F.find("input.color-select").change(function(){var p=anyExcel.getFormComponent();if(p==null){return false}var o=p.cmpStyle!=undefined?p.cmpStyle:{};if($(this).spectrum("get")!=null){o.background=$(this).spectrum("get").toHex(false)}else{o.background=undefined}p.cmpStyle=o});var E=Y.find("tr:eq(4)");E.find("input.color-select").change(function(){var p=anyExcel.getFormComponent();if(p==null){return false}var o=p.cmpStyle!=undefined?p.cmpStyle:{};if($(this).spectrum("get")!=null){o.borderColor=$(this).spectrum("get").toHex(false)}else{o.borderColor=undefined}p.cmpStyle=o});var D=Y.find("tr:eq(5)");D.find("input.color-select").change(function(){var p=anyExcel.getFormComponent();if(p==null){return false}var o=p.cmpStyle!=undefined?p.cmpStyle:{};if($(this).spectrum("get")!=null){o.iconColor=$(this).spectrum("get").toHex(false)}else{o.iconColor=undefined}p.cmpStyle=o})});$(function(){$("li.tl-view-rptxml").click(function(){layer.open({type:1,title:"数据格式",zIndex:1025,shadeClose:true,area:["680px","460px"],content:$("#win-rptxml"),btn:["确定","取消"],yes:function(A){},success:function(){var B=new FormXml();var A=B.stringify(jform);$("#win-rptxml").find("pre").html(B.htmlEncode(A))}})})});$(function(){$("a.tl-fx").bind("click",function(G){var F=grid.selectedGridCell;if(F!=null){var H=F.getText();$(this).data("fx",H)}fxHandler($(this))});$("a.tl-fx-input").bind("click",function(G){var F=$(this).prev();if(F.val()!=null){$(this).data("fx",F.val())}fxHandler($(this))});var D=function(F,G){F.find("select:eq(0)").change(function(){var K=F.children("span");$(K[1]).hide();$(K[2]).hide();var L=$(this).val();F.find("a.only-a").show().unbind("click");if(L==0){$(K[1]).show();F.find("i").removeClass("icon-down").addClass("icon-collect");F.find("a.only-a").bind("click",columnSelectHandler)}else{if(L==1){$(K[1]).show();F.find("i").removeClass("icon-collect").addClass("icon-down");F.find("a.only-a").bind("click",cellSelectHandler)}else{if(L==3){$(K[2]).show();var J=F.find("select:eq(1)");var M=grid.getArgNames();for(var I=0;I<M.length;I++){var H=$("<option></option>");H.attr("value",M[I]).html(M[I]).appendTo(J)}J.selectpicker("refresh")}else{$(K[1]).show();F.find("a.only-a").hide()}}}F.find("input").val("").trigger("change")});F.find("select").trigger("change")};var A="";var E=function(){var F=A+"(";$("#win-fx-forumula-table").find("tr:gt(0)").each(function(){var H=$(this).find("select:eq(0)").val();var G=$(this).find("input").val();if(H==3){G=$(this).find("select:eq(1)").val()}F+=G+","});F=F.substring(0,F.length-1);F+=")";$("#win-fx-forumula-demo").show().val(F)};var C=function(){$("#win-fx-forumula-icon").hide();$("#win-fx-forumula-table").find("tr:gt(0)").remove();$("#win-fx-forumula-table").hide();$("#win-fx-forumula-word").hide();$("#win-fx-forumula-demo").hide();$("#win-fx-forumula-desc").hide();$("#win-fx-forumula-word-div").hide()};$("#win-fx-type").find("li").click(function(){$("#win-fx-general").hide();$("#win-fx-percent").hide();$("#win-fx-logical").hide();$("#win-fx-text").hide();$("#win-fx-datetime").hide();$("#win-fx-math").hide();$("#win-fx-datetime-cal").hide();$("#win-fx-type").find("li").removeClass("tl-hover");$(this).addClass("tl-hover");var F=$(this).attr("type");if(F==0){$("#win-fx-general").show()}else{if(F==1){$("#win-fx-percent").show()}else{if(F==2){$("#win-fx-logical").show()}else{if(F==3){$("#win-fx-text").show()}else{if(F==4){$("#win-fx-datetime").show()}else{if(F==5){$("#win-fx-math").show()}else{if(F==6){$("#win-fx-datetime-cal").show()}}}}}}}C();$("#win-fx-forumula").find("li").removeClass("tl-hover")});var B=function(H,M,G){var L=$("#win-fx-forumula-table").find("tr:eq(0)");for(var K=0;K<G;K++){var F=L.clone();var I=F.find("span.argName");I.html(H?M:M[K]);F.find("select").addClass("selectpicker").selectpicker("refresh");F.show();var J=F.find("td:eq(1)");D(J,"");J.find("input").change(function(){E()});J.find("select:eq(1)").change(function(){E()});$("#win-fx-forumula-table").append(F)}};$("#win-fx-forumula").find("li").click(function(){$("#win-fx-forumula").find("li").removeClass("tl-hover");$(this).addClass("tl-hover");A=$(this).text();var I=functions[A];var F=I[0];C();if(F==-1){$("#win-fx-forumula-icon").show();F=1}if(F!=0){$("#win-fx-forumula-table").show()}if(F>0){var H=I[1];var G=typeof (H)=="string";B(G,H,F)}$("#win-fx-forumula-word-div").show();$("#win-fx-forumula-word").show().html(I[2]);$("#win-fx-forumula-demo").show().val(A+"()");$("#win-fx-forumula-desc").show().html(I[3])});$("#win-fx-forumula-icon").find("li:eq(0)").click(function(){B(true,"参数",1)});$("#win-fx-forumula-icon").find("li:eq(1)").click(function(){if($("#win-fx-forumula-table").find("tr").length>2){$("#win-fx-forumula-table").find("tr:last").remove();E()}})});$(function(){var E=new FormXml();var B={data:{simpleData:{enable:true}}};var D=null;var C=function(){$.ajax({type:"POST",url:PATH+"/formMgr/"+TYPE+"/find_all_folder.htm",dataType:"json",success:function(H){D=$.fn.zTree.init($("#win-report-folder-tree"),B,H)}})};var A=function(){if(D==null){return 0}var H=D.getSelectedNodes();if(H.length>0){return H[0].id}return 0};var G=false;$("li.tl-report-save").click(function(){if(!anyExcel.formComponentValidator()){return false}layer.open({type:1,title:"保存表单",zIndex:1025,shadeClose:true,area:["600px","420px"],content:$("#win-jform-save"),btn:["确定","取消"],yes:function(I){if(G){document.location.href=PATH+"/formMgr/"+TYPE+"/add_form.htm";return false}if(!Validate.validation($("#win-jform-save"))){return false}var H=$("#win-jform-save").find("tr:eq(0)");jform.name=H.find("input").val();var J=E.stringify(jform);$.ajax({type:"POST",url:PATH+"/formMgr/"+TYPE+"/save_form_tplt.htm",data:{folderId:A(),rptxml:J,formId:jform.formId},dataType:"json",success:function(K){if(K.code!=0){alertError("表单保存出现错误",K.errorMsg)}else{G=true;$("#win-jform-save").children("table").hide();$("#win-jform-save").children("div").show();var L="表单["+jform.name+"] 保存成功";$("#win-report-save-success").empty().html(L)}}})},success:function(){G=false;$("#win-jform-save").children("div").hide();$("#win-jform-save").children("table").show();var I=$("#win-jform-save").find("tr:eq(0)");if(jform.name!=undefined){I.find("input").val(jform.name)}if(jform.formId==undefined||jform.formId==""){C()}else{var H=$("#win-jform-save").find("tr:eq(1)");H.hide()}}})});var F=$("#win-jform-save").children("div").find("ul");F.find("li:eq(0)").click(function(){document.location.href=PATH+"/formMgr/"+TYPE+"/add_form.htm"});F.find("li:eq(1)").click(function(){document.location.href=PATH+"/formMgr/"+TYPE+"/index.htm"})});$(function(){var A=$("#win-input-hidden").children("div");var B=$("#win-input-hidden").children("table");A.find("li").click(function(){D()});var D=function(K){var K=K?K:{};var H=B.find("tr:eq(1)").clone().show();H.find("select").addClass("selectpicker").selectpicker("refresh");var O=H.find("td:eq(0)");if(K.name!=undefined){O.find("input").val(K.name)}var I=H.find("td:eq(1)");var N=I.find("select:eq(0)");N.change(function(){var P=parseInt($(this).val());if(P==5){$(I.children("span")[1]).show()}else{$(I.children("span")[1]).hide()}});if(K.dataType!=undefined){N.selectpicker("val",K.dataType);N.trigger("change")}var M=I.find("select:eq(1)");if(K.dateFormat!=undefined){M.selectpicker("val",K.dateFormat)}var G=H.find("td:eq(2)");var L=$(G.children("span")[0]);var J=$(G.children("span")[1]);L.find("select").change(function(){var P=$(this).val();if(P=="0"){J.children("input").show();J.children("a").hide();J.children("span").hide()}else{if(P=="1"){J.children("input").show();J.children("a").show();J.children("span").hide()}else{J.children("input").hide();J.children("a").hide();J.children("span").show()}}});J.children("a").bind("click",fxInputSelectHandler);if(K.defaultValueType!=undefined){L.find("select").selectpicker("val",K.defaultValueType)}L.find("select").trigger("change");if(K.defaultValue!=undefined){J.children("input").val(K.defaultValue)}var F=H.find("td:eq(3)");F.find("a").click(function(){$(this).parent().parent().remove()});B.append(H)};var E=function(){var F=new Array();B.find("tr:gt(1)").each(function(){var J={};var N=$(this).find("td:eq(0)");J.name=N.find("input").val();var H=$(this).find("td:eq(1)");var M=H.find("select:eq(0)");J.dataType=parseInt(M.val());if(J.dataType==5){var L=H.find("select:eq(1)");J.dateFormat=L.val()}var G=$(this).find("td:eq(2)");var K=$(G.children("span")[0]);var I=$(G.children("span")[1]);var O=parseInt(K.find("select").val());J.defaultValueType=O;if(O==0||O==1){J.defaultValue=I.children("input").val()}else{J.defaultValue=I.find("select").val()}F.push(J)});jform.hiddens=F};var C=function(){B.find("tr:gt(1)").remove()};$("#tl-input-hidden").click(function(){layer.open({type:1,title:"隐藏域设置",zIndex:1025,shadeClose:true,area:["720px","420px"],content:$("#win-input-hidden"),btn:["确定","取消"],yes:function(F){E();layer.close(F)},success:function(){C();var G=jform.hiddens?jform.hiddens:{};if(!$.isEmptyObject(G)){for(var F=0;F<G.length;F++){var H=G[F];D(H)}}}})})});$(function(){$("li.tl-component-event").click(function(){layer.open({type:1,title:"组件事件",zIndex:1025,shadeClose:true,area:["500px","340px"],content:$("#win-component-event"),btn:["确定","取消"],yes:function(B){var D={};var C=$("#component-event-change").find("textarea").val();if(C!=""){D.change=C}var A=$("#component-event-click").find("textarea").val();if(A!=""){D.click=A}var E=anyExcel.getFormComponent();if(E!=null){E.event=D}layer.close(B)},success:function(){var D=anyExcel.getFormComponent();D=D?D:{};var C=D.event?D.event:{};var B=C.change?C.change:"";var A=C.click?C.click:"";$("#component-event-change").find("textarea").val(B);$("#component-event-click").find("textarea").val(A)}})})});$(function(){$("#win-component-validator").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal",});var B=function(){var F=anyExcel.getFormComponent();if(F==null){return }var H={};var I=$("#win-component-validator").find("table");var U=I.find("tr:eq(0)");H.isNull=U.find("input[type=checkbox]").is(":checked")?1:0;H.nullMsg=U.find("td:eq(3)").find("input").val();var T=I.find("tr:eq(1)");var G=T.find("td:eq(1)").find("input").val();if(G!=""){H.maxLength=G;var E=T.find("td:eq(3)").find("input").val();H.maxLengthMsg=E}var R=I.find("tr:eq(2)");var S=R.find("td:eq(1)").find("input").val();if(S!=""){H.minLength=S;var J=R.find("td:eq(3)").find("input").val();H.minLengthMsg=J}var Q=I.find("tr:eq(3)");var N=Q.find("td:eq(1)").find("input").val();if(N!=""){H.maxValue=N;var C=Q.find("td:eq(3)").find("input").val();H.maxValueMsg=C}var P=I.find("tr:eq(4)");var K=P.find("td:eq(1)").find("input").val();if(K!=""){H.minValue=K;var D=P.find("td:eq(3)").find("input").val();H.minValueMsg=D}var O=I.find("tr:eq(5)");var M=O.find("td:eq(1)").find("select").val();if(M!=""){H.specialReg=M;var L=O.find("td:eq(3)").find("input").val();H.specialRegMsg=L}F.validator=H};var A=function(){var G=anyExcel.getFormComponent();if(G==null){return }var I=G.validator?G.validator:{};var E=(I.isNull!=undefined&&I.isNull==1)?"check":"uncheck";var J=$("#win-component-validator").find("table");var W=J.find("tr:eq(0)");W.find("input[type=checkbox]").iCheck(E);var L=I.nullMsg!=undefined?I.nullMsg:"";W.find("td:eq(3)").find("input").val(L);var V=J.find("tr:eq(1)");var H=I.maxLength!=undefined?I.maxLength:"";V.find("td:eq(1)").find("input").val(H);var F=I.maxLengthMsg!=undefined?I.maxLengthMsg:"";V.find("td:eq(3)").find("input").val(F);var T=J.find("tr:eq(2)");var U=I.minLength!=undefined?I.minLength:"";T.find("td:eq(1)").find("input").val(U);var K=I.minLengthMsg!=undefined?I.minLengthMsg:"";T.find("td:eq(3)").find("input").val(K);var S=J.find("tr:eq(3)");var Q=I.maxValue!=undefined?I.maxValue:"";S.find("td:eq(1)").find("input").val(Q);var D=I.maxValueMsg!=undefined?I.maxValueMsg:"";S.find("td:eq(3)").find("input").val(D);var R=J.find("tr:eq(4)");var M=I.minValue!=undefined?I.minValue:"";R.find("td:eq(1)").find("input").val(M);var C=I.minValueMsg!=undefined?I.minValueMsg:"";R.find("td:eq(3)").find("input").val(C);var P=J.find("tr:eq(5)");var O=I.specialReg!=undefined?I.specialReg:"";P.find("td:eq(1)").find("select").selectpicker("val",O);var N=I.specialRegMsg!=undefined?I.specialRegMsg:"";P.find("td:eq(3)").find("input").val(N)};$("li.tl-component-validator").click(function(){layer.open({type:1,title:"数据验证",zIndex:1025,shadeClose:true,area:["700px","350px"],content:$("#win-component-validator"),btn:["确定","取消"],yes:function(C){B();layer.close(C)},success:function(){A()}})})});$(function(){var tr=$("#win-component-table-source").find("tr:eq(0)");var td4=tr.find("td:eq(4)");var searchPkColumn=function(table){var columns=table.columns;for(var i=0;i<columns.length;i++){var column=columns[i];if(column.isPk==1){return column}}return null};var getTableColumn=function(table,columnName){var columns=table.columns;for(var i=0;i<columns.length;i++){var column=columns[i];if(column.columnName==columnName){return column}}return null};var getTable=function(tables,name){for(var i=0;i<tables.length;i++){var table=tables[i];if(table.name==name){return table}}return null};td4.find("a:eq(0)").click(function(){var table={};table.name="tableName";addTab(table,true)});td4.find("a:eq(1)").click(function(){layer.confirm("您确定要生成数据表吗?",{icon:3,title:"提示信息"},function(index){layer.close(index);var _compTable=$("#win-component-table-source");var source=_compTable.find("select").val();if(source==""){layer.alert("请选择数据库!");return false}var tables=getTables();if(!tables){return false}var database={};database.tables=tables;var schemaName=_compTable.find("input").val();database.schemaName=schemaName;database.sourceName=source;var rptXmlGen=new FormXml();var rptXml=rptXmlGen.stringMappingXml(database);$.ajax({type:"POST",url:PATH+"/formMgr/create_table.htm",data:{rptxml:rptXml},dataType:"json",success:function(json){if(json.code=="0"){layer.alert("表单关联的数据表生成成功")}else{if(json.code=="101"){layer.alert("数据库已存在数据表并且表中已存在数据, 不能覆盖!")}else{if(json.code=="102"){layer.alert("数据源不存在!")}else{if(json.code=="103"){layer.alert("表名称不能为空!")}else{alertError("表单关联的数据表生成出现错误!",json.errorMsg)}}}}},error:function(e){layer.alert("数据表创建失败")}})})});var getTables=function(){var tables=new Array();var tableDivs=$("#component-table").next("div").children("div");for(var i=0;i<tableDivs.length;i++){var table={};var tableDiv=$(tableDivs[i]);var tableChildren=tableDiv.children();var div0=$(tableChildren[0]);var tableName=div0.find("input").val();table.name=tableName;var div2=$(tableChildren[2]);var columns=getTableColumns(div2.find("table:eq(0)"));var foreignKeys=getForeignKeys(div2.find("table:eq(1)"));table.columns=columns;table.fks=foreignKeys;tables.push(table);if(table.name==""){layer.alert("表名称不能为空!");return false}var pkColumn=searchPkColumn(table);if(pkColumn==null||(pkColumn.dataType!=2&&pkColumn.dataType!=3)){layer.alert(table.name+" 表必须添加一个整型主键");return false}for(var j=0;j<columns.length;j++){var column=columns[j];if(column.columnName==""){layer.alert("列名称不能为空!");return false}if(column.formName==""){layer.alert("表单名称不能为空!");return false}}}if(tables.length==0){layer.alert("没有表单关联的数据表!");return false}for(var i=0;i<tables.length;i++){var fks=tables[i].fks;for(var j=0;j<fks.length;j++){var fk=fks[j];if(fk.column==undefined||fk.column==""){layer.alert("外键列不能为空");return false}if(fk.refColumn==undefined||fk.refColumn==""){layer.alert("引用列不能为空");return false}var fkcolumn=getTableColumn(tables[i],fk.column);var refTable=getTable(tables,fk.refTable);if(refTable==null){layer.alert("引用表不存在");return false}var refColumn=getTableColumn(refTable,fk.refColumn);if(fkcolumn.dataType!=refColumn.dataType){layer.alert("外键列与引用列数据类型不一致");return false}}}return tables};var addTab=function(table,closeAble){var tableName=table.name!=undefined?table.name:"";var tabId=Utils.uuid();$("#component-table").find("li").removeClass("active");var litab='<li class="active"><a href="#'+tabId+'"data-toggle="tab" aria-expanded="true" style="position: relative;padding:2px 20px 12px 15px">';if(closeAble){litab=litab+'<i class="icon iconfont icon-delete red" aria-expanded="true" style="position: absolute;right:1px;top: -2px;cursor:pointer;"></i>&nbsp;<span>'+tableName+"</span>&nbsp;&nbsp;</a></li>"}else{litab=litab+"</a></li>"}$("#component-table").append(litab);$("#component-table").next("div").children("div").removeClass("active in");var tabContent='<div class="tab-pane fade active in" id="'+tabId+'"><div style="padding:5px;"><table><tr><td width="80">表名称</td><td width="200"><input type="text" style="width:180px;" tabId="'+tabId+'" value="'+tableName+'"></td><td width="150"><a href="javascript:void(0)" class="only-a"><i class="icon iconfont icon-collect fa-lg"  style="font-size:14px"></i></a></td></tr></table></div>';tabContent+='<ul class="nav nav-tabs comp-tab"><li class="active"><a href="#table-column-'+tabId+'" data-toggle="tab" aria-expanded="true">数据列</a></li><li><a href="#table-fk-'+tabId+'" data-toggle="tab" aria-expanded="false">外键</a></li></ul></div>';$("#component-table").next("div").append(tabContent);var cloneContent=$("#column-tab-content").clone().show().removeAttr("id");var contentDivs=cloneContent.children("div");$(contentDivs[0]).attr("id","table-column-"+tabId);$(contentDivs[1]).attr("id","table-fk-"+tabId);$("#"+tabId).append(cloneContent);var _div=$("#"+tabId).children("div");_div.find("input").change(function(){var tabId=$(this).attr("tabId");var tableName=$(this).val();var _a=$("a[href=#"+tabId+"]");_a.find("span").empty().append(tableName)});$(_div[0]).find("a").click(function(){var tableDiv=$(this).parent().parent();var source=$("#win-component-table-source").find("select").val();var _select=$("#win-table-selected").find("select");$.ajax({type:"POST",url:PATH+"/formMgr/query_db_names.htm",data:{sourceName:source},dataType:"json",success:function(jsons){layer.open({type:1,title:"选择数据库表",zIndex:1025,shadeClose:true,shade:false,area:["400px","300px"],content:$("#win-table-selected"),btn:["确定","取消"],yes:function(index){var tableName=_select.val();tableDiv.find("input").val(tableName).trigger("change");layer.close(index)},success:function(){_select.empty();for(var i=0;i<jsons.length;i++){$("<option></option>").attr("value",jsons[i].id).html(jsons[i].name).appendTo(_select)}_select.selectpicker("refresh")}})},error:function(e){layer.alert("数据库表查询错误")}})});var _a=$("a[href=#"+tabId+"]");_a.find("i").click(function(){var a=$(this).parent();var atabId=a.attr("href").substr(1);layer.confirm("您确定要删除该数据表吗?",{icon:3,title:"提示"},function(index){a.parent().remove();$("#"+atabId).remove();layer.close(index)})});var topUl=cloneContent.find("ul.top-menu:eq(0)");topUl.find("li:eq(0)").click(function(){var content=$(this).parent().parent().parent().parent();var tabId=content.parent().attr("id");layer.open({type:1,title:"字段列表",zIndex:1025,shadeClose:true,shade:false,area:["600px","500px"],content:$("#win-table-column-select"),btn:["确定","取消"],yes:function(index){var selectFormNames=new Array();var _table=$("#win-table-column-select").find("table");_table.find("tr:gt(0)").each(function(){var td0=$(this).find("td:eq(0)");var checked=td0.find("input").is(":checked");if(checked){var td1=$(this).find("td:eq(1)");selectFormNames.push(td1.text())}});for(var i=0;i<selectFormNames.length;i++){var formName=selectFormNames[i];var formComponent=grid.getFormComponentByName(formName);if(formComponent!=null){var column={};column.isPk=0;column.formName=formComponent.name;column.columnName="FD_"+formComponent.name.toUpperCase();if(formComponent.dataType==undefined){column.length=225}else{if(formComponent.dataType==2){column.length=11}else{if(formComponent.dataType==1){column.length=225}}}column.dataType=formComponent.dataType;addColumn(column,content.find("table:eq(0)"),tabId)}else{var hidden=grid.getFormHiddenByName(formName);if(hidden!=null){var column={};column.isPk=0;column.formName=hidden.name;column.columnName="FD_"+hidden.name.toUpperCase();if(hidden.dataType==undefined){column.length=225}else{if(hidden.dataType==2){column.length=11}else{if(hidden.dataType==1){column.length=225}}}column.dataType=hidden.dataType;addColumn(column,content.find("table:eq(0)"),tabId)}}}layer.close(index)},success:function(){var _table=$("#win-table-column-select").find("table");_table.find("tr:gt(1)").remove();var cells=grid.getComponentCells();for(var i=0;i<cells.length;i++){var cell=cells[i];var formComponent=cell.getFormComponent();if(formComponent==null){continue}var name=formComponent.name!=undefined?formComponent.name:"";if(name==""){continue}var cloneTr=_table.find("tr:eq(1)").clone().show();_table.append(cloneTr);cloneTr.find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal",});var td1=cloneTr.find("td:eq(1)");td1.html(name);var td2=cloneTr.find("td:eq(2)");td2.html("FD_"+name.toUpperCase());var desc=formComponent.desc!=undefined?formComponent.desc:"";var td3=cloneTr.find("td:eq(3)");td3.html(desc)}var hiddens=jform.hiddens;if(hiddens!=undefined){for(var i=0;i<hiddens.length;i++){var hidden=hiddens[i];if(hidden.name==undefined||hidden.name==""){continue}var cloneTr=_table.find("tr:eq(1)").clone().show();_table.append(cloneTr);cloneTr.find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal",});var td1=cloneTr.find("td:eq(1)");td1.html(hidden.name);var td2=cloneTr.find("td:eq(2)");td2.html("FD_"+hidden.name.toUpperCase());var td3=cloneTr.find("td:eq(3)");td3.html("")}}}})});topUl.find("li:eq(1)").click(function(){var content=$(this).parent().parent().parent().parent();var column={};column.isPk=0;var tabId=content.parent().attr("id");addColumn(column,content.find("table:eq(0)"),tabId)});var columnUl=cloneContent.find("ul.top-menu:eq(1)");columnUl.find("li:eq(0)").click(function(){var content=$(this).parent().parent().parent().parent();var _table=content.find("table:eq(1)");addForeignKey({},_table,content.find("table:eq(0)"))});columnUl.find("li:eq(1)").click(function(){var content=$(this).parent().parent().parent().parent();var _table=content.find("table:eq(1)");if(_table.find("tr").length>2){_table.find("tr:last").remove()}});var columns=table.columns;if(columns!=undefined&&columns.length>0){for(var i=0;i<columns.length;i++){var column=columns[i];addColumn(column,cloneContent.find("table:eq(0)"),tabId)}}else{var column={};column.isPk=1;column.formName="ID";column.columnName="ID";column.length=11;column.dataType=2;addColumn(column,cloneContent.find("table:eq(0)"),tabId);var userIdColumn={};userIdColumn.isPk=0;userIdColumn.formName="_userId";userIdColumn.columnName="FP_USERID_";userIdColumn.length=11;userIdColumn.dataType=2;addColumn(userIdColumn,cloneContent.find("table:eq(0)"),tabId);var statusColumn={};statusColumn.isPk=0;statusColumn.formName="_fpStatus";statusColumn.columnName="FP_STAUTS_";statusColumn.length=11;statusColumn.dataType=2;addColumn(statusColumn,cloneContent.find("table:eq(0)"),tabId)}var fks=table.fks;if(fks!=undefined&&fks.length>0){for(var i=0;i<fks.length;i++){addForeignKey(fks[i],cloneContent.find("table:eq(1)"),cloneContent.find("table:eq(0)"))}}};var addColumn=function(column,_table,radioId){var cloneTr=_table.find("tr:eq(1)").clone().show();_table.append(cloneTr);cloneTr.find("input[type=radio]").attr("name",radioId).iCheck({radioClass:"iradio_minimal"});cloneTr.find("select").addClass("selectpicker").selectpicker("refresh");var td0=cloneTr.find("td:eq(0)");var checkStr=(column.isPk!=undefined&&column.isPk==1)?"check":"uncheck";td0.find("input").iCheck(checkStr);var td1=cloneTr.find("td:eq(1)");var formName=column.formName!=undefined?column.formName:"";td1.find("input").val(formName);var td2=cloneTr.find("td:eq(2)");var columnName=column.columnName!=undefined?column.columnName:"";td2.find("input").val(columnName);td2.find("a").data("_obj",_table);td2.find("a").click(function(){var columnInput=$(this).prev();var source=$("#win-component-table-source").find("select").val();var schemaName=$("#win-component-table-source").find("input").val();var obj=$(this).data("_obj");var tableDiv=obj.parent().parent().parent();var tableName=$(tableDiv.children("div")[0]).find("input").val();$.ajax({type:"POST",url:PATH+"/formMgr/query_table_columns.htm",data:{sourceName:source,tableName:tableName},dataType:"json",success:function(text){var json=eval("("+text+")");if(json.retCode==304){layer.alert("数据库列查询错误:"+json.msg)}else{var _columnSelect=$("#win-table-columns-selected").find("select");var columns=json.columns;layer.open({type:1,title:"选择列",zIndex:1025,shadeClose:true,shade:false,area:["400px","300px"],content:$("#win-table-columns-selected"),btn:["确定","取消"],yes:function(index){columnInput.val(_columnSelect.val());layer.close(index)},success:function(){_columnSelect.empty();for(var i=0;i<columns.length;i++){$("<option></option>").attr("value",columns[i]).html(columns[i]).appendTo(_columnSelect)}_columnSelect.selectpicker("refresh")}})}},error:function(e){layer.alert("数据库列查询错误")}})});var td3=cloneTr.find("td:eq(3)");var length=column.length!=undefined?column.length:"";td3.find("input").val(length);var td4=cloneTr.find("td:eq(4)");var dataType=column.dataType!=undefined?column.dataType:1;td4.find("select").selectpicker("val",dataType);var td5=cloneTr.find("td:eq(5)");td5.find("input").iCheck({checkboxClass:"icheckbox_minimal"});var optAddCheck=column.optAdd==1?"uncheck":"check";var optEditCheck=column.optEdit==1?"uncheck":"check";td5.find("input:eq(0)").iCheck(optAddCheck);td5.find("input:eq(1)").iCheck(optEditCheck);var td6=cloneTr.find("td:eq(6)");td6.find("a").click(function(){$(this).parent().parent().remove()})};var addForeignKey=function(fk,_table,pkTable){var cloneTr=_table.find("tr:eq(1)").clone().show();_table.append(cloneTr);var tr1=_table.find("tr:eq(1)");var divs=$("#component-table").next("div").children("div");var tables=new Array();for(var i=0;i<divs.length;i++){var _div=$(divs[i]);var _table=_div.find("table:eq(0)");var tableName=_table.find("input").val();tables.push(tableName)}var cols=new Array();var _coltable=pkTable;_coltable.find("tr:gt(1)").each(function(){var td0=$(this).find("td:eq(1)");if(!td0.find("input").is(":checked")){var td2=$(this).find("td:eq(2)");cols.push(td2.find("input").val())}});var td0=cloneTr.find("td:eq(0)");var _select0=td0.find("select");_select0.empty();for(var i=0;i<cols.length;i++){$("<option></option>").attr("value",cols[i]).html(cols[i]).appendTo(_select0)}if(fk.column!=undefined){_select0.selectpicker("val",fk.column)}var td1=cloneTr.find("td:eq(1)");var _select=td1.find("select");_select.empty();$("<option value=''></option>").appendTo(_select);for(var i=0;i<tables.length;i++){$("<option></option>").attr("value",tables[i]).html(tables[i]).appendTo(_select)}cloneTr.find("select").addClass("selectpicker").selectpicker("refresh");if(fk.refTable!=undefined){_select.selectpicker("val",fk.refTable)}var td2=cloneTr.find("td:eq(2)");var _refSelect=td2.find("select");_select.change(function(){var refTableName=$(this).val();_refSelect.empty();var tableDivs=$("#component-table").next("div").children("div");for(var i=0;i<tableDivs.length;i++){var tableDiv=$(tableDivs[i]);var tableChildren=tableDiv.children();var div0=$(tableChildren[0]);var tableName=div0.find("input").val();if(tableName==refTableName){var div2=$(tableChildren[2]);var columns=getTableColumns(div2.find("table:eq(0)"));for(var i=0;i<columns.length;i++){$("<option></option>").attr("value",columns[i].columnName).html(columns[i].columnName).appendTo(_refSelect)}}}_refSelect.selectpicker("refresh");if(fk.refColumn!=undefined){_refSelect.selectpicker("val",fk.refColumn)}});_select.trigger("change")};var submitUl=$("#tab-form-submit-validate").find("ul.top-menu:eq(0)");var _submitTable=$("#tab-form-submit-validate").find("table");submitUl.find("li:eq(0)").click(function(){var cloneTr=_submitTable.find("tr:eq(1)").clone().show();_submitTable.append(cloneTr);cloneTr.find("select").addClass("selectpicker").selectpicker("refresh");var td3=cloneTr.find("td:eq(3)");td3.find("a").click(function(){$(this).parent().parent().remove()})});var sqlleftUl=$("#tab-sql").find("ul.left-menu-ul:eq(0)");var _sqlTable=$("#tab-sql").find("table").find("table");sqlleftUl.find("li").click(function(){_sqlTable.hide();sqlleftUl.find("li").removeClass("tl-hover");$(this).addClass("tl-hover");var type=$(this).attr("type");if(type==0){$("#tab-sql").find("table.add").show()}else{if(type==1){$("#tab-sql").find("table.update").show()}else{if(type==2){$("#tab-sql").find("table.query").show()}else{if(type==3){$("#tab-sql").find("table.delete").show()}}}}});var sqlUl=$("#tab-sql").find("ul.top-menu:eq(0)");sqlUl.find("li:eq(0)").click(function(){var type=sqlleftUl.find("li.tl-hover").attr("type");var exeTable=null;if(type==0){exeTable=$("#tab-sql").find("table.add")}else{if(type==1){exeTable=$("#tab-sql").find("table.update")}else{if(type==2){exeTable=$("#tab-sql").find("table.query")}else{if(type==3){exeTable=$("#tab-sql").find("table.delete")}}}}if(exeTable==null){return false}var sqlCloneTr=exeTable.find("tr:eq(1)").clone().show();exeTable.append(sqlCloneTr);var _dsselect=sqlCloneTr.find("td:eq(1)").find("select");_dsselect.empty();var dss=anyExcel.getDss();for(var i=0;i<dss.length;i++){var opt=$("<option></option>");opt.attr("value",dss[i]).html(dss[i]).appendTo(_dsselect)}sqlCloneTr.find("select").addClass("selectpicker").selectpicker("refresh");var td2=sqlCloneTr.find("td:eq(2)");td2.find("a").click(function(){$(this).parent().parent().remove()})});var setFormAttr=function(){var database={};var tables=new Array();var tableDivs=$("#component-table").next("div").children("div");for(var i=0;i<tableDivs.length;i++){var table={};var tableDiv=$(tableDivs[i]);var tableChildren=tableDiv.children();var div0=$(tableChildren[0]);var tableName=div0.find("input").val();table.name=tableName;var div2=$(tableChildren[2]);var columns=getTableColumns(div2.find("table:eq(0)"));var foreignKeys=getForeignKeys(div2.find("table:eq(1)"));table.columns=columns;table.fks=foreignKeys;tables.push(table)}var _compTable=$("#win-component-table-source");database.tables=tables;var source=_compTable.find("select").val();database.sourceName=source;var schemaName=_compTable.find("input").val();database.schemaName=schemaName;jform.database=database;var validates=new Array();var validateTable=$("#tab-form-submit-validate").find("table");validateTable.find("tr:gt(1)").each(function(){var validate={};var td0=$(this).find("td:eq(0)");validate.exeType=td0.find("select").val();var td1=$(this).find("td:eq(1)");validate.exp=td1.find("input").val();var td2=$(this).find("td:eq(2)");validate.msg=td2.find("input").val();validates.push(validate)});if(validates.length>0){var attr=jform.attr!=undefined?jform.attr:{};attr.validates=validates;jform.attr=attr}var sqlCommands=new Array();$("#tab-sql").find("table.add").find("tr:gt(1)").each(function(){var sqlCommand={};sqlCommand.exeType=0;var td0=$(this).find("td:eq(0)");sqlCommand.exePoint=td0.find("select").val();var td1=$(this).find("td:eq(1)");sqlCommand.dsName=td1.find("select").val();sqlCommands.push(sqlCommand)});$("#tab-sql").find("table.update").find("tr:gt(1)").each(function(){var sqlCommand={};sqlCommand.exeType=1;var td0=$(this).find("td:eq(0)");sqlCommand.exePoint=td0.find("select").val();var td1=$(this).find("td:eq(1)");sqlCommand.dsName=td1.find("select").val();sqlCommands.push(sqlCommand)});$("#tab-sql").find("table.query").find("tr:gt(1)").each(function(){var sqlCommand={};sqlCommand.exeType=2;var td0=$(this).find("td:eq(0)");sqlCommand.exePoint=td0.find("select").val();var td1=$(this).find("td:eq(1)");sqlCommand.dsName=td1.find("select").val();sqlCommands.push(sqlCommand)});$("#tab-sql").find("table.delete").find("tr:gt(1)").each(function(){var sqlCommand={};sqlCommand.exeType=3;var td0=$(this).find("td:eq(0)");sqlCommand.exePoint=td0.find("select").val();var td1=$(this).find("td:eq(1)");sqlCommand.dsName=td1.find("select").val();sqlCommands.push(sqlCommand)});if(sqlCommands.length>0){var attr=jform.attr!=undefined?jform.attr:{};attr.sqlCommands=sqlCommands;jform.attr=attr}};var getTableColumns=function(_table){var columns=new Array();_table.find("tr:gt(1)").each(function(){var column={};var td0=$(this).find("td:eq(0)");column.isPk=td0.find("input").is(":checked")?1:0;var td1=$(this).find("td:eq(1)");column.formName=td1.find("input").val();var td2=$(this).find("td:eq(2)");column.columnName=td2.find("input").val();var td3=$(this).find("td:eq(3)");column.length=td3.find("input").val();var td4=$(this).find("td:eq(4)");column.dataType=td4.find("select").val();var td5=$(this).find("td:eq(5)");var add=td5.find("input:eq(0)").is(":checked");var mod=td5.find("input:eq(1)").is(":checked");column.optAdd=add?0:1;column.optEdit=mod?0:1;column.formNameDesc=getFormDesc(column.formName);columns.push(column)});return columns};var getFormDesc=function(formName){var trs=grid.tb.find("tr");for(var i=1;i<trs.length;i++){var tds=$(trs[i]).find("td");for(var j=1;j<tds.length;j++){var td=$(tds[j]);var gridCell=td.data("gc");if(gridCell.mark==2){var formComponent=gridCell.getFormComponent();if(formComponent==null){continue}if(formName!=formComponent.name){continue}return formComponent.desc}}}return""};var getForeignKeys=function(_table){var foreignKeys=new Array();_table.find("tr:gt(1)").each(function(){var foreignKey={};var td0=$(this).find("td:eq(0)");var column=td0.find("select").val();var td1=$(this).find("td:eq(1)");var refTable=td1.find("select").val();var td2=$(this).find("td:eq(2)");var refColumn=td2.find("select").val();if(column!=""&&refTable!=""&&refColumn!=""){foreignKey.column=column;foreignKey.refTable=refTable;foreignKey.refColumn=refColumn;foreignKeys.push(foreignKey)}});return foreignKeys};var initFormAttr=function(){var database=jform.database!=undefined?jform.database:{};var _compTable=$("#win-component-table-source");if(database.sourceName!=undefined){_compTable.find("select").selectpicker("val",database.sourceName)}var schemaName=database.schemaName!=undefined?database.schemaName:"";_compTable.find("input").val(schemaName);var tables=database.tables;$("#component-table").empty();$("#component-table").next("div").empty();if(tables!=undefined){for(var i=0;i<tables.length;i++){var table=tables[i];addTab(table,true)}}var validateTable=$("#tab-form-submit-validate").find("table");validateTable.find("tr:gt(1)").remove();var attr=jform.attr!=undefined?jform.attr:{};var validates=attr.validates;if(validates!=undefined){for(var i=0;i<validates.length;i++){var validate=validates[i];var cloneTr=validateTable.find("tr:eq(1)").clone().show();validateTable.append(cloneTr);cloneTr.find("select").addClass("selectpicker").selectpicker("refresh");var exeType=validate.exeType!=undefined?validate.exeType:0;var td0=cloneTr.find("td:eq(0)");td0.find("select").val(validate.exeType);var exp=validate.exp!=undefined?validate.exp:"";var td1=cloneTr.find("td:eq(1)");td1.find("input").val(exp);var msg=validate.msg!=undefined?validate.msg:"";var td2=cloneTr.find("td:eq(2)");td2.find("input").val(msg);var td3=cloneTr.find("td:eq(3)");td3.find("a").click(function(){$(this).parent().parent().remove()})}}$("#tab-sql").find("table.add").find("tr:gt(1)").remove();$("#tab-sql").find("table.update").find("tr:gt(1)").remove();$("#tab-sql").find("table.query").find("tr:gt(1)").remove();$("#tab-sql").find("table.delete").find("tr:gt(1)").remove();var sqlCommands=attr.sqlCommands;if(sqlCommands!=undefined){for(var i=0;i<sqlCommands.length;i++){var sqlCommand=sqlCommands[i];var exeType=sqlCommand.exeType;var exeTable=null;if(exeType==0){exeTable=$("#tab-sql").find("table.add")}else{if(exeType==1){exeTable=$("#tab-sql").find("table.update")}else{if(exeType==2){exeTable=$("#tab-sql").find("table.query")}else{if(exeType==3){exeTable=$("#tab-sql").find("table.delete")}}}}if(exeTable==null){continue}var sqlCloneTr=exeTable.find("tr:eq(1)").clone().show();exeTable.append(sqlCloneTr);var _dsselect=sqlCloneTr.find("td:eq(1)").find("select");_dsselect.empty();var dss=anyExcel.getDss();for(var j=0;j<dss.length;j++){var opt=$("<option></option>");opt.attr("value",dss[j]).html(dss[j]).appendTo(_dsselect)}sqlCloneTr.find("select").addClass("selectpicker").selectpicker("refresh");var exePoint=sqlCommand.exePoint!=undefined?sqlCommand.exePoint:0;sqlCloneTr.find("td:eq(0)").selectpicker("val",exePoint);if(sqlCommand.dsName!=undefined){sqlCloneTr.find("td:eq(1)").selectpicker("val",sqlCommand.dsName)}var td2=sqlCloneTr.find("td:eq(2)");td2.find("a").click(function(){$(this).parent().parent().remove()})}}};$("li.tl-component-table").click(function(){if(!anyExcel.formComponentValidator()){return false}layer.open({type:1,title:"表单属性",zIndex:1025,shadeClose:true,shade:false,area:["760px","500px"],content:$("#win-component-table"),btn:["确定","取消"],yes:function(index){if(!getTables()){return false}setFormAttr();layer.close(index)},success:function(){initFormAttr()}})})});$(function(){$("#win-import-excel").find("input[type=radio]").iCheck({radioClass:"iradio_minimal",});$("#win-import-excel").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal",});var C=$("#win-import-excel").find("table");var B=C.find("tr:eq(0)");B.find("input[type=checkbox]").on("ifChanged",function(F){var E=$(this).is(":checked");if(E){C.find("tr:gt(0)").show()}else{C.find("tr:gt(0)").hide()}});var D=function(){var H=jform.fileImport!=undefined?jform.fileImport:{};var F=C.find("tr:eq(0)");var I=(H.xlsEnabled!=undefined&&H.xlsEnabled)?"check":"uncheck";F.find("input[type=checkbox]").iCheck(I);var E=C.find("tr:eq(1)");var G=H.startRow!=undefined?H.startRow:"2";E.find("input").val(G);var K=C.find("tr:eq(2)");var J=H.mappingType!=undefined?H.mappingType:0;K.find("input").each(function(){if($(this).val()==J){$(this).iCheck("check")}})};var A=function(){var G={};G.type="xls";var F=C.find("tr:eq(0)");G.xlsEnabled=F.find("input[type=checkbox]").is(":checked");var E=C.find("tr:eq(1)");G.startRow=E.find("input").val();var H=C.find("tr:eq(2)");H.find("input").each(function(){if($(this).is(":checked")){G.mappingType=$(this).val()}});jform.fileImport=G};$("li.tl-component-import").click(function(){layer.open({type:1,title:"Excel导入设置",zIndex:1025,shadeClose:true,area:["500px","340px"],content:$("#win-import-excel"),btn:["确定","取消"],yes:function(E){A();layer.close(E)},success:function(){D()}})})});$(function(){$("#win-arg-attr").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal",});var A=function(D,E){return((1<<D)&E)!=0};var C=function(){var E=$("#win-arg-attr").children("table");var F=jform.relative!=undefined?jform.relative:(TYPE=="app"?2:0);var D=E.find("tr:eq(0)");D.find("input").each(function(H){var G=parseInt($(this).val());var I=A(G,F)?"check":"uncheck";$(this).iCheck(I)})};var B=function(){var E=$("#win-arg-attr").children("table");var D=E.find("tr:eq(0)");var F=0;D.find("input").each(function(){var G=parseInt($(this).val());if($(this).is(":checked")){F=F|(1<<G)}else{F=(~(1<<G))&F}});jform.relative=F};$("li.tl-form-style").click(function(){layer.open({type:1,title:"表单样式",zIndex:1025,shadeClose:true,shade:false,area:["610px","460px"],content:$("#win-arg-attr"),btn:["确定","取消"],yes:function(D){B();layer.close(D)},success:function(){C()}})})});var formRptIndex=0;function getRptXml(){var A=new FormXml();return A.stringRptXml(jform)}function getEidtRptXml(){return jform.reportXml}function setRptXml(A){jform.reportXml=A;layer.close(formRptIndex)}$(function(){var A=function(F){var E={};var C=new Array();var G=new Array();E.table=F;var D=$("#win-table-datalist").find("table");D.find("tr:gt(1)").each(function(){var O=$(this).find("td:eq(0)");var J=O.html();var M=$(this).find("td:eq(1)");var Q=M.find("input").val();var K=$(this).find("td:eq(2)");var N=K.find("input").is(":checked");var I=$(this).find("td:eq(3)");var H=I.find("input").is(":checked");var R=null;var L=F.columns;for(var P=0;P<L.length;P++){if(L[P].columnName==J){R=L[P]}}if(R!=null){R.columnDesc=Q;if(N){G.push(R)}if(H){C.push(R)}}});E.lists=C;E.conditions=G;jform.dataList=E};var B=function(J){var C=$("#win-table-datalist").find("table");C.find("tr:gt(1)").remove();var E=J.columns;for(var D=0;D<E.length;D++){var H=C.find("tr:eq(1)").clone().show();C.append(H);var G=E[D];var I=H.find("td:eq(0)");I.html(G.columnName);var F=H.find("td:eq(1)");F.find("input").val(G.formNameDesc);H.find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal",})}layer.open({type:1,title:"数据管理页面定义",zIndex:1025,shadeClose:true,area:["700px","450px"],content:$("#win-table-datalist"),btn:["确定","取消"],yes:function(L){layer.close(L);A(J);var M=$(window).width()-5;var K=$(window).height()-5;formRptIndex=layer.open({type:2,title:"数据管理列表",shade:false,shift:-1,area:[M+"px",K+"px"],shadeClose:true,maxmin:true,content:PATH+"/rptMgr/def/add_rpt.htm?rptType=form"})},success:function(){}})};$("li.tl-create-datalist").click(function(){var F=jform.database;if(F==undefined){return false}var D=F.tables;if(D==undefined||D.length==0){return false}for(var C=0;C<D.length;C++){var E=D[C];if(E.fks==undefined||E.fks.length==0){B(E);break}}});$("li.tl-edit-datalist").click(function(){var D=$(window).width()-5;var C=$(window).height()-5;formRptIndex=layer.open({type:2,title:"数据管理列表",shade:false,shift:-1,area:[D+"px",C+"px"],shadeClose:true,maxmin:true,content:PATH+"/rptMgr/def/add_rpt.htm?rptType=formEdit"})})});$(function(){$("li.tl-other-rptxml").click(function(){layer.open({type:2,title:"选择表单",zIndex:1025,shadeClose:true,area:["520px","400px"],content:PATH+"/anyrt/design/selectform.jsp",btn:["确定","取消"],yes:function(C,B){var F=window[B.find("iframe")[0]["name"]];var D=F.getSelectNode();if(D!=null){var E=D.id;$.ajax({type:"POST",url:PATH+"/formMgr/query_form_tplt.htm",data:{formId:E},dataType:"text",success:function(H){grid.clearAll();var G=new FormXml();G.parse(H)}})}layer.close(C)}})});$("li.tl-rptxml-export").click(function(){var C=new FormXml();var B=C.stringify(jform);var D=jform.formId?jform.formId:"";$("#exportRpt-form").find("input[name=formId]").val(D);$("#exportRpt-form").find("input[name=formxml]").val(B);$("#exportRpt-form").submit()});$("li.tl-rptxml-import").click(function(){layer.open({type:1,title:"导入模板文件",zIndex:1025,shadeClose:true,area:["400px","200px"],content:$("#win-import-file"),btn:["确定","取消"],yes:function(B){layer.close(B);A()},success:function(){if($("#win-import-file").find("input").length==0){$("#win-import-file").append("<input type='file' name='import-rptxml-file'>")}}})});var A=function(){$.ajaxFileUpload({url:PATH+"/formMgr/import_tplt.htm",secureuri:false,fileElementName:"import-rptxml-file",dataType:"text",success:function(E,D){if(E==undefined){return false}var I=0;var B=0;var K=0;for(var F=0;F<E.length;F++){if(E.charAt(F)=="{"){I=F}if(E.charAt(F)==":"){B=F;break}}for(var F=E.length-1;F>=0;F--){if(E.charAt(F)=="}"){K=F;break}}if(B!=0){var H=E.substring(I+1,B);var J=E.substring(B+1,K);if(H=="error"){layer.alert("文件最大不能超过"+J,{icon:2})}else{var G=Base64.decode(J);grid.clearAll();var C=new FormXml();C.parse(G)}}},error:function(C,B,D){layer.alert("文件上传失败, 请选择正确的文件上传!",{icon:2})}})}});$(function(){var G=CodeMirror.fromTextArea(document.getElementById("win-develop-js-source"),{mode:"text/javascript",smartIndent:true,lineNumbers:true,matchBrackets:true});var E=CodeMirror.fromTextArea(document.getElementById("win-develop-css-source"),{mode:"text/css",smartIndent:true,lineNumbers:true,matchBrackets:true});var D=$("#win-develop-js").children("ul");D.find("a").on("shown.bs.tab",function(J){if($(this).attr("href")=="#tab-dev-js"){G.refresh()}else{if($(this).attr("href")=="#tab-dev-css"){E.refresh()}}});var H=$("#win-develop-js").find("table.tb");var I=new UpFile(PATH+"/rptMgr/upload.htm","file-jslib-uploader",{},function(){},function(J,L){var K=H.find("tr:eq(1)").clone().show();H.append(K);K.find("td:eq(0)").html(J.name);K.find("td:eq(1)").html(L._raw);K.find("td:eq(2)").find("a").attr("jsPath",L._raw);K.find("td:eq(2)").find("a").click(function(){var M=$(this);var N=M.attr("jsPath");layer.confirm("您确定要删除该文件吗?",{icon:3,shift:-1,title:"提示"},function(O){layer.close(O);$.ajax({type:"POST",url:PATH+"/rptMgr/delete_file.htm",data:{filePath:N},dataType:"json",success:function(P){M.parent().parent().remove()},error:function(P){layer.alert("文件删除失败")}})})})});I.init();var B=function(){H.find("tr:gt(1)").remove();var P=$(".tab-report-arg").attr("aria-expanded");var R=jform.developer!=undefined?jform.developer:{};var S=R.jsCode!=undefined?R.jsCode:"";G.setValue(S);var O=R.cssCode!=undefined?R.cssCode:"";E.setValue(O);var J=R.files!=undefined?R.files:new Array();for(var M=0;M<J.length;M++){var K=J[M];var N=K.jslib!=undefined?K.jslib:"";var Q=K.jsPath!=undefined?K.jsPath:"";var L=H.find("tr:eq(1)").clone().show();H.append(L);L.find("td:eq(0)").html(N);L.find("td:eq(1)").html(Q);L.find("td:eq(2)").find("a").attr("jsPath",Q);L.find("td:eq(2)").find("a").click(function(){var T=$(this);var U=T.attr("jsPath");layer.confirm("您确定要删除该文件吗?",{icon:3,shift:-1,title:"提示"},function(V){layer.close(V);$.ajax({type:"POST",url:PATH+"/rptMgr/delete_file.htm",data:{filePath:U},dataType:"json",success:function(W){T.parent().parent().remove()},error:function(W){layer.alert("文件删除失败")}})})})}};var A=function(){var M=G.getValue();if(M!=""){var K={};K.jsCode=M;var J=E.getValue();if(J!=""){K.cssCode=J}var L=new Array();H.find("tr:gt(1)").each(function(){var N={};N.jslib=$(this).find("td:eq(0)").html();N.jsPath=$(this).find("td:eq(2)").find("a").attr("jsPath");L.push(N)});if(L.length>0){K.files=L}jform.developer=K}};var F=$(window).height();var C=$(window).width();$("li.tl-develop-js").click(function(){$("#win-develop-js").find(".CodeMirror").width(C-140).height(F-180);layer.open({type:1,title:"js程序",zIndex:1025,shadeClose:true,area:[(C-100)+"px",(F-50)+"px"],content:$("#win-develop-js"),btn:["确定","取消"],yes:function(J){A();layer.close(J)},success:function(){B();G.refresh();E.refresh()}})})});var PALETTE=[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)","#FAFAFA","#EEEEEE","#DDDDDD"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)","#777777","#555555","#333333","#A992E2","#00C9E6"],["#5BC0DE","#337AB7","#5F69E0","#FF4859","#A94442","#D9534F","#3C763D","#7EC857","#FFC017","#F0AD4E","#C7B69D","#1BC9E4","#FB9678","#25A6F7","#F7C65F","#363A5C","#55BADF","#006699","#669933","#99CCCC","#993333","#A24B29","#A27729","#967A8E","#D880E8","#A28E92","#EC6F5A"]];var functions={};functions["SUM"]=new Array(-1,"参数","SUM(number1,number2, ...)","返回某一单元格区域中所有数字之和<br/><br/>示例:SUM(3, 2)=5");functions["COUNT"]=new Array(1,"参数","COUNT(column)","返回单元格列的个数");functions["AVG"]=new Array(-1,"参数","AVG(number1,number2, ...)","返回某一单元格区域中所有数字之和的平均值<br/><br/>示例:SUM(3, 2)=2.5");functions["CHAR"]=new Array(1,"数值","CHAR(number)","数值用于转换的字符代码，介于 1 到 255 之间<br/><br/>示例: CHAR(65)=A");functions["DATE"]=new Array(3,new Array("年","月","日"),"DATE(year, month, day)","返回指定年月日的日期类型<br/><br/>示例:DATE(2013, 10 1)=Tue Oct 01 00:00:00 CST 2013(日期类型)");functions["MAX"]=new Array(-1,"参数","MAX(number1,number2, ...)","返回某一单元格区域中所有数字的最大值<br/><br/>示例:SUM(3, 2)=3");functions["MIN"]=new Array(-1,"参数","MIN(number1,number2, ...)","返回某一单元格区域中所有数字的最小值<br/><br/>示例:SUM(3, 2)=2");functions["SEQ"]=new Array(0,"","SEQ()","计算扩展单元格行数(序列号)");functions["MOM"]=new Array(-1,"参数","MOM(numberCell,groupCell, ...)","计算数据环比<br/><br/>示例:MOM(C1, A1, B1..) C1为计算环比数据单元,A1,B1..为分组单元");functions["YOY"]=new Array(-1,"参数","YOY(numberCell,groupCell, ...)","计算数据同比<br/><br/>示例:YOY(C1, A1, B1..) C1为计算同比数据单元,A1,B1..为分组单元");functions["QOQ"]=new Array(-1,"参数","QOQ(numberCell,groupCell, ...)","计算季度环比<br/><br/>示例:MOM(C1, A1, B1..) C1为计算环比数据单元,A1,B1..为分组单元");functions["HOH"]=new Array(-1,"参数","HOH(numberCell,groupCell, ...)","计算半年环比<br/><br/>示例:YOY(C1, A1, B1..) C1为计算同比数据单元,A1,B1..为分组单元");functions["SUMM"]=new Array(-1,"参数","SUMM(numberCell,groupCell, ...)","数值累加<br/><br/>示例:SUMM(C1) 或 SUMM(C1, A1, B1..) 取C1单元数据的累加值,A1,B1..为分组单元");functions["RANK"]=new Array(-1,"参数","RANK(numberCell,groupCell, ...)","排名<br/><br/>示例:RANK(C1) 或 RANK(C1, A1, B1..) 取C1单元数值,A1,B1..为分组单元");functions["AND"]=new Array(-1,"参数","AND(logical1, [logical2], ...)","所有参数的计算结果为 TRUE 时，返回 TRUE；<br/>只要有一个参数的计算结果为 FALSE，即返回 FALSE<br/><br/>示例:AND(TRUE, TRUE) = TRUE,  AND(TRUE, FALSE)=FALSE");functions["IF"]=new Array(3,"IF(logical_test,value_if_true,value_if_false)","根据对指定的条件计算结果为 TRUE 或 FALSE，返回不同的结果。<br/><br/>示例: IF(100>9, 100, 0)=100");functions["OR"]=new Array(-1,"参数","OR(logical1,logical2,...)","在其参数组中，任何一个参数逻辑值为 TRUE，即返回 TRUE；<br/>任何一个参数的逻辑值为 FALSE，即返回 FALSE<br/><br/>示例:OR(TRUE) =TRUE,  OR(1+1==1,2+2==5)=FALSE,<br/> OR(TRUE,FALSE,TRUE)=TRUE");functions["NOT"]=new Array(1,"参数","NOT(logical)","对参数值求反。当要确保一个值不等于某一特定值时，可以使用 NOT 函数<br/><br/>示例:NOT(FALSE)=TRUE, NOT(1+1=2)=FALSE");functions["TRUE"]=new Array(0,"TRUE()","返回逻辑值 TRUE");functions["FALSE"]=new Array(0,"FALSE()","返回逻辑值 FALSE");functions["CODE"]=new Array(1,"文本","CODE(text)","文本字符串中第一个字符的数字代码<br/><br/>示例:CODE(A)=65");functions["CONCATENATE"]=new Array(-1,"文本","CONCATENATE (text1,text2,...)","两个或多个文本字符串合并为一个文本字符串<br/><br/>示例:CONCATENATE(a,b,c)=abc");functions["ENDWITH"]=new Array(2,"文本","ENDWITH(text1, text2)",'判断该字符串是否以另一个字符串结束<br/><br/>示例:ENDWITH("test","st")=true,  ENDWITH("test","ab")=false');functions["STARTWITH"]=new Array(2,"文本","STARTWITH(text1, text2)","返回逻辑值 TRUE");functions["EXACT"]=new Array(2,"文本","EXACT(text1,text2)","返回逻辑值 TRUE");functions["FIND"]=new Array(3,"文本","FIND(find_text,within_text,start_num)","返回逻辑值 TRUE");functions["LEFT"]=new Array(2,"文本","LEFT(text,num_chars)",'文本字符串中第一个字符或前几个字符<br/><br/>示例:LEFT("text",2)=te,  LEFT("text",5)=text');functions["LEN"]=new Array(1,"文本","LEN(text)",'文本字符串中的字符数<br/><br/>示例:LEN("text")=4');functions["LOWER"]=new Array(1,"文本","LOWER(text)",'文本字符串中的所有大写字母转换为小写字母<br/><br/>示例:LOWER("TEXT")=text');functions["MID"]=new Array(3,"文本","MID(text,start_num,num_chars)",'MID 返回文本字符串中从指定位置开始的特定数目的字符，该数目由用户指定。<br/><br/>示例:MID(text,2,2)="ex",  MID(text,5,2)=""');functions["PROPER"]=new Array(1,"文本","PROPER(text)",'将文本字符串的首字母及任何非字母字符之后的首字母转换成大写。<br/>将其余的字母转换成小写<br/><br/>示例:PROPER("text")=Text,  PROPER("59text")=59Text');functions["REPLACE"]=new Array(4,"文本","REPLACE(old_text,start_num,num_chars,new_text)",'使用其他文本字符串并根据所指定的字符数替换某文本字符串中的部分文本<br/><br/>示例:REPLACE("abcdefghijk",6,5,"*")= abcde*k');functions["RIGHT"]=new Array(2,"文本","RIGHT(text,num_chars)",'根据所指定的字符数返回文本字符串中最后一个或多个字符<br/><br/>示例:RIGHT("text", 2)=xt');functions["SUBSTITUTE"]=new Array(4,"文本","SUBSTITUTE(text,old_text,new_text,instance_num)",'在文本字符串中用 new_text 替代 old_text<br/><br/>示例:SUBSTITUTE("销售数据", "销售", "成本")=成本数据<br/>SUBSTITUTE("2011 年第一季度", "1", "2", 3)= 2012 年第一季度');functions["TEXT"]=new Array(2,"文本","TEXT(value,format_text)",'TEXT 函数可将数值转换为文本，并可使用户通过使用特殊格式字符串来指定显示格式<br/><br/>示例:TEXT(23.5,"$0.00")=$23.50');functions["TRIM"]=new Array(1,"文本","TRIM(text)",'去除字符首尾的空格<br/><br/>示例:TRIM(" test ")=text,  TRIM("a bc")=a bc');functions["UPPER"]=new Array(1,"文本","UPPER(text)",'将文本转换成大写形式<br/><br/>示例:UPPER("text")=TEXT');functions["WEEKSTART"]=new Array(1,"日期","WEEKSTART(dateTime)","返回当前日期的上周开始时间,参数可以为空<br/><br/>示例:WEEKSTART()=2017-08-21 00:00:00(日期类型)<br/>WEEKSTART(NOW())=2017-08-21 00:00:00(日期类型)");functions["WEEKEND"]=new Array(1,"日期","WEEKEND(dateTime)","返回当前日期的上周结束时间,参数可以为空<br/><br/>示例:WEEKEND()=2017-08-27 23:59:59(日期类型)<br/>WEEKEND(NOW())=2017-08-27 23:59:59(日期类型)");functions["MONTHSTART"]=new Array(1,"日期","MONTHSTART(dateTime)","返回当前日期的上月开始时间,参数可以为空<br/><br/>示例:MONTHSTART()=2017-07-01 00:00:00(日期类型)<br/>MONTHSTART(NOW())=2017-07-01 00:00:00(日期类型)");functions["MONTHEND"]=new Array(1,"日期","MONTHEND(dateTime)","返回当前日期的上月结束时间,参数可以为空<br/><br/>示例:MONTHEND()=2017-07-31 23:59:59(日期类型)<br/>MONTHEND(NOW())=2017-07-31 23:59:59(日期类型)");functions["QUARTERSTART"]=new Array(1,"日期","QUARTERSTART(dateTime)","返回当前日期的前一个季度开始时间,参数可以为空<br/><br/>示例:QUARTERSTART()=2017-04-01 00:00:00(日期类型)<br/>QUARTERSTART(NOW())=2017-04-01 00:00:00(日期类型)");functions["QUARTEREND"]=new Array(1,"日期","QUARTEREND(dateTime)","返回当前日期的前一个季度结束时间,参数可以为空<br/><br/>示例:QUARTEREND()=2017-06-30 23:59:59(日期类型)<br/>QUARTEREND(NOW())=2017-06-30 23:59:59(日期类型)");functions["HALFYEARSTART"]=new Array(1,"日期","HALFYEARSTART(dateTime)","返回当前日期的前一个半年开始时间,参数可以为空<br/><br/>示例:HALFYEARSTART()=2017-01-01 00:00:00(日期类型)<br/>HALFYEARSTART(NOW())=2017-01-01 00:00:00(日期类型)");functions["HALFYEAREND"]=new Array(1,"日期","HALFYEAREND(dateTime)","返回当前日期的前一个半年结束时间,参数可以为空<br/><br/>示例:HALFYEAREND()=2017-06-30 23:59:59(日期类型)<br/>HALFYEAREND(NOW())=2017-06-30 23:59:59(日期类型)");functions["YEARSTART"]=new Array(1,"日期","YEARSTART(dateTime)","返回当前日期的前一年开始时间,参数可以为空<br/><br/>示例:YEARSTART()=2016-01-01 00:00:00(日期类型)<br/>YEARSTART(NOW())=2016-01-01 00:00:00(日期类型)");functions["YEAREND"]=new Array(1,"日期","YEAREND(dateTime)","返回当前日期的前一年结束时间,参数可以为空<br/><br/>示例:YEAREND()=2016-12-31 23:59:59(日期类型)<br/>YEAREND(NOW())=2016-12-31 23:59:59(日期类型)");functions["YEARADD"]=new Array(2,"日期","YEARADD(dateTime, num)",'返回datetime日期加上num年<br/>示例:YEARADD(NOW(), 1)=2019-08-21 00:00:00(日期类型),<br/> YEARADD(TODATE("2017-09-01","yyyy-MM-dd"), 1)=2018-09-01');functions["YEARSUB"]=new Array(2,"日期","YEARADD(dateTime, num)",'返回datetime日期减去num年<br/>示例:YEARSUB(NOW(), 1)=2017-08-21 00:00:00(日期类型),<br/> YEARSUB(TODATE("2017-09-01","yyyy-MM-dd"), 1)=2016-09-01');functions["MONTHADD"]=new Array(2,"日期","MONTHADD(dateTime, num)",'返回datetime日期加上num月<br/>示例:MONTHADD(NOW(), 1)=2018-09-21 00:00:00(日期类型),<br/> MONTHADD(TODATE("2017-09-01","yyyy-MM-dd"), 1)=2017-10-01');functions["MONTHSUB"]=new Array(2,"日期","MONTHSUB(dateTime, num)",'返回datetime日期减去num月<br/>示例:MONTHSUB(NOW(), 1)=2017-07-21 00:00:00(日期类型),<br/> MONTHSUB(TODATE("2017-09-01","yyyy-MM-dd"), 1)=2017-08-01');functions["DAYADD"]=new Array(2,"日期","DAYADD(dateTime, num)",'返回datetime日期加上num天<br/>示例:DAYADD(NOW(), 1)=2018-08-22 00:00:00(日期类型),<br/> DAYADD(TODATE("2017-09-01","yyyy-MM-dd"), 1)=2017-09-02');functions["DAYSUB"]=new Array(2,"日期","DAYSUB(dateTime, num)",'返回datetime日期减去num天<br/>示例:DAYSUB(NOW(), 1)=2017-08-20 00:00:00(日期类型),<br/> DAYSUB(TODATE("2017-09-01","yyyy-MM-dd"), 1)=2017-08-31');functions["HOURADD"]=new Array(2,"日期","HOURADD(dateTime, num)",'返回datetime日期加上num小时<br/>示例:HOURADD(NOW(), 1)=2018-08-22 04:00:00(日期类型),<br/> HOURADD(TODATE("2017-09-01 03","yyyy-MM-dd HH"), 1)=2017-09-01 04');functions["HOURSUB"]=new Array(2,"日期","HOURSUB(dateTime, num)",'返回datetime日期减去num小时<br/>示例:HOURSUB(NOW(), 1)=2017-08-20 02:00:00(日期类型),<br/> HOURSUB(TODATE("2017-09-01 03","yyyy-MM-dd HH"), 1)=2017-09-01 02');functions["MINUTEADD"]=new Array(2,"日期","MINUTEADD(dateTime, num)",'返回datetime日期加上num分钟<br/>示例:MINUTEADD(NOW(), 1)=2018-08-22 04:04:00(日期类型),<br/> MINUTEADD(TODATE("2017-09-01 03:03","yyyy-MM-dd HH:mm"), 1)=2017-09-01 03:04');functions["MINUTESUB"]=new Array(2,"日期","MINUTESUB(dateTime, num)",'返回datetime日期减去num分钟<br/>示例:MINUTESUB(NOW(), 1)=2017-08-20 02:02:00(日期类型),<br/> MINUTESUB(TODATE("2017-09-01 03:03","yyyy-MM-dd HH:mm"), 1)=2017-09-01 03:02');functions["SECONDADD"]=new Array(2,"日期","SECONDADD(dateTime, num)",'返回datetime日期加上num秒<br/>示例:SECONDADD(NOW(), 1)=2018-08-22 04:04:04(日期类型),<br/> SECONDADD(TODATE("2017-09-01 03:03:03","yyyy-MM-dd HH:mm:ss"), 1)=2017-09-01 03:03:04');functions["SECONDSUB"]=new Array(2,"日期","SECONDSUB(dateTime, num)",'返回datetime日期减去num秒<br/>示例:SECONDSUB(NOW(), 1)=2017-08-20 02:02:02(日期类型),<br/> SECONDSUB(TODATE("2017-09-01 03:03:03","yyyy-MM-dd HH:mm:ss"), 1)=2017-09-01 03:03:02');functions["TODATE"]=new Array(2,new Array("日期字符串","日期格式"),"TODATE(dateString, pattern)",'返回字符串的日期类型<br/><br/>示例:TODATE("20131001", "yyyyMMdd")=Tue Oct 01 00:00:00 CST 2013(日期类型)');functions["DAY"]=new Array(1,"日期","DAY(dateTime)","返回某日期的天数，用整数 1 到 31 表示<br/><br/>示例:DAY(NOW())=12");functions["HOUR"]=new Array(1,"日期","HOUR(dateTime)","返回时间值的小时数。即一个介于 0 (12:00 A.M.) 到 23 (11:00 P.M.) 之间的整数<br/><br/>示例:HOUR(NOW())=12");functions["MINUTE"]=new Array(1,"日期","MINUTE(dateTime)","返回时间值中的分钟，为一个介于 0 到 59 之间的整数<br/><br/>示例:MINUTE(NOW())=12");functions["MONTH"]=new Array(1,"日期","MONTH(dateTime)","返回日期中的月份。月份是介于 1（一月）到 12（十二月）之间的整数<br/><br/>示例:MONTH(NOW())=8");functions["NOW"]=new Array(0,"","NOW()","返回当前日期时间");functions["SECOND"]=new Array(1,"日期","SECOND(dateTime)","返回时间值的秒数。返回的秒数为 0 到 59 之间的整数<br/><br/>示例:SECOND(NOW())=8");functions["TIME"]=new Array(3,new Array("小时","分","秒"),"TIME(hour,minute,second)","返回当天的时间<br/><br/>示例:TIME(12,12,12)=Sat Aug 08 12:12:12 CST 2015(日期类型)");functions["TODAY"]=new Array(0,"TODAY()","返回当前日期<br/><br/>示例:TODAY()=Sat Aug 08 00:00:00 CST 2015(日期类型)");functions["WEEKDAY"]=new Array(1,"日期","WEEKDAY(dateTime)","返回某日期为星期几。默认情况下，其值为 1（星期天）到 7（星期六）之间的整数<br/><br/>示例:WEEKDAY(TODAY())=2");functions["WEEKNUM"]=new Array(1,"日期","WEEKNUM(dateTime)","返回一个数字，该数字代表一年中的第几周<br/><br/>示例:WEEKNUM(TODAY())=2");functions["YEAR"]=new Array(1,"日期","YEAR(dateTime)","返回某日期对应的年份<br/><br/>示例:YEAR(TODAY())=2015");functions["ABS"]=new Array(1,"数值","ABS(number)","返回数字的绝对值, 绝对值没有符号<br/><br/>示例: ABS(-2)=2, ABS(2)=2");functions["ACOS"]=new Array(1,"数值","ACOS(number)","返回数字的反余弦值。反余弦值是角度，它的余弦值为数字。<br/>返回的角度值以弧度表示，范围是 0 到 pi<br/><br/>示例:ACOS(-0.5)= 2.094395<br/>       ACOS(-0.5)*180/PI()=120");functions["ACOSH"]=new Array(1,"数值","ACOSH(number)","返回 number 参数的反双曲余弦值。参数必须大于或等于 1<br/><br/>示例:ACOSH(1)=0,  ACOSH(10)= 2.993223");functions["ASIN"]=new Array(1,"数值","ASIN(number)","返回参数的反正弦值。反正弦值为一个角度，该角度的正弦值即等于此函数的 number 参数。<br/>返回的角度值将以弧度表示，范围为 -pi/2 到 pi/2<br/><br/>示例:ASIN(-0.5)= -0.5236,  ASIN(-0.5)*180/PI()=-30");functions["ASINH"]=new Array(1,"数值","ASINH(number)","返回参数的反双曲正弦值。反双曲正弦值的双曲正弦即等于此函数的 number 参数值<br/><br/>示例:");functions["ATAN"]=new Array(1,"数值","ATAN (number)","返回反正切值。反正切值为角度，其正切值即等于 number 参数值。<br/>返回的角度值将以弧度表示，范围为 -pi/2 到 pi/2<br/><br/>示例:ATAN(1)= 0.785398,   ATAN(1)*180/PI()=45");functions["ATAN2"]=new Array(2,"数值","ATAN2(x_num,y_num)","返回给定的 X 及 Y 坐标值的反正切值。反正切的角度值等于 X 轴<br/>与通过原点和给定坐标点 (x_num, y_num) 的直线之间的夹角。<br/>结果以弧度表示并介于 -pi 到 pi 之间（不包括 -pi）。<br/><br/>示例:ATAN2(1, 1)= 0.785398,   ATAN2(-1, -1)= -2.35619");functions["ATANH"]=new Array(1,"数值","ATANH(number)","返回参数的反双曲正切值，参数必须介于 -1 到 1 之间（除去 -1 和 1）<br/><br/>示例:ATANH(0.76159416)=1,  ATANH(-0.1)= -0.10034");functions["CEILING"]=new Array(1,"数值","CEILING(number)","将参数 Number 向上舍入（沿值增大的方向）为最接近数<br/><br/>示例:CEILING(2.5)=3,  CEILING(-2.5)=-2");functions["COS"]=new Array(1,"数值","COS(number)","返回给定角度的余弦值<br/><br/>示例:COS(1.047)= 0.500171,  COS(60*PI()/180)=0.5");functions["COSH"]=new Array(1,"数值","COSH(number)","返回数字的双曲余弦值<br/><br/>示例:COSH(4) = 27.30823");functions["DEGREES"]=new Array(1,"数值","DEGREES(angle)","将弧度转换为度<br/><br/>示例:DEGREES(PI())=180");functions["EVEN"]=new Array(1,"数值","EVEN(number)","返回沿绝对值增大方向取整后最接近的偶数<br/><br/>示例:EVEN(1.5)=2,  EVEN(3)=4,  EVEN(2)=2,  EVEN(-1)=-2");functions["EXP"]=new Array(1,"EXP(number)","返回 e 的 n 次幂。常数 e等于 2.71828182845904，是自然对数的底数<br/><br/>示例:EXP(1) = 2.718282,  EXP(2)= 7.389056");functions["FACT"]=new Array(1,"数值","FACT(number)","返回某数的阶乘，一个数的阶乘等于 1*2*3*...* 该数<br/><br/>示例:FACT(5)=120 (1*2*3*4*5=120)");functions["FLOOR"]=new Array(1,"数值","FLOOR(number)","将 number 向下舍入（向零的方向）到最接近的数<br/><br/>示例:FLOOR(2.5)=2,  FLOOR(-2.5)=-2");functions["INT"]=new Array(1,"数值","INT(number)","将数字向下舍入到最接近的整数<br/><br/>示例:INT(8.9)=8,  INT(-8.9)=-9");functions["LN"]=new Array(1,"数值","LN(number)","返回一个数的自然对数。自然对数以常数项 e (2.71828182845904) 为底<br/><br/>示例:LN(86)=4.454347,  LN(2.7182818)=1");functions["LOG"]=new Array(2,"数值","LOG(number,base)","按所指定的底数，返回一个数的对数<br/><br/>示例:LOG(10)=2.30, LOG(8,2)=3");functions["LOG10"]=new Array(1,"数值","LOG10(number)","返回以 10 为底的对数<br/><br/>示例:LOG10(10)=1, LOG10(86)=1.934498451");functions["MOD"]=new Array(2,"数值","MOD(number,divisor)","返回两数相除的余数，结果的正负号与除数相同<br/><br/>示例:MOD(3,2)=1");functions["ODD"]=new Array(1,"数值","ODD(number)","返回对指定数值进行向上舍入后的奇数<br/><br/>示例:ODD(1.5)=3");functions["PI"]=new Array(0,"","PI()","返回数字 3.14159265358979，即数学常量 pi，精确到小数点后 14 位<br/><br/>示例:PI()=3.14159265358979");functions["POWER"]=new Array(2,new Array("底数","密值"),"POWER(number,power)","返回给定数字的乘幂<br/><br/>示例:POWER(5,2)=25, POWER(98.6,3.2)=2401077, POWER(4,5/4)=5.656854");functions["PRODUCT"]=new Array(-1,"数值","PRODUCT(number1, number2, ...)","计算用作参数的所有数字的乘积，然后返回乘积<br/><br/>示例:PRODUCT(3,10)=30, PRODUCT(3,10,10)=300");functions["RADIANS"]=new Array(1,"数值","RADIANS(angle)","RADIANS 函数将角度转换为弧度<br/><br/>示例:RADIANS(270)=4.712389");functions["RAND"]=new Array(0,"","RAND()","RAND 函数返回大于或等于0且小于1的平均分布随机数<br/><br/>示例:=RAND()");functions["ROUND"]=new Array(2,new Array("数值","位数"),"ROUND(number,num_digits)","ROUND 函数可将某个数字四舍五入为指定的位数<br/><br/>示例:ROUND(2.15, 1)=2.2, ROUND(2.149, 1)=2.1, ROUND(-1.475, 2)=-1.48");functions["ROUNDDOWN"]=new Array(2,new Array("数值","位数"),"ROUNDDOWN(number,num_digits)","靠近零值，向下（绝对值减小的方向）舍入数字<br/><br/>示例:ROUNDDOWN(3.2, 0)=3,  ROUNDDOWN(76.9,0)=76 <br/> ROUNDDOWN(-3.14159, 1)=-3.1");functions["ROUNDUP"]=new Array(2,new Array("数值","位数"),"ROUNDUP(number,num_digits)","远离零值，向上舍入数字<br/><br/>示例:ROUNDUP(3.2,0)=4, ROUNDUP(76.9,0)=77,  ROUNDUP(3.14159, 3)=3.142");functions["SIGN"]=new Array(1,"数值","SIGN(number)","返回数字的符号。当数字为正数时返回 1，为零时返回 0，为负数时返回 -1<br/><br/>示例:SIGN(10)=1,  SIGN(-10)=-1,  SIGN(0)=0");functions["SIN"]=new Array(1,"数值","SIN(number)","返回给定角度的正弦值<br/><br/>示例:SIN(PI())=0, SIN(PI()/2)=1,  SIN(30*PI()/180)=0.5,  SIN(RADIANS(30))=0.5");functions["SINH"]=new Array(1,"数值","SINH(number)","返回某一数字的双曲正弦值<br/><br/>示例:SINH(1)=1.175201194, SINH(-1)=-1.175201194");functions["SQRT"]=new Array(1,"数值","SQRT(number)","返回正平方根<br/><br/>示例:SQRT(16)=4");functions["TAN"]=new Array(1,"数值","TAN(number)","返回给定角度的正切值。<br/><br/>示例:TAN(0.785)=0.9992");functions["TANH"]=new Array(1,"数值","TANH(number)","返回某一数字的双曲正切<br/><br/>示例:TANH(-2)= -0.96403,  TANH(0)=0,  TANH(0.5)= 0.462117");var formats={};formats["0"]="常规";formats["101"]="0";formats["102"]="0.0";formats["103"]="0.00";formats["104"]="0.000";formats["105"]="0.0000";formats["106"]="0.00000";formats["107"]="#";formats["108"]="#.#";formats["109"]="#.##";formats["110"]="#.###";formats["111"]="#.####";formats["112"]="#.#####";formats["201"]="yyyy";formats["202"]="yyyy-MM";formats["203"]="yyyy-MM-dd";formats["204"]="yyyy年";formats["205"]="yyyy年MM月";formats["206"]="yyyy年MM月dd日";formats["207"]="yyyy/MM";formats["208"]="yyyy/MM/dd";formats["209"]="MM";formats["210"]="MM月";formats["211"]="MM-dd";formats["212"]="MM月dd日";formats["213"]="MM/dd";formats["214"]="dd";formats["215"]="dd日";formats["301"]="yyyy-MM-dd HH:mm";formats["302"]="yyyy-MM-dd HH:mm:ss";formats["303"]="yyyy年MM月dd日 HH时mm分";formats["304"]="yyyy年MM月dd日 HH时mm分ss秒";formats["401"]="HH:mm";formats["402"]="HH:mm:ss";formats["403"]="HH时mm分";formats["404"]="HH时mm分ss秒";formats["405"]="HH";formats["406"]="HH时";formats["407"]="mm";formats["408"]="mm分";formats["501"]="￥0";formats["502"]="￥0.0";formats["503"]="￥0.00";formats["504"]="￥0.000";formats["505"]="￥0.0000";formats["506"]="￥0.00000";formats["507"]="￥#";formats["508"]="￥#.#";formats["509"]="￥#.##";formats["510"]="￥#.###";formats["511"]="￥#.####";formats["512"]="￥#.#####";formats["521"]="$0";formats["522"]="$0.0";formats["523"]="$0.00";formats["524"]="$0.000";formats["525"]="$0.0000";formats["526"]="$0.00000";formats["527"]="$#";formats["528"]="$#.#";formats["529"]="$#.##";formats["530"]="$#.###";formats["531"]="$#.####";formats["532"]="$#.#####";formats["541"]="US$0";formats["542"]="US$0.0";formats["543"]="US$0.00";formats["544"]="US$0.000";formats["545"]="US$0.0000";formats["546"]="US$0.00000";formats["547"]="US$#";formats["548"]="US$#.#";formats["549"]="US$#.##";formats["550"]="US$#.###";formats["551"]="US$#.####";formats["552"]="US$#.#####";formats["601"]="0%";formats["602"]="0.0%";formats["603"]="0.00%";formats["604"]="0.000%";formats["605"]="0.0000%";formats["606"]="0.00000%";formats["607"]="#%";formats["608"]="#.#%";formats["609"]="#.##%";formats["610"]="#.###%";formats["611"]="#.####%";formats["612"]="#.#####%"