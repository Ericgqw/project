AnyExcel.prototype.chartsettting=function(F){var W=this;$("#win-chart-setting-type").find("li").hide();var r=function(AN,AS){var AP=AN.children("table:eq(0)");var AT=AP.find("tr:eq(1)");var AQ=AT.clone().show();AQ.find("select").each(function(){$(this).addClass("selectpicker").attr("data-style","btn-select");$(this).selectpicker("refresh")});var AR=AQ.find("td:eq(0)");var AO=AS["name"]?AS["name"]:"";AI(AR,AO,AS.nameValueType);var AW=AQ.find("td:eq(1)");var AV=AS["value"]?AS["value"]:"";Y(AW,AV,AS.valueValueType);var AU=AQ.find("td:eq(2)");AB(AU,AS);AP.append(AQ)};var q=function(AN,AV){var AP=AN.children("table:eq(0)");var AQ=AP.find("tr:eq(1)").clone().show();AP.append(AQ);AQ.find("select").each(function(){$(this).addClass("selectpicker").attr("data-style","btn-select").attr("data-container","body");$(this).selectpicker("refresh")});var AS=AQ.find("td:eq(0)");var AO=AV["name"]?AV["name"]:"";AS.find("input").val(AO);var AW=AQ.find("td:eq(1)");var AR=AV["column"]?AV["column"]:"";if(AV.column==undefined){var AT=F["series"]?F["series"]:{};var AR=AT["column"]?AT["column"]:"";Y(AW,AR,AT.columnValueType)}else{Y(AW,AR,AV.columnValueType)}var AU=AQ.find("td:eq(2)");var AY=AV["value"]?AV["value"]:"";Y(AU,AY,AV.valueValueType);var AX=AQ.find("td:eq(3)");AB(AX,AV)};var i=function(AN,AW){var AP=AN.children("table:eq(0)");var AQ=AP.find("tr:eq(1)").clone().show();AP.append(AQ);AQ.find("select").each(function(){$(this).addClass("selectpicker").attr("data-style","btn-select").attr("data-container","body");$(this).selectpicker("refresh")});var AS=AQ.find("td:eq(0)");var AO=AW["name"]?AW["name"]:"";AS.find("input").val(AO);var AX=AQ.find("td:eq(1)");var AR=AW["column"]?AW["column"]:"";if(AW.column==undefined){var AU=F["series"]?F["series"]:{};var AR=AU["column"]?AU["column"]:"";Y(AX,AR,AU.columnValueType)}else{Y(AX,AR,AW.columnValueType)}var AV=AQ.find("td:eq(2)");var AZ=AW["value"]?AW["value"]:"";Y(AV,AZ,AW.valueValueType);var AT=AQ.find("td:eq(3)");if(AW.type!=undefined){AT.find("select").selectpicker("val",AW.type)}var AY=AQ.find("td:eq(4)");AB(AY,AW)};var n=function(AN,AV){var AP=AN.children("table:eq(0)");var AR=AP.find("tr:eq(1)").clone().show();AP.append(AR);AR.find("select").each(function(){$(this).addClass("selectpicker").attr("data-style","btn-select").attr("data-container","body");$(this).selectpicker("refresh")});var AS=AR.find("td:eq(0)");var AO=AV["name"]?AV["name"]:"";AS.find("input").val(AO);var AW=AR.find("td:eq(1)");var AQ=AV.startDate?AV.startDate:"";Y(AW,AQ,AV.startDateValueType);var AT=AR.find("td:eq(2)");var AU=AV.endDate?AV.endDate:"";Y(AT,AU,AV.endDateValueType);var AX=AR.find("td:eq(3)");AB(AX,AV)};var X=function(AN,AR){var AO=AN.children("table:eq(0)");var AU=AO.find("tr:eq(1)");var AP=AU.clone().show();AO.append(AP);AP.find("select").each(function(){$(this).addClass("selectpicker").selectpicker("refresh")});var AT=AP.find("td:eq(0)");var AQ=AR.column?AR.column:"";Y(AT,AQ,AR.columnValueType);var AS=AP.find("td:eq(1)");var AX=AR.value?AR.value:"";Y(AS,AX,AR.valueValueType);if(d==Constant.SUNBURST_DONUT){if(AR.sunburstRadio==undefined){AR.sunburstRadio=30}}if(AR.label==undefined||AR.label.enabled==undefined){var AW={};AW.enabled=true;AW.defaultEnabled=true;AR.label=AW}var AV=AP.find("td:eq(2)");AB(AV,AR)};var AL=function(AS){var AP=$("#win-chart-setting-data-tree1").children("table");var AW=AP.find("tr:eq(1)");var AU=AW.find("td:eq(0)");var AO=AS.id?AS.id:"";Y(AU,AO,AS.idValueType);var AT=AW.find("td:eq(1)");var AV=AS.pId?AS.pId:"";Y(AT,AV,AS.pIdValueType);var AR=AW.find("td:eq(2)");var AN=AS.name?AS.name:"";Y(AR,AN,AS.nameValueType);var AQ=AW.find("td:eq(3)");var AZ=AS.value?AS.value:"";Y(AQ,AZ,AS.valueValueType);if(AS.label==undefined||AS.label.enabled==undefined){var AY={};AY.enabled=true;AY.defaultEnabled=true;AS.label=AY}if(d==Constant.SUNBURST_DONUT){if(AS.sunburstRadio==undefined){AS.sunburstRadio=30}}var AX=AW.find("td:eq(4)");AB(AX,AS)};var x=function(AT){var AO=$("#win-chart-setting-data-columnLine").children("table");var AV=AO.find("tr:eq(1)");var AR=AV.clone().show();AR.find("select").each(function(){$(this).addClass("selectpicker").selectpicker("refresh")});var AS=AR.find("td:eq(0)");var AN=AT["name"]?AT["name"]:"";AS.find("input").val(AN);var AZ=AR.find("td:eq(1)");var AX=AT["value"]?AT["value"]:"";Y(AZ,AX,AT.valueValueType);var AQ=AR.find("td:eq(2)");var AU=AT["type"]?AT["type"]:"column";AQ.find("select").selectpicker("val",AU);var AP=AR.find("td:eq(3)");var AY=AT["yAxisIndex"]?AT["yAxisIndex"]:0;AP.find("select").selectpicker("val",AY);var AW=AR.find("td:eq(4)");AB(AW,AT);AO.append(AR)};var a=function(AW){var AO=$("#win-chart-setting-data-xy").children("table");var AX=AO.find("tr:eq(1)");var AS=AX.clone().show();AS.find("select").each(function(){$(this).addClass("selectpicker").attr("data-style","btn-select").attr("data-width",70).attr("data-container","body");$(this).selectpicker("refresh")});var AU=AS.find("td:eq(0)");var AN=AW["name"]?AW["name"]:"";W.setColumn3Type(AU,AN,2);var AT=AS.find("td:eq(1)");var AY=AW["xyName"]?AW["xyName"]:"";Y(AT,AY,AW.xyNameValueType);var AR=AS.find("td:eq(2)");var AV=AW["xColumn"]?AW["xColumn"]:"";Y(AR,AV,AW.xColumnValueType);var AQ=AS.find("td:eq(3)");var Ab=AW["yColumn"]?AW["yColumn"]:"";Y(AQ,Ab,AW.yColumnValueType);var AP=AS.find("td:eq(4)");var Aa=AW["value"]?AW["value"]:"";Y(AP,Aa,AW.valueValueType);var AZ=AS.find("td:eq(5)");AB(AZ,AW);AO.append(AS)};var h=function(AT){var AO=$("#win-chart-setting-data-scatterxy").children("table");var AV=AO.find("tr:eq(1)");var AQ=AV.clone().show();AQ.find("select").each(function(){$(this).addClass("selectpicker").attr("data-style","btn-select").attr("data-width",70).attr("data-container","body");$(this).selectpicker("refresh")});var AS=AQ.find("td:eq(0)");var AN=AT["name"]?AT["name"]:"";AS.find("input").val(AN);var AR=AQ.find("td:eq(1)");var AU=AT["xColumn"]?AT["xColumn"]:"";Y(AR,AU,AT.xColumnValueType);var AP=AQ.find("td:eq(2)");var AX=AT["yColumn"]?AT["yColumn"]:"";Y(AP,AX,AT.yColumnValueType);var AW=AQ.find("td:eq(3)");AB(AW,AT);AO.append(AQ)};var D=function(AN){var AO=AN.find("tr:last");if(AO.is(":visible")){AO.remove()}};var o=function(){var AQ=$("#win-chart-setting-data").children("div:eq(1)");AQ.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=false;AW.enabled=false;AX.label=AW;r($("#win-chart-setting-data"),AX)});AQ.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data").children("table"))});var AQ=$("#win-chart-setting-data-gantt").children("div:eq(1)");AQ.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=false;AW.enabled=false;AX.label=AW;n($("#win-chart-setting-data-gantt"),AX)});AQ.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-gantt").children("table"))});var AN=$("#win-chart-setting-data-pie").children("div:eq(0)");AN.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=true;AW.enabled=true;AX.label=AW;q($("#win-chart-setting-data-pie"),AX)});AN.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-pie").children("table"))});var AP=$("#win-chart-setting-data-multi").children("div:eq(0)");AP.find("a:eq(0)").unbind("click").bind("click",function(){var AW={};i($("#win-chart-setting-data-multi"),AW)});AP.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-multi").children("table"))});var AV=$("#win-chart-setting-data-columnLine").children("div:eq(1)");AV.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=false;AW.enabled=false;AX.label=AW;x(AX)});AV.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-columnLine").children("table"))});var AO=$("#win-chart-setting-data-xy").children("div:first");AO.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=false;AW.enabled=false;AX.label=AW;a(AX)});AO.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-xy").children("table"))});var AS=$("#win-chart-setting-data-scatterxy").children("div:first");AS.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=false;AW.enabled=false;AX.label=AW;h(AX)});AS.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-scatterxy").children("table"))});var AT=$("#win-chart-setting-data-gauge").children("div:first");AT.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=false;AW.enabled=false;AX.label=AW;r($("#win-chart-setting-data-gauge"),AX)});AT.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-gauge").children("table"))});var AU=$("#win-chart-setting-data-map").children("div:eq(1)");AU.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=false;AW.enabled=false;AX.label=AW;r($("#win-chart-setting-data-map").children("div:eq(2)"),AX)});AU.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-map").children("div:eq(2)").children("table"))});var AR=$("#win-chart-setting-data-tree0").children("div:eq(0)");AR.find("a:eq(0)").unbind("click").bind("click",function(){var AX={};var AW={};AW.defaultEnabled=true;AW.enabled=true;AX.label=AW;X($("#win-chart-setting-data-tree0"),AX)});AR.find("a:eq(1)").unbind("click").bind("click",function(){D($("#win-chart-setting-data-tree0").children("table"))})};var G=function(AZ){var AT=AZ.label?AZ.label:{};var Ai=$("#win-chart-setting-style").find("table:eq(0)");var An=Ai.find("tr:eq(1)");var AO=AT["enabled"]?"check":"uncheck";An.find("input[type=checkbox]").iCheck(AO);var Am=Ai.find("tr:eq(2)");AO=(AT["nameEnabled"]==undefined||AT["nameEnabled"])?"check":"uncheck";Am.find("input[type=checkbox]").iCheck(AO);var Ad=AT["format"]?AT["format"]:"0";var Al=Ai.find("tr:eq(3)");anyExcel.setSelectFormat(Al.find("select"),Ad);var Ak=Ai.find("tr:eq(4)");var AR=AT["textStyle"]?AT["textStyle"]:{};anyExcel.initFontStyle(Ak,AR);var Aj=Ai.find("tr:eq(5)");var Ar=AT.position!=undefined?AT.position:"";Aj.find("select").selectpicker("val",Ar);var Ag=Ai.find("tr:eq(6)");var AW=AZ["color"]?AZ["color"]:null;Ag.find("input.color-select").spectrum("set",AW);var Af=Ai.find("tr:eq(7)");var AP=AZ["opacity"]?AZ["opacity"]:1;Af.find("input").val(AP);var Ae=Ai.find("tr:eq(8)");var Ah=AZ["color1"]?AZ["color1"]:null;Ae.find("input.color-select").spectrum("set",Ah);if(d==Constant.PERCENT_DONUT||d==Constant.PERCENT_BAR){Ae.show()}else{Ae.hide()}var Aa=Ai.find("tr:eq(9)");var AX=AZ["shadowBlur"]?AZ["shadowBlur"]:0;Aa.find("input").val(AX);var As=Ai.find("tr:eq(10)");var AY=AZ["shadowColor"]?AZ["shadowColor"]:null;As.find("input.color-select").spectrum("set",AY);var Aq=Ai.find("tr:eq(11)");var Ap=AZ["shadowOpacity"]?AZ["shadowOpacity"]:0;Aq.find("input").val(Ap);var Ao=Ai.find("tr:eq(12)");var Ac=AZ.barMaxWidth!=undefined?AZ.barMaxWidth:"";Ao.find("input").val(Ac);if(l()){Ao.show()}else{Ao.hide()}if(d==Constant.SUNBURST_DONUT){var AN=Ai.find("tr.sunburstRadio");AN.show();var AV=AZ.sunburstRadio!=undefined?AZ.sunburstRadio:"";AN.find("input").val(AV)}else{Ai.find("tr.sunburstRadio").hide()}if(AZ.type=="pie"||AZ.type=="donut"||AZ.type=="rose"){var Ab=Ai.find("tr.pie");Ab.show();var AU=AZ.centerX!=undefined?AZ.centerX:"75%";var AS=AZ.centerY!=undefined?AZ.centerY:"35%";$(Ab[0]).find("input:eq(0)").val(AU);$(Ab[0]).find("input:eq(1)").val(AS);var AQ=AZ.radius!=undefined?AZ.radius:"25%";$(Ab[1]).find("input").val(AQ)}else{var Ab=Ai.find("tr.pie");Ab.hide()}v(AZ)};var v=function(AS){var AY=$("#win-chart-setting-style").find("table:eq(0)");var Ab=$("#win-chart-setting-style").find("table:eq(1)");Ab.find("tr:gt(1)").remove();if(!c()){Ab.prev().hide();Ab.hide();AY.find("tr:last").hide();return }AY.find("tr:last").show();Ab.prev().show();Ab.show();var AO=AS.marklines;if(AO==undefined){return }for(var AQ=0;AQ<AO.length;AQ++){var AX=AO[AQ];var AN=Ab.find("tr:eq(1)").clone().show();Ab.append(AN);AN.find("select").addClass("selectpicker").selectpicker("refresh");var AP=AN.find("td:eq(6)");AP.find("a").click(function(){$(this).parent().parent().remove()});var AV=AX.color!=undefined?AX.color:"#ffffff";var AT=AN.find("td:eq(2)");AT.find("input").spectrum({allowEmpty:false,clearText:"清除",color:AV,showInput:true,showInitial:true,showPalette:true,showSelectionPalette:true,maxPaletteSize:10,preferredFormat:"hex",chooseText:"确定",cancelText:"取消",replaceInput:colorInput,palette:PALETTE});var AU=AN.find("td:eq(0)").find("select");if(AX.valueType!=undefined){AU.selectpicker("val",AX.valueType)}var Aa=AN.find("td:eq(1)").find("input");if(AX.value!=""){Aa.val(AX.value)}var AZ=AN.find("td:eq(3)").find("input");if(AX.width!=""){AZ.val(AX.width)}var AR=AN.find("td:eq(4)").find("select");if(AX.lineStyle!=undefined){AR.selectpicker("val",AX.lineStyle)}var AW=AN.find("td:eq(5)").find("input");if(AX.name!=""){AW.val(AX.name)}}};var AE=function(){var AO=$("#win-chart-setting-data").children("table");AO.find("tr:gt(1)").remove();var AU=F["series"]?F["series"]:{};var AR=AU["column"]?AU["column"]:"";var AN=$("#win-chart-setting-data").children("div:first");AG(AN,AR,AU.columnValueType);var AY=$("#win-chart-setting-series-pie").find("table.tb-all");var AX=AU.barGap!=undefined?AU.barGap:"";var AQ=AY.find("tr:eq(3)");AQ.find("input").val(AX);var AS=AU.barCategoryGap!=undefined?AU.barCategoryGap:"";var AP=AY.find("tr:eq(4)");AP.find("input").val(AS);var AW=AU["series"];if(AW){for(var AT=0;AT<AW.length;AT++){var AV=AW[AT];r($("#win-chart-setting-data"),AV)}}};var m=function(){var AN=$("#win-chart-setting-data-gantt").children("table");AN.find("tr:gt(1)").remove();var AP=F["series"]?F["series"]:{};var AQ=AP["column"]?AP["column"]:"";var AT=$("#win-chart-setting-data-gantt").children("div:first");AG(AT,AQ,AP.columnValueType);var AS=AP["series"];if(AS){for(var AO=0;AO<AS.length;AO++){var AR=AS[AO];n($("#win-chart-setting-data-gantt"),AR)}}};var B=function(){var AS=F["series"]?F["series"]:{};var AN=$("#win-chart-setting-series-pie").find("table.tb-all");var AT=AN.find("tr:eq(1)");var AV=AS["startAngle"]?AS["startAngle"]:"";AT.find("input").val(AV);var AQ=AN.find("tr:eq(2)");var AP=AS["endAngle"]?AS["endAngle"]:"";AQ.find("input").val(AP);var AO=$("#win-chart-setting-data-pie").children("table");AO.find("tr:gt(1)").remove();var AW=AS["series"];if(AW&&AW.length>0){for(var AR=0;AR<AW.length;AR++){var AU=AW[AR];q($("#win-chart-setting-data-pie"),AU)}}};var f=function(){var AP=F["series"]?F["series"]:{};var AN=$("#win-chart-setting-data-multi").children("table");AN.find("tr:gt(1)").remove();var AR=AP["series"];if(AR&&AR.length>0){for(var AO=0;AO<AR.length;AO++){var AQ=AR[AO];i($("#win-chart-setting-data-multi"),AQ)}}};var I=function(){var AO=$("#win-chart-setting-data-columnLine").children("table");AO.find("tr:gt(1)").remove();var AU=F["series"]?F["series"]:{};var AY=$("#win-chart-setting-series-pie").find("table.tb-all");var AX=AU.barGap!=undefined?AU.barGap:"";var AQ=AY.find("tr:eq(3)");AQ.find("input").val(AX);var AS=AU.barCategoryGap!=undefined?AU.barCategoryGap:"";var AP=AY.find("tr:eq(4)");AP.find("input").val(AS);var AR=AU["column"]?AU["column"]:"";var AN=$("#win-chart-setting-data-columnLine").children("div:first");AG(AN,AR,AU.columnValueType);var AW=AU["series"];if(AW){for(var AT=0;AT<AW.length;AT++){var AV=AW[AT];x(AV)}}};var s=function(){var AN=$("#win-chart-setting-data-xy").children("table");AN.find("tr:gt(1)").remove();var AP=F["series"]?F["series"]:{};var AR=AP["series"];if(AR){for(var AO=0;AO<AR.length;AO++){var AQ=AR[AO];a(AQ)}}};var j=function(){var AN=$("#win-chart-setting-data-scatterxy").children("table");AN.find("tr:gt(1)").remove();var AP=F["series"]?F["series"]:{};var AR=AP["series"];if(AR){for(var AO=0;AO<AR.length;AO++){var AQ=AR[AO];h(AQ)}}};var u=function(){var AT=F["series"]?F["series"]:{};var AY=AT["series"]?AT["series"]:new Array();var AU=AY.length>0?AY[0]:{};var AO=$("#win-chart-setting-data-percent");var AV=AO.find("tr:eq(1)");var AR=AV.find("td:eq(0)");var AN=AU["name"]?AU["name"]:"";Y(AR,AN,AU.nameValueType);var AQ=AV.find("td:eq(1)");var Aa=AU["value"]?AU["value"]:"";Y(AQ,Aa,AU.valueValueType);var AP=AV.find("td:eq(2)");var AX=AU["total"]?AU["total"]:"";AI(AP,AX,AU.totalValueType);var AZ=AV.find("td:eq(3)");AB(AZ,AU);var AS=AO.find("tr:eq(2)");if(d==31){AS.hide()}else{AS.show();var AW=AT.rowCount!=undefined?AT.rowCount:4;AS.find("input").val(AW)}};var k=function(){var AN=$("#win-chart-setting-data-gauge").children("table");AN.find("tr:gt(1)").remove();var AS=F["series"]?F["series"]:{};var AV=AS["series"];var AO=$("#win-chart-setting-series-gauge").find("table.tb-all");var AT=AO.find("tr:eq(1)");var AW=AS["gap"]?AS["gap"]:"";AT.find("input").val(AW);var AQ=AO.find("tr:eq(2)");var AP=AS["unitName"]?AS["unitName"]:"";AQ.find("input").val(AP);if(AV){for(var AR=0;AR<AV.length;AR++){var AU=AV[AR];r($("#win-chart-setting-data-gauge"),AU)}}};var M=function(){var AP=$("#win-chart-setting-data-map").find("table.tb-all:eq(0)");AP.find("tr:gt(1)").remove();if(d==130){$("#win-chart-setting-data-map-world-mp").show();$("#win-chart-setting-data-map").children("div:eq(2)").height(100);var AO=F["map"]?F["map"]:{};var AV=AO.nameMap;if(AV!=undefined){var AU=$("#win-chart-setting-data-map-world-mp").children("table");for(var AX in AV){AU.find("input[ref='"+AX+"']").val(AV[AX])}}}else{$("#win-chart-setting-data-map-world-mp").hide();$("#win-chart-setting-data-map").children("div:eq(2)").height(300)}var AS=F["series"]?F["series"]:{};var AQ=AS["column"]?AS["column"]:"";var AN=$("#win-chart-setting-data-map").children("div:first");AG(AN,AQ,AS.columnValueType);var AW=AS["series"];if(AW){for(var AR=0;AR<AW.length;AR++){var AT=AW[AR];r($("#win-chart-setting-data-map").children("div:eq(2)"),AT)}}};var w=function(){var AQ=F["series"]?F["series"]:{};var AO=AQ.structType!=undefined?AQ.structType:0;$("#win-chart-setting-data-tree").find("input[type=radio]").eq(AO).iCheck("check");$("#win-chart-setting-data-tree").children("div:eq(0)").find("input[type=text]").val("");$("#win-chart-setting-data-tree0").hide();$("#win-chart-setting-data-tree1").hide();if(AO==0){$("#win-chart-setting-data-tree0").show()}else{$("#win-chart-setting-data-tree1").show()}var AN=$("#win-chart-setting-data-tree0").children("table");AN.find("tr:gt(1)").remove();var AS=AQ["series"];if(AS){for(var AP=0;AP<AS.length;AP++){var AR=AS[AP];$("#win-chart-setting-data-tree").children("div:eq(0)").find("input[type=text]").val(AR.name);if(AO==0){X($("#win-chart-setting-data-tree0"),AR)}else{AL(AR)}}}$("#win-chart-setting-data-tree").find("input[type=radio]").on("ifChecked",function(){var AT=$("#win-chart-setting-data-tree").find("input[type=radio]:checked").val();$("#win-chart-setting-data-tree0").hide();$("#win-chart-setting-data-tree1").hide();if(AT==0){$("#win-chart-setting-data-tree0").show()}else{$("#win-chart-setting-data-tree1").show();AL({})}})};var O=function(){var AX=F["chart"]?F["chart"]:{};var Ai=$("#win-chart-setting-chart").find("tr:eq(1)");var Ak=AX["borderWidth"]?AX["borderWidth"]:"";Ai.find("input").val(Ak);var Ah=$("#win-chart-setting-chart").find("tr:eq(2)");var AO=AX["borderColor"]?AX["borderColor"]:null;Ah.find("input").spectrum("set",AO);var Ag=$("#win-chart-setting-chart").find("tr:eq(3)");var AW=AX["borderOpacity"]?AX["borderOpacity"]:"";Ag.find("input").val(AW);var Af=$("#win-chart-setting-chart").find("tr:eq(4)");var AP=AX["borderRadius"]?AX["borderRadius"]:10;Af.find("input").val(AP);var Ad=$("#win-chart-setting-chart").find("tr:eq(5)");var AT=AX["backgroundColor"]?AX["backgroundColor"]:null;Ad.find("input").spectrum("set",AT);var Ac=$("#win-chart-setting-chart").find("tr:eq(6)");var AV=AX["bgOpacity"]?AX["bgOpacity"]:"";Ac.find("input").val(AV);var Ab=$("#win-chart-setting-chart").find("tr:eq(7)");var AY=AX["marginLeft"]?AX["marginLeft"]:"";Ab.find("input").val(AY);var Aa=$("#win-chart-setting-chart").find("tr:eq(8)");var AQ=AX["marginTop"]?AX["marginTop"]:"";Aa.find("input").val(AQ);var AZ=$("#win-chart-setting-chart").find("tr:eq(9)");var AS=AX["marginRight"]?AX["marginRight"]:"";AZ.find("input").val(AS);var Al=$("#win-chart-setting-chart").find("tr:eq(10)");var AU=AX["marginBottom"]?AX["marginBottom"]:"";Al.find("input").val(AU);var AN=AX["asyncData"];var Aj=$("#win-chart-setting-chart").find("tr:eq(11)");var Ae=AN&&AN["interval"]?AN["interval"]:"";Aj.find("input").val(Ae);var AR=AN&&AN["timeType"]?AN["timeType"]:"0";Aj.find("select").selectpicker("val",AR)};var S=function(){var AU=F["title"]?F["title"]:{};var AR=$("#win-chart-setting-title").find("tr:eq(1)");var AV="check";if(AU.enabled!=undefined&&!AU.enabled){AV="uncheck"}AR.find("input").iCheck(AV);var AQ=$("#win-chart-setting-title").find("tr:eq(2)");var AX=AU["text"]?AU["text"]:"";AQ.find("input").val(AX);t(AQ.find("td:eq(1)"),AX,AU.textValueType);var AT=AU["textStyle"]?AU["textStyle"]:{};var AP=$("#win-chart-setting-title").find("tr:eq(3)");anyExcel.initFontStyle(AP,AT);var AO=$("#win-chart-setting-title").find("tr:eq(4)");var AW=AU["backgroundColor"]?AU["backgroundColor"]:null;AO.find("input.color-select").spectrum("set",AW);var AN=$("#win-chart-setting-title").find("tr:eq(5)");var AS=AU.align!=undefined?AU.align:"center";AN.find("select").selectpicker("val",AS)};var AK=function(){var Ad=F["tooltip"]?F["tooltip"]:{};var AX=$("#win-chart-setting-tooltip").find("tr:eq(1)");var Aa="check";if(Ad.enabled!=undefined&&!Ad.enabled){Aa="uncheck"}AX.find("input").iCheck(Aa);var AW=$("#win-chart-setting-tooltip").find("tr:eq(2)");var Ac=Ad["format"]?Ad["format"]:0;anyExcel.setSelectFormat(AW.find("select"),Ac);var AV=$("#win-chart-setting-tooltip").find("tr:eq(3)");var AZ=Ad["padding"]?Ad["padding"]:10;AV.find("input").val(AZ);var AU=$("#win-chart-setting-tooltip").find("tr:eq(4)");var AT=Ad["borderColor"]?Ad["borderColor"]:null;AU.find("input.color-select").spectrum("set",AT);var AS=$("#win-chart-setting-tooltip").find("tr:eq(5)");var AN=Ad["borderWidth"]?Ad["borderWidth"]:0;AS.find("input").val(AN);var AR=$("#win-chart-setting-tooltip").find("tr:eq(6)");var AQ=Ad["borderRadius"]?Ad["borderRadius"]:3;AR.find("input").val(AQ);var AP=$("#win-chart-setting-tooltip").find("tr:eq(7)");var Ab=Ad["backgroundColor"]?Ad["backgroundColor"]:null;AP.find("input.color-select").spectrum("set",Ab);var AY=Ad["textStyle"]?Ad["textStyle"]:{};var AO=$("#win-chart-setting-tooltip").find("tr:eq(8)");anyExcel.initFontStyle(AO,AY)};var N=function(){var AZ=F["legend"]?F["legend"]:{};var AY="check";if(AZ.enabled!=undefined&&!AZ.enabled){AY="uncheck"}var AU=$("#win-chart-setting-legend").find("tr:eq(1)");AU.find("input").iCheck(AY);var AT=$("#win-chart-setting-legend").find("tr:eq(2)");var AV=AZ["layout"]?AZ["layout"]:"horizontal";AT.find("select.selectpicker").selectpicker("val",AV);var AS=$("#win-chart-setting-legend").find("tr:eq(3)");var AX=AZ["align"]?AZ["align"]:"center";AS.find("select.selectpicker").selectpicker("val",AX);var AR=$("#win-chart-setting-legend").find("tr:eq(4)");var AQ=AZ["verticalAlign"]?AZ["verticalAlign"]:"bottom";AR.find("select.selectpicker").selectpicker("val",AQ);var AP=$("#win-chart-setting-legend").find("tr:eq(5)");var AN=AZ["itemGap"]?AZ["itemGap"]:10;AP.find("input").val(AN);var AW=AZ["textStyle"]?AZ["textStyle"]:{};var AO=$("#win-chart-setting-legend").find("tr:eq(6)");anyExcel.initFontStyle(AO,AW)};var L=function(BJ,Ay){var Ae=F[Ay]?F[Ay]:{};var A4=Ae["label"]?Ae["label"]:{};var BA=BJ.find("tr:eq(1)");var Aq=A4["rotation"]?A4["rotation"]:0;BA.find("select.selectpicker").selectpicker("val",Aq);var AO=A4["textStyle"]?A4["textStyle"]:{};var A8=BJ.find("tr:eq(2)");anyExcel.initFontStyle(A8,AO);var A6=BJ.find("tr:eq(3)");var An=A4["format"]?A4["format"]:0;anyExcel.setSelectFormat(A6.find("select"),An);var As=Ae["title"]?Ae["title"]:{};var A3=BJ.find("tr:eq(5)");var AW;if(As["enabled"]==undefined){AW="check"}else{AW=As["enabled"]?"check":"uncheck"}A3.find("input").iCheck(AW);var A1=BJ.find("tr:eq(6)");var AQ=(Ay=="xAxis")?0:90;var Av=As["rotation"]?As["rotation"]:AQ;A1.find("select.selectpicker").selectpicker("val",Av);var A0=BJ.find("tr:eq(7)");var Al=As["text"]?As["text"]:"";A0.find("input").val(Al);var AX=As["textStyle"]?As["textStyle"]:{};var Az=BJ.find("tr:eq(8)");anyExcel.initFontStyle(Az,AX);var BK=BJ.find("tr:eq(10)");var AP=Ae.axisEnabled!=undefined?Ae.axisEnabled:true;BK.find("input").iCheck(AP?"check":"uncheck");var BI=BJ.find("tr:eq(11)");var Af=Ay=="xAxis"?"category":"number";var Ad=Ae["type"]?Ae["type"]:Af;BI.find("select.selectpicker").selectpicker("val",Ad);BI.find("select.selectpicker").change(function(){BJ.find("tr.xaxis-type-number").hide();BJ.find("tr.xaxis-type-datetime").hide();var BN=$(this).val();if(BN=="number"){BJ.find("tr.xaxis-type-number").show()}else{if(BN=="datetime"){BJ.find("tr.xaxis-type-datetime").show()}}});BI.find("select.selectpicker").trigger("change");var BH=BJ.find("tr:eq(12)");BH.find("input").val("");if(Ad=="number"){var BM=Ae["min"]!=undefined?Ae["min"]:"";BH.find("input").val(BM)}var BF=BJ.find("tr:eq(13)");BF.find("input").val("");if(Ad=="number"){var Ac=Ae["max"]!=undefined?Ae["max"]:"";BF.find("input").val(Ac)}var BE=BJ.find("tr:eq(14)");BE.find("input").val("");if(Ad=="number"){var At=Ae["step"]?Ae["step"]:"";BE.find("input").val(At)}var BD=BJ.find("tr:eq(15)");BD.find("select.selectpicker").selectpicker("val","");if(Ad=="datetime"){var An=Ae["format"]?Ae["format"]:"";anyExcel.setSelectFormat(BD.find("select"),An)}var BC=BJ.find("tr:eq(16)");BC.find("input").val("");if(Ad=="datetime"){var Ab=Ae["timeTnterval"]?Ae["timeTnterval"]:"";BC.find("input").val(Ab);var AR=Ae["intervalUnit"]?Ae["intervalUnit"]:"d";BC.find("select.selectpicker").selectpicker("val",AR)}var A9=BJ.find("tr:eq(17)");A9.find("input").val("");if(Ad=="datetime"){var AT=Ae["timeSpan"]?Ae["timeSpan"]:"";A9.find("input").val(AT);var BG=Ae["timeSpanFormat"]?Ae["timeSpanFormat"]:"d";A9.find("select.selectpicker").selectpicker("val",BG)}var A7=BJ.find("tr:eq(18)");var BL=Ae["lineColor"]!=undefined?Ae["lineColor"]:null;A7.find("input.color-select").spectrum("set",BL);var A5=BJ.find("tr:eq(19)");var AZ=Ae["lineWidth"]!=undefined?Ae["lineWidth"]:"";A5.find("input").val(AZ);var Ar=BJ.find("tr:eq(20)");var AY=Ae["tickColor"]!=undefined?Ae["tickColor"]:null;Ar.find("input.color-select").spectrum("set",AY);var Ap=BJ.find("tr:eq(21)");var Au=Ae["tickLength"]!=undefined?Ae["tickLength"]:"";Ap.find("input").val(Au);var Ao=BJ.find("tr:eq(22)");var BB=Ae["tickWidth"]!=undefined?Ae["tickWidth"]:"";Ao.find("input").val(BB);var Am=BJ.find("tr:eq(24)");var Aw=Ae.splitLineEnabled!=undefined?Ae.splitLineEnabled:true;Am.find("input").iCheck(Aw?"check":"uncheck");var Ak=BJ.find("tr:eq(25)");var Ai=Ae.splitLineType!=undefined?Ae.splitLineType:"solid";Ak.find("select").selectpicker("val",Ai);var Aj=BJ.find("tr:eq(26)");var A2=Ae["splitLineColor"]?Ae["splitLineColor"]:null;Aj.find("input.color-select").spectrum("set",A2);var Ah=BJ.find("tr:eq(27)");var AV=Ae["splitLineWidth"]!=undefined?Ae["splitLineWidth"]:"";Ah.find("input").val(AV);var Ag=BJ.find("tr:eq(29)");var Ax=Ae["dataZoomEnabled"]!=undefined?Ae["dataZoomEnabled"]:false;var AW="uncheck";if(Ax){AW="check"}Ag.find("input").iCheck(AW);var AU=BJ.find("tr:eq(30)");var Aa=Ae.zoomStart!=undefined?Ae.zoomStart:50;AU.find("input").val(Aa);var AS=BJ.find("tr:eq(31)");var AN=Ae.zoomEnd!=undefined?Ae.zoomEnd:100;AS.find("input").val(AN)};var AD=function(){var AR=F["axis"]?F["axis"]:{};var AU=AR["label"]?AR["label"]:{};var Af=$("#win-chart-setting-radar").find("tr:eq(1)");var AO=AU["enabled"]?"check":"uncheck";Af.find("input").iCheck(AO);var Ae=$("#win-chart-setting-radar").find("tr:eq(2)");var AW=AU["rotation"]?AU["rotation"]:0;Ae.find("select.selectpicker").selectpicker("val",AW);var AS=AU["textStyle"]?AU["textStyle"]:{};var Ad=$("#win-chart-setting-radar").find("tr:eq(3)");anyExcel.initFontStyle(Ad,AS);var Ac=$("#win-chart-setting-radar").find("tr:eq(4)");var AY=AU["format"]?AU["format"]:0;anyExcel.setSelectFormat(Ac.find("select"),AY);var Ab=$("#win-chart-setting-radar").find("tr:eq(6)");var AP=AR["lineColor"]?AR["lineColor"]:"#ffffff";Ab.find("input.color-select").spectrum("set",AP);var Aa=$("#win-chart-setting-radar").find("tr:eq(7)");var AN=AR["lineWidth"]?AR["lineWidth"]:"";Aa.find("input").val(AN);var AZ=$("#win-chart-setting-radar").find("tr:eq(8)");var AV=AR["tickColor"]?AR["tickColor"]:"#ffffff";AZ.find("input.color-select").spectrum("set",AV);var AX=$("#win-chart-setting-radar").find("tr:eq(9)");var AQ=AR["tickLength"]?AR["tickLength"]:"";AX.find("input").val(AQ);var Ag=$("#win-chart-setting-radar").find("tr:eq(10)");var AT=AR["tickWidth"]?AR["tickWidth"]:"";Ag.find("input").val(AT)};var E=function(){var AW=$("#win-chart-setting-gauge");var AQ=F["axis"]?F["axis"]:{};var AU=AQ["label"]?AQ["label"]:{};var AR=AU["textStyle"]?AU["textStyle"]:{};var Ai=AW.find("tr:eq(1)");anyExcel.initFontStyle(Ai,AR);var Ah=AW.find("tr:eq(2)");var Aa=AU["format"]?AU["format"]:0;anyExcel.setSelectFormat(Ah.find("select"),Aa);var Ag=AW.find("tr:eq(4)");var AX=AQ["min"]!=undefined?AQ["min"]:"";Ag.find("input").val(AX);var Af=AW.find("tr:eq(5)");var AZ=AQ["max"]!=undefined?AQ["max"]:"";Af.find("input").val(AZ);var Ae=AW.find("tr:eq(6)");var AS=AQ["tickGap"]?AQ["tickGap"]:"";Ae.find("input").val(AS);var Ac=$("#win-chart-setting-radar").find("tr:eq(7)");var AO=AQ["lineColor"]?AQ["lineColor"]:"#ffffff,#ffffff,#ffffff";var Ad=AO.split(",");Ac.find("input.color-select").each(function(Al){$(this).spectrum("set",Ad[Al])});var Ab=AW.find("tr:eq(8)");var AN=AQ["lineWidth"]?AQ["lineWidth"]:"";Ab.find("input").val(AN);var AY=AW.find("tr:eq(9)");var AV=AQ["tickColor"]?AQ["tickColor"]:"#ffffff";AY.find("input.color-select").spectrum("set",AV);var Ak=AW.find("tr:eq(10)");var AP=AQ["tickLength"]?AQ["tickLength"]:"";Ak.find("input").val(AP);var Aj=AW.find("tr:eq(11)");var AT=AQ["tickWidth"]?AQ["tickWidth"]:"";Aj.find("input").val(AT)};var U=function(){var A0=F["map"]?F["map"]:{};var Ar=$("#win-chart-setting-map").find("table:eq(0)");var BK=Ar.find("tr:eq(0)");var Aq=A0.areaLabelEnable!=undefined?A0.areaLabelEnable:true;BK.find("input").iCheck(Aq?"check":"uncheck");var AS=A0["textStyle"]?A0["textStyle"]:{};var BH=Ar.find("tr:eq(1)");anyExcel.initFontStyle(BH,AS);var BI=A0["areaColor"]?A0["areaColor"]:"#eeeeee";var BG=Ar.find("tr:eq(2)");BG.find("input.color-select").spectrum("set",BI);var BF=Ar.find("tr:eq(3)");var An=A0["areaLineWidth"]?A0["areaLineWidth"]:"";BF.find("input").val(An);var BE=Ar.find("tr:eq(4)");var BT=A0["areaLineColor"]?A0["areaLineColor"]:"#444444";BE.find("input.color-select").spectrum("set",BT);var BD=Ar.find("tr:eq(5)");var AW=A0.roam!=undefined?A0.roam:false;BD.find("input").iCheck(AW?"check":"uncheck");var A2=$("#win-chart-setting-map").find("table.gis");var AN=$("#win-chart-setting-map-moveline").find("table");if(d==127){Ar.find("tr:eq(6)").hide();Ar.find("tr:eq(7)").hide();Ar.find("tr:eq(8)").hide();Ar.find("tr:eq(9)").hide();Ar.find("tr:eq(10)").hide();Ar.find("tr:eq(11)").hide();Ar.find("tr:eq(12)").hide();Ar.find("tr:eq(13)").hide();Ar.find("tr:eq(14)").hide();A2.show();var BL=A0["zoom"]?A0["zoom"]:"5";var Ax=A2.find("tr:eq(1)");Ax.find("input").val(BL);var A4=A0.pos!=undefined?A0.pos:"104.114129,37.550339";var Av=A2.find("tr:eq(2)");Av.find("input").val(A4);var Ah=A0.key!=undefined?A0.key:"";var Au=A2.find("tr:eq(3)");Au.find("input").val(Ah);var Ay=A0.waterColor!=undefined?A0.waterColor:null;var As=A2.find("tr:eq(4)");As.find("input.color-select").spectrum("set",Ay);var Ao=A2.find("tr:eq(5)");var BB=A0.landColor!=undefined?A0.landColor:null;Ao.find("input.color-select").spectrum("set",BB);var Am=A2.find("tr:eq(6)");var A7=A0.boundaryColor!=undefined?A0.boundaryColor:null;Am.find("input.color-select").spectrum("set",A7);var Ak=A2.find("tr:eq(7)");var Ae=A0.boundaryFillColor!=undefined?A0.boundaryFillColor:null;Ak.find("input.color-select").spectrum("set",Ae)}else{Ar.find("tr:eq(6)").show();Ar.find("tr:eq(7)").show();Ar.find("tr:eq(8)").show();Ar.find("tr:eq(9)").show();Ar.find("tr:eq(10)").show();Ar.find("tr:eq(11)").show();Ar.find("tr:eq(12)").show();Ar.find("tr:eq(13)").show();Ar.find("tr:eq(14)").show();A2.hide();var BC=Ar.find("tr:eq(6)");var BL=A0.zoom!=undefined?A0.zoom:"";BC.find("input").val(BL);var BA=Ar.find("tr:eq(8)");var A8=A0.visualEnabled!=undefined?A0.visualEnabled:true;BA.find("input").iCheck(A8?"check":"uncheck");var A9=Ar.find("tr:eq(9)");var A5=A0["visualStartColor"]?A0["visualStartColor"]:"#007de4";A9.find("input.color-select").spectrum("set",A5);var BR=Ar.find("tr:eq(10)");var AR=A0["visualMidColor"]?A0["visualMidColor"]:null;BR.find("input.color-select").spectrum("set",AR);var BQ=Ar.find("tr:eq(11)");var Ap=A0["visualEndColor"]?A0["visualEndColor"]:"#defaff";BQ.find("input.color-select").spectrum("set",Ap);var BP=Ar.find("tr:eq(12)");var Ag=A0["orient"]!=undefined?A0["orient"]:"vertical";BP.find("select").selectpicker("val",Ag);var BO=Ar.find("tr:eq(13)");var AV=A0["left"]!=undefined?A0["left"]:"left";BO.find("select").selectpicker("val",AV);var BM=Ar.find("tr:eq(14)");var AY=A0["top"]!=undefined?A0["top"]:"bottom";BM.find("select").selectpicker("val",AY)}var BS=$("#win-chart-setting-map").find("table.scatter");BS.find("tr:gt(1)").remove();var Ab=A0.serieScatters;if(Ab!=undefined){for(var BN=0;BN<Ab.length;BN++){var AX=Ab[BN];anyExcel.addScatterSerie(BS);var Af=BS.find("tr:last");var AU=Af.find("td:eq(0)");var AZ=AX.size!=undefined?AX.size:"";AU.find("input").val(AZ);var AT=Af.find("td:eq(1)");AT.find("select").selectpicker("val",AX.type);var AQ=Af.find("td:eq(2)");AQ.find("select").selectpicker("val",AX.sortType);var A6=AX.sortNum!=undefined?AX.sortNum:"";AQ.find("input").val(A6);var AP=Af.find("td:eq(3)");var Az=AX.color?AX.color:null;AP.find("input").spectrum("set",Az);var AO=Af.find("td:eq(4)");var Aw=AX.scatterLabel!=undefined?AX.scatterLabel:{};AO.find("a").data("scatterLabel",Aw)}}var A3=$("#win-chart-setting-map-pos").find("table");A3.find("tr:gt(1)").remove();var Ai=A0.items!=undefined?A0.items:new Array();for(var BN=0;BN<Ai.length;BN++){var A1=Ai[BN];var At=A3.find("tr:eq(1)").clone().show();A3.append(At);var Al=At.find("td:eq(0)");var A4=A1.pos!=undefined?A1.pos:"";Al.find("input").val(A4);var Aj=At.find("td:eq(1)");var Ad=A1.name!=undefined?A1.name:"";Aj.find("input").val(Ad);var BJ=At.find("td:eq(2)");BJ.find("a").click(function(){$(this).parent().parent().remove()})}AN.find("tr:gt(1)").remove();var Aa=A0.movelines;if(Aa!=undefined&&Aa.length>0){for(var BN=0;BN<Aa.length;BN++){var Ac=Aa[BN];anyExcel.addMoveline(AN,Ac)}}};var Q=function(){var AY=F.styleMap?F.styleMap:{};var AT=$("#win-chart-setting-style-map").find("div:eq(0)");var AQ=$("#win-chart-setting-style-map").find("table:eq(0)");AQ.find("tr:gt(1)").remove();var AU=AY.data!=undefined?AY.data:new Array();if(d==127){AT.hide();AQ.hide()}else{AT.show();AQ.show()}for(var AV=0;AV<AU.length;AV++){var Ab=AU[AV];var AR=AQ.find("tr:eq(1)").clone().show();AQ.append(AR);var AS=AR.find("td:eq(0)");var Aa=Ab.key!=undefined?Ab.key:"";AS.find("input").val(Aa);var AP=AR.find("td:eq(1)");var Ac=Ab.data!=undefined?Ab.data:"";AP.find("textarea").val(Ac);AR.find("td:eq(2)").find("input[type=file]").change(function(){var Ae=this.files[0];var Ad=new FileReader();var Af=$(this).parent().prev();Ad.onload=function(){var Ag=this.result;Af.find("textarea").val(Ag)};Ad.readAsText(Ae)});var AW=AR.find("td:eq(3)");AW.find("a").click(function(){$(this).parent().parent().remove()})}var AO=$("#win-chart-setting-style-map").find("table:eq(1)");AO.find("tr:gt(1)").remove();var AX=AY.items!=undefined?AY.items:new Array();for(var AV=0;AV<AX.length;AV++){var Ab=AX[AV];var AR=AO.find("tr:eq(1)").clone().show();AO.append(AR);var AS=AR.find("td:eq(0)");var AZ=Ab.pos!=undefined?Ab.pos:"";AS.find("input").val(AZ);var AP=AR.find("td:eq(1)");var AN=Ab.name!=undefined?Ab.name:"";AP.find("input").val(AN);var AW=AR.find("td:eq(2)");AW.find("a").click(function(){$(this).parent().parent().remove()})}};var AF=function(){var AT=new Array();var AQ=F.series?F.series:{};var AN=$("#win-chart-setting-data").find("div:eq(0)");AQ["column"]=AN.find("input[name=serieName]").val();AQ["columnValueType"]=AN.find("select").val();var AV=$("#win-chart-setting-series-pie").find("table.tb-all");var AR=AV.find("tr:eq(3)");var AU=AR.find("input").val();AQ.barGap=AU!=""?AU:undefined;var AP=AV.find("tr:eq(4)");var AS=AP.find("input").val();AQ.barCategoryGap=AS!=""?AS:undefined;var AO=$("#win-chart-setting-data").find("table.tb-all");AO.find("tr:gt(1)").each(function(AX){var Aa={};var AZ=$(this).find("td:eq(0)");Aa["name"]=AZ.find("input").val();Aa["nameValueType"]=AZ.find("select").val();var AY=$(this).find("td:eq(1)");Aa["value"]=AY.find("input.column").val();Aa["valueValueType"]=AY.find("select").val();var AW=$(this).find("td:eq(2)");var Ab=AW.find("a").data("serie");Aa["label"]=Ab.label;if(Ab.barMaxWidth!=undefined){Aa.barMaxWidth=Ab.barMaxWidth}Aa.color=Ab.color;Aa.opacity=Ab.opacity;Aa.shadowBlur=Ab.shadowBlur;Aa.shadowColor=Ab.shadowColor;Aa.shadowOpacity=Ab.shadowOpacity;if(Ab.marklines!=undefined){Aa.marklines=Ab.marklines}AT.push(Aa)});AQ.series=AT;F["series"]=AQ};var R=function(){var AO=new Array();var AP=F.series?F.series:{};var AQ=$("#win-chart-setting-data-gantt").find("div:eq(0)");AP["column"]=AQ.find("input[name=serieName]").val();AP["columnValueType"]=AQ.find("select").val();var AN=$("#win-chart-setting-data-gantt").find("table.tb-all");AN.find("tr:gt(1)").each(function(AT){var AW={};var AV=$(this).find("td:eq(0)");AW["name"]=AV.find("input").val();var AU=$(this).find("td:eq(1)");AW.startDate=AU.find("input.column").val();AW.startDateValueType=AU.find("select").val();var AS=$(this).find("td:eq(2)");AW.endDate=AS.find("input.column").val();AW.endDateValueType=AS.find("select").val();var AR=$(this).find("td:eq(3)");var AX=AR.find("a").data("serie");AW["label"]=AX.label;AW.color=AX.color;AW.opacity=AX.opacity;AW.shadowBlur=AX.shadowBlur;AW.shadowColor=AX.shadowColor;AW.shadowOpacity=AX.shadowOpacity;AO.push(AW)});AP.series=AO;F["series"]=AP};var g=function(){var AP=new Array();var AR=F.series?F.series:{};var AQ=$("#win-chart-setting-data-tree").children("div:eq(0)").find("input[type=text]").val();var AO=$("#win-chart-setting-data-tree").find("input[type=radio]:checked").val();if(AO==0){var AN=$("#win-chart-setting-data-tree0").find("table.tb-all");AN.find("tr:gt(1)").each(function(AT){var AW={};AW.name=AQ;var AV=$(this).find("td:eq(0)");AW.column=AV.find("input.column").val();AW.columnValueType=AV.find("select").val();var AU=$(this).find("td:eq(1)");AW.value=AU.find("input.column").val();AW.valueValueType=AU.find("select").val();var AS=$(this).find("td:eq(2)");var AX=AS.find("a").data("serie");AW["label"]=AX.label;AW.color=AX.color;AW.opacity=AX.opacity;AW.shadowBlur=AX.shadowBlur;AW.shadowColor=AX.shadowColor;AW.shadowOpacity=AX.shadowOpacity;AW.sunburstRadio=AX.sunburstRadio;AP.push(AW)});AR.structType=AO;AR.series=AP;F["series"]=AR}else{var AN=$("#win-chart-setting-data-tree1").find("table.tb-all");AN.find("tr:gt(1)").each(function(AV){var AY={};AY.name=AQ;var AX=$(this).find("td:eq(0)");AY.id=AX.find("input.column").val();AY.idValueType=AX.find("select").val();var AW=$(this).find("td:eq(1)");AY.pId=AW.find("input.column").val();AY.pIdValueType=AW.find("select").val();var AU=$(this).find("td:eq(2)");AY.column=AU.find("input.column").val();AY.columnValueType=AU.find("select").val();var AT=$(this).find("td:eq(3)");AY.value=AT.find("input.column").val();AY.valueValueType=AW.find("select").val();var AS=$(this).find("td:eq(4)");var AZ=AS.find("a").data("serie");AY["label"]=AZ.label;AY.color=AZ.color;AY.opacity=AZ.opacity;AY.shadowBlur=AZ.shadowBlur;AY.shadowColor=AZ.shadowColor;AY.shadowOpacity=AZ.shadowOpacity;AY.sunburstRadio=AZ.sunburstRadio;AP.push(AY)});AR.structType=AO;AR.series=AP;F["series"]=AR}};var V=function(){var AQ={};var AP=new Array();var AO=$("#win-chart-setting-data-pie").find("table.tb-all");AO.find("tr:gt(1)").each(function(AU){var AX={};var AW=$(this).find("td:eq(0)");AX["name"]=AW.find("input").val();AX["nameValueType"]=AW.find("select").val();var AV=$(this).find("td:eq(1)");AX["column"]=AV.find("input.column").val();AX["columnValueType"]=AV.find("select").val();var AT=$(this).find("td:eq(2)");AX["value"]=AT.find("input.column").val();AX["valueValueType"]=AT.find("select").val();var AS=$(this).find("td:eq(3)");var AY=AS.find("a").data("serie");AX["label"]=AY.label;if(AY.barMaxWidth!=undefined){AX.barMaxWidth=AY.barMaxWidth}AX.color=AY.color;AX.opacity=AY.opacity;AX.shadowBlur=AY.shadowBlur;AX.shadowColor=AY.shadowColor;AX.shadowOpacity=AY.shadowOpacity;AP.push(AX)});AQ["series"]=AP;var AN=$("#win-chart-setting-series-pie").find("tr:eq(1)");AQ["startAngle"]=AN.find("input").val();var AR=$("#win-chart-setting-series-pie").find("tr:eq(2)");AQ["endAngle"]=AR.find("input").val();F["series"]=AQ};var H=function(){var AP={};var AO=new Array();var AN=$("#win-chart-setting-data-multi").find("table.tb-all");AN.find("tr:gt(1)").each(function(AT){var AW={};var AV=$(this).find("td:eq(0)");AW["name"]=AV.find("input").val();AW["nameValueType"]=AV.find("select").val();var AU=$(this).find("td:eq(1)");AW["column"]=AU.find("input.column").val();AW["columnValueType"]=AU.find("select").val();var AS=$(this).find("td:eq(2)");AW["value"]=AS.find("input.column").val();AW["valueValueType"]=AS.find("select").val();var AR=$(this).find("td:eq(3)");AW.type=AR.find("select").val();var AQ=$(this).find("td:eq(4)");var AX=AQ.find("a").data("serie");AW["label"]=AX.label;AW.color=AX.color;AW.opacity=AX.opacity;AW.shadowBlur=AX.shadowBlur;AW.shadowColor=AX.shadowColor;AW.shadowOpacity=AX.shadowOpacity;AW.centerX=AX.centerX;AW.centerY=AX.centerY;AW.radius=AX.radius;AO.push(AW)});AP["series"]=AO;F["series"]=AP};var AH=function(){var AT=new Array();var AQ={};var AN=$("#win-chart-setting-data-columnLine").find("div:eq(0)");AQ["column"]=AN.find("input[name=serieName]").val();AQ["columnValueType"]=AN.find("select").val();var AV=$("#win-chart-setting-series-pie").find("table.tb-all");var AR=AV.find("tr:eq(3)");var AU=AR.find("input").val();AQ.barGap=AU!=""?AU:undefined;var AP=AV.find("tr:eq(4)");var AS=AP.find("input").val();AQ.barCategoryGap=AS!=""?AS:undefined;var AO=$("#win-chart-setting-data-columnLine").find("table.tb-all");AO.find("tr:gt(1)").each(function(AZ){var Ac={};var Ab=$(this).find("td:eq(0)");Ac["name"]=Ab.find("input").val();Ac["nameValueType"]=Ab.find("select").val();var Aa=$(this).find("td:eq(1)");Ac["value"]=Aa.find("input").val();Ac["valueValueType"]=Aa.find("select").val();var AY=$(this).find("td:eq(2)");Ac["type"]=AY.find("select.selectpicker").val();var AX=$(this).find("td:eq(3)");Ac["yAxisIndex"]=AX.find("select.selectpicker").val();var AW=$(this).find("td:eq(4)");var Ad=AW.find("a").data("serie");Ac["label"]=Ad.label;if(Ad.color!=undefined){Ac.color=Ad.color}Ac.opacity=Ad.opacity;if(Ad.barMaxWidth!=undefined){Ac.barMaxWidth=Ad.barMaxWidth}Ac.shadowBlur=Ad.shadowBlur;Ac.shadowColor=Ad.shadowColor;Ac.shadowOpacity=Ad.shadowOpacity;AT.push(Ac)});AQ.series=AT;F["series"]=AQ};var Z=function(){var AP={};var AO=new Array();var AN=$("#win-chart-setting-data-xy").find("table.tb-all");AN.find("tr:gt(1)").each(function(AX){var AY={};var AW=$(this).find("td:eq(0)");AY["name"]=AW.find("input.column").val();AY["nameValueType"]=AW.find("select").val();var AV=$(this).find("td:eq(1)");AY["xyName"]=AV.find("input.column").val();AY["xyNameValueType"]=AV.find("select").val();var AU=$(this).find("td:eq(2)");AY["xColumn"]=AU.find("input.column").val();AY["xColumnValueType"]=AU.find("select").val();var AT=$(this).find("td:eq(3)");AY["yColumn"]=AT.find("input.column").val();AY["yColumnValueType"]=AT.find("select").val();var AR=$(this).find("td:eq(4)");AY["value"]=AR.find("input.column").val();AY["valueValueType"]=AR.find("select").val();var AQ=$(this).find("td:eq(5)");var AS=AQ.find("a").data("serie");AY["label"]=AS.label;AY.color=AS.color;AY.opacity=AS.opacity;AY.shadowBlur=AS.shadowBlur;AY.shadowColor=AS.shadowColor;AY.shadowOpacity=AS.shadowOpacity;if(AS.marklines!=undefined){AY.marklines=AS.marklines}if(AS.barMaxWidth!=undefined){AY.barMaxWidth=AS.barMaxWidth}AO.push(AY)});AP["series"]=AO;F["series"]=AP};var AJ=function(){var AP={};var AO=new Array();var AN=$("#win-chart-setting-data-scatterxy").find("table.tb-all");AN.find("tr:gt(1)").each(function(AS){var AV={};var AU=$(this).find("td:eq(0)");AV["name"]=AU.find("input").val();AV["nameValueType"]=AU.find("select").val();var AT=$(this).find("td:eq(1)");AV["xColumn"]=AT.find("input.column").val();AV["xColumnValueType"]=AT.find("select").val();var AR=$(this).find("td:eq(2)");AV["yColumn"]=AR.find("input.column").val();AV["yColumnValueType"]=AR.find("select").val();var AQ=$(this).find("td:eq(3)");var AW=AQ.find("a").data("serie");if(AW!=undefined){AV["label"]=AW.label;AV.color=AW.color;AV.opacity=AW.opacity;AV.shadowBlur=AW.shadowBlur;AV.shadowColor=AW.shadowColor;AV.shadowOpacity=AW.shadowOpacity;if(AW.marklines!=undefined){AV.marklines=AW.marklines}if(AW.barMaxWidth!=undefined){AV.barMaxWidth=AW.barMaxWidth}}AO.push(AV)});AP["series"]=AO;F["series"]=AP};var T=function(){var AR={};var AV=new Array();var AN=$("#win-chart-setting-data-percent").find("table.tb-all");var AW={};var AX=AN.find("tr:eq(1)");var AT=AX.find("td:eq(0)");AW["name"]=AT.find("input.column").val();AW["nameValueType"]=AT.find("select").val();var AS=AX.find("td:eq(1)");AW["value"]=AS.find("input.column").val();AW["valueValueType"]=AS.find("select").val();var AQ=AX.find("td:eq(2)");AW["total"]=AQ.find("input.column").val();AW["totalValueType"]=AQ.find("select").val();var AP=AX.find("td:eq(3)");var AO=AP.find("a").data("serie");AW["label"]=AO.label;AW.color=AO.color;AW.opacity=AO.opacity;AW.color1=AO.color1;AW.shadowBlur=AO.shadowBlur;AW.shadowColor=AO.shadowColor;AW.shadowOpacity=AO.shadowOpacity;if(AO.barMaxWidth!=undefined){AW.barMaxWidth=AO.barMaxWidth}AV.push(AW);var AU=AN.find("tr:eq(2)");AR.rowCount=AU.find("input").val();AR["series"]=AV;F["series"]=AR};var K=function(){var AP=new Array();var AQ={};var AO=$("#win-chart-setting-data-gauge").find("table.tb-all");AO.find("tr:gt(1)").each(function(AU){var AX={};var AW=$(this).find("td:eq(0)");AX["name"]=AW.find("input").val();AX["nameValueType"]=AW.find("select").val();var AV=$(this).find("td:eq(1)");AX["value"]=AV.find("input.column").val();AX["valueValueType"]=AV.find("select").val();var AT=$(this).find("td:eq(2)");var AY=AT.find("a").data("serie");AX["label"]=AY.label;AP.push(AX)});var AN=$("#win-chart-setting-series-gauge").find("tr:eq(1)");var AS=AN.find("input").val();AQ["gap"]=AS!=""?AS:1;var AR=$("#win-chart-setting-series-gauge").find("tr:eq(2)");AQ["unitName"]=AR.find("input").val();AQ["series"]=AP;F["series"]=AQ};var e=function(){var AO=new Array();var AQ={};var AS=$("#win-chart-setting-data-map").find("div:eq(0)");AQ["column"]=AS.find("input[name=serieName]").val();AQ["columnValueType"]=AS.find("select").val();var AN=$("#win-chart-setting-data-map").find("table.tb-all:eq(0)");AN.find("tr:gt(1)").each(function(AU){var AX={};var AW=$(this).find("td:eq(0)");AX["name"]=AW.find("input").val();AX["nameValueType"]=AW.find("select").val();var AV=$(this).find("td:eq(1)");AX["value"]=AV.find("input.column").val();AX["valueValueType"]=AV.find("select").val();var AT=$(this).find("td:eq(2)");var AY=AT.find("a").data("serie");AX["label"]=AY.label;AX.color=AY.color;AX.opacity=AY.opacity;AX.shadowBlur=AY.shadowBlur;AX.shadowColor=AY.shadowColor;AX.shadowOpacity=AY.shadowOpacity;AO.push(AX)});AQ["series"]=AO;F["series"]=AQ;if(d==130){var AP=F["map"]?F["map"]:{};var AR={};var AN=$("#win-chart-setting-data-map-world-mp").children("table");AN.find("tr:gt(0)").each(function(){var AT=$(this).find("input").val();var AU=$.trim($(this).find("td:eq(1)").text());AR[AU]=AT});AP.nameMap=AR;F.map=AP}};var AA=function(){var AU=F.chart?F.chart:{};var Ah=$("#win-chart-setting-chart").find("tr:eq(1)");var Aj=Ah.find("input").val();if(Aj!=""){AU["borderWidth"]=Aj}var Ag=$("#win-chart-setting-chart").find("tr:eq(2)");var AV=Ag.find("input").spectrum("get");if(AV!=null){AU["borderColor"]="#"+AV.toHex(false)}else{AU["borderColor"]=undefined}var Ae=$("#win-chart-setting-chart").find("tr:eq(3)");var AT=Ae.find("input").val();AU["borderOpacity"]=AT!=""?AT:undefined;var Ad=$("#win-chart-setting-chart").find("tr:eq(4)");var AO=Ad.find("input").val();if(AO!="10"){AU["borderRadius"]=AO}var Ab=$("#win-chart-setting-chart").find("tr:eq(5)");var Af=Ab.find("input").spectrum("get");if(Af!=null){AU["backgroundColor"]="#"+Af.toHex(false)}else{AU["backgroundColor"]=undefined}var Aa=$("#win-chart-setting-chart").find("tr:eq(6)");var AS=Aa.find("input").val();AU["bgOpacity"]=AS!=""?AS:undefined;var AZ=$("#win-chart-setting-chart").find("tr:eq(7)");var AW=AZ.find("input").val();if(AW!=""){AU["marginLeft"]=AW}else{AU["marginLeft"]=undefined}var AY=$("#win-chart-setting-chart").find("tr:eq(8)");var AP=AY.find("input").val();if(AP!=""){AU["marginTop"]=AP}else{AU["marginTop"]=undefined}var AX=$("#win-chart-setting-chart").find("tr:eq(9)");var AQ=AX.find("input").val();if(AQ!=""){AU["marginRight"]=AQ}else{AU["marginRight"]=undefined}var Ak=$("#win-chart-setting-chart").find("tr:eq(10)");var AR=Ak.find("input").val();if(AR!=""){AU["marginBottom"]=AR}else{AU["marginBottom"]=undefined}var Ai=$("#win-chart-setting-chart").find("tr:eq(11)");var Ac=Ai.find("input").val();if(Ac!=""&&Ac!="0"){var AN={};AN["interval"]=Ac;AN["timeType"]=Ai.find("select").val();AU["asyncData"]=AN}F["chart"]=AU};var C=function(){var AV=F.title?F.title:{};var AT={};var AR=$("#win-chart-setting-title").find("tr:eq(1)");AV["enabled"]=AR.find("input").is(":checked");var AQ=$("#win-chart-setting-title").find("tr:eq(2)");AV["text"]=AQ.find("input").val();AV.textValueType=AQ.find("select").val();var AP=$("#win-chart-setting-title").find("tr:eq(3)");AV["textStyle"]=anyExcel.getTextStyle(AP);var AO=$("#win-chart-setting-title").find("tr:eq(4)");var AU=AO.find("input.color-select").spectrum("get");if(AU!=null){AV["backgroundColor"]="#"+AU.toHex(false)}else{AV["backgroundColor"]=undefined}var AN=$("#win-chart-setting-title").find("tr:eq(5)");var AS=AN.find("select").val();if(AS!="center"){AV.align=AS}else{AV.align="center"}F["title"]=AV};var P=function(){var Aa=F.tooltip?F.tooltip:{};var AW=$("#win-chart-setting-tooltip").find("tr:eq(1)");Aa["enabled"]=AW.find("input").is(":checked");var AV=$("#win-chart-setting-tooltip").find("tr:eq(2)");Aa["format"]=AV.find("select.selectpicker").val();var AU=$("#win-chart-setting-tooltip").find("tr:eq(3)");var AY=AU.find("input").val();if(AY!=""){Aa["padding"]=AY}var AT=$("#win-chart-setting-tooltip").find("tr:eq(4)");var AZ=AT.find("input.color-select").spectrum("get");if(AZ!=null){Aa["borderColor"]="#"+AZ.toHex(false)}else{Aa["borderColor"]=undefined}var AS=$("#win-chart-setting-tooltip").find("tr:eq(5)");var AN=AS.find("input").val();if(AN!=""){Aa["borderWidth"]=AN}var AR=$("#win-chart-setting-tooltip").find("tr:eq(6)");var AQ=AR.find("input").val();if(AQ!=""){Aa["borderRadius"]=AQ}var AP=$("#win-chart-setting-tooltip").find("tr:eq(7)");var AX=AP.find("input.color-select").spectrum("get");if(AX!=null){Aa["backgroundColor"]="#"+AX.toHex(false)}else{Aa["backgroundColor"]=undefined}var AO=$("#win-chart-setting-tooltip").find("tr:eq(8)");Aa["textStyle"]=anyExcel.getTextStyle(AO);F["tooltip"]=Aa};var z=function(){var AV=F.legend?F.legend:{};var AT=$("#win-chart-setting-legend").find("tr:eq(1)");AV["enabled"]=AT.find("input").is(":checked");var AS=$("#win-chart-setting-legend").find("tr:eq(2)");AV["layout"]=AS.find("select.selectpicker").val();var AR=$("#win-chart-setting-legend").find("tr:eq(3)");AV["align"]=AR.find("select.selectpicker").val();var AQ=$("#win-chart-setting-legend").find("tr:eq(4)");AV["verticalAlign"]=AQ.find("select.selectpicker").val();var AP=$("#win-chart-setting-legend").find("tr:eq(5)");var AN=AP.find("input").val();if(AN!=""){AV["itemGap"]=AN}var AU={};var AO=$("#win-chart-setting-legend").find("tr:eq(6)");AV["textStyle"]=anyExcel.getTextStyle(AO);F["legend"]=AV};var b=function(BA,AZ){var Av={};Av["defaultEnabled"]=true;Av["enabled"]=true;var A0=BA.find("tr:eq(1)");Av["rotation"]=A0.find("select.selectpicker").val();var AO={};var Ay=BA.find("tr:eq(2)");Av["textStyle"]=anyExcel.getTextStyle(Ay);var Aw=BA.find("tr:eq(3)");Av["format"]=Aw.find("select.selectpicker").val();AZ["label"]=Av;var Ao={};var Au=BA.find("tr:eq(5)");Ao["enabled"]=Au.find("input").is(":checked");var At=BA.find("tr:eq(6)");Ao["rotation"]=At.find("select.selectpicker").val();var As=BA.find("tr:eq(7)");var Ag=As.find("input").val();if(Ag!=""){Ao["text"]=Ag}var AV={};var Ar=BA.find("tr:eq(8)");Ao["textStyle"]=anyExcel.getTextStyle(Ar);AZ["title"]=Ao;var BB=BA.find("tr:eq(10)");AZ.axisEnabled=BB.find("input").is(":checked");var A9=BA.find("tr:eq(11)");var Ab=A9.find("select.selectpicker").val();AZ["type"]=Ab;var A7=BA.find("tr:eq(12)");var BC=A7.find("input").val();if(BC!=""){AZ["min"]=BC}var A6=BA.find("tr:eq(13)");var Aa=A6.find("input").val();if(Aa!=""){AZ["max"]=Aa}var A5=BA.find("tr:eq(14)");var Ap=A5.find("input").val();if(Ap!=""){AZ["step"]=Ap}var A4=BA.find("tr:eq(15)");var Aj=A4.find("select.selectpicker").val();if(Aj!=""){AZ["format"]=Aj}var A3=BA.find("tr:eq(16)");var AY=A3.find("input").val();if(AY!=""){AZ["timeTnterval"]=AY}var AQ=A3.find("select.selectpicker").val();AZ["intervalUnit"]=AQ;var A1=BA.find("tr:eq(17)");var AS=A1.find("input").val();if(AS!=""){AZ["timeSpan"]=AS}var A8=A1.find("select.selectpicker").val();AZ["timeSpanFormat"]=A8;var Az=BA.find("tr:eq(18)");var Ah=Az.find("input.color-select").spectrum("get");if(Ah!=null){AZ["lineColor"]="#"+Ah.toHex(false)}else{AZ["lineColor"]=undefined}var Ax=BA.find("tr:eq(19)");var AW=Ax.find("input").val();if(AW!=""){AZ["lineWidth"]=AW}var Am=BA.find("tr:eq(20)");var AP=Am.find("input.color-select").spectrum("get");if(AP!=null){AZ["tickColor"]="#"+AP.toHex(false)}else{AZ["tickColor"]=undefined}var Al=BA.find("tr:eq(21)");var Aq=Al.find("input").val();if(Aq!=""){AZ["tickLength"]=Aq}var Ak=BA.find("tr:eq(22)");var A2=Ak.find("input").val();if(A2!=""){AZ["tickWidth"]=A2}var Ai=BA.find("tr:eq(24)");AZ.splitLineEnabled=Ai.find("input").is(":checked");var Af=BA.find("tr:eq(25)");AZ.splitLineType=Af.find("select").val();var Ae=BA.find("tr:eq(26)");var An=Ae.find("input.color-select").spectrum("get");if(An!=null){AZ["splitLineColor"]="#"+An.toHex(false)}else{AZ["splitLineColor"]=undefined}var Ad=BA.find("tr:eq(27)");var AU=Ad.find("input").val();if(AU!=""){AZ["splitLineWidth"]=AU}var Ac=BA.find("tr:eq(29)");AZ.dataZoomEnabled=Ac.find("input").is(":checked");var AT=BA.find("tr:eq(30)");var AX=AT.find("input").val();if(AX!=""){AZ.zoomStart=AX}var AR=BA.find("tr:eq(31)");var AN=AR.find("input").val();if(AN!=""){AZ.zoomEnd=AN}};var p=function(AR){var Ac={};var AW=$("#win-chart-setting-radar").find("tr:eq(1)");Ac["enabled"]=AW.find("input").is(":checked");var AV=$("#win-chart-setting-radar").find("tr:eq(2)");Ac["rotation"]=AV.find("select.selectpicker").val();var AY={};var AT=$("#win-chart-setting-radar").find("tr:eq(3)");Ac["textStyle"]=anyExcel.getTextStyle(AT);var AS=$("#win-chart-setting-radar").find("tr:eq(4)");Ac["format"]=AS.find("select.selectpicker").val();AR["label"]=Ac;var AQ=$("#win-chart-setting-radar").find("tr:eq(6)");var Ab=AQ.find("input.color-select").spectrum("get").toHex(false);if(Ab!="ffffff"){AR["lineColor"]="#"+Ab}else{AR["lineColor"]="#ffffff"}var AP=$("#win-chart-setting-radar").find("tr:eq(7)");var AX=AP.find("input").val();if(AX!="lineWidth"){AR["lineWidth"]=AX}var AO=$("#win-chart-setting-radar").find("tr:eq(8)");var Ad=AO.find("input.color-select").spectrum("get").toHex(false);if(Ad!="ffffff"){AR["tickColor"]="#"+Ad}else{AR["tickColor"]="#ffffff"}var AN=$("#win-chart-setting-radar").find("tr:eq(9)");var Aa=AN.find("input").val();if(Aa!=""){AR["tickLength"]=Aa}var AU=$("#win-chart-setting-radar").find("tr:eq(10)");var AZ=AU.find("input").val();if(AZ!=""){AR["tickWidth"]=AZ}};var AC=function(AP){var AU=$("#win-chart-setting-gauge");var AS={};var AQ={};var Ad=AU.find("tr:eq(1)");AS["textStyle"]=anyExcel.getTextStyle(Ad);var Ac=AU.find("tr:eq(2)");AS["format"]=Ac.find("select.selectpicker").val();AP["label"]=AS;var Ab=AU.find("tr:eq(4)");AP["min"]=Ab.find("input").val();var Aa=AU.find("tr:eq(5)");AP["max"]=Aa.find("input").val();var AZ=AU.find("tr:eq(6)");AP["tickGap"]=AZ.find("input").val();var AX=AU.find("tr:eq(7)");var AY="";AX.find("input.color-select").each(function(){var Ag=$(this).spectrum("get").toHex(false);if(Ag!="ffffff"){AY+="#"+Ag}else{AY+="#ffffff"}AY+=","});AP["lineColor"]=AY;var AW=AU.find("tr:eq(8)");var AN=AW.find("input").val();if(AN!="lineWidth"){AP["lineWidth"]=AN}var AV=AU.find("tr:eq(9)");var AT=AV.find("input.color-select").spectrum("get").toHex(false);if(AT!="ffffff"){AP["tickColor"]="#"+AT}else{AP["tickColor"]="#ffffff"}var Af=AU.find("tr:eq(10)");var AO=Af.find("input").val();if(AO!=""){AP["tickLength"]=AO}var Ae=AU.find("tr:eq(11)");var AR=Ae.find("input").val();if(AR!=""){AP["tickWidth"]=AR}};var y=function(){var Aj=F.map?F.map:{};var Ac=$("#win-chart-setting-map").find("table:eq(0)");var Av=Ac.find("tr:eq(0)");Aj.areaLabelEnable=Av.find("input").is(":checked");var AO={};var Au=Ac.find("tr:eq(1)");Aj.textStyle=anyExcel.getTextStyle(Au);var At=Ac.find("tr:eq(2)");var AS=At.find("input.color-select").spectrum("get");if(AS!=null){Aj["areaColor"]="#"+AS.toHex(false)}else{Aj["areaColor"]="#eeeeee"}var As=Ac.find("tr:eq(3)");var Aa=As.find("input").val();if(Aa!=""){Aj.areaLineWidth=Aa}var Ar=Ac.find("tr:eq(4)");var A4=Ar.find("input.color-select").spectrum("get");if(A4!=null){Aj["areaLineColor"]="#"+A4.toHex(false)}else{Aj["areaLineColor"]="#444444"}var Aq=Ac.find("tr:eq(5)");Aj.roam=Aq.find("input").is(":checked");var Ap=Ac.find("tr:eq(6)");if(Ap.find("input").val()!=""){Aj.zoom=Ap.find("input").val()}var Ao=Ac.find("tr:eq(8)");Aj.visualEnabled=Ao.find("input").is(":checked");var An=Ac.find("tr:eq(9)");var AV=An.find("input.color-select").spectrum("get");if(AV!=null){Aj["visualStartColor"]="#"+AV.toHex(false)}else{Aj["visualStartColor"]="#007de4"}var A2=Ac.find("tr:eq(10)");var AT=A2.find("input.color-select").spectrum("get");if(AT!=null){Aj["visualMidColor"]="#"+AT.toHex(false)}else{Aj["visualMidColor"]=undefined}var A1=Ac.find("tr:eq(11)");var AW=A1.find("input.color-select").spectrum("get");if(AW!=null){Aj["visualEndColor"]="#"+AW.toHex(false)}else{Aj["visualEndColor"]="#007de4"}var A0=Ac.find("tr:eq(12)");Aj["orient"]=A0.find("select").val();var Az=Ac.find("tr:eq(13)");Aj["left"]=Az.find("select").val();var Ay=Ac.find("tr:eq(14)");Aj["top"]=Ay.find("select").val();if(d==127){var Ak=$("#win-chart-setting-map").find("table.gis");var Ag=Ak.find("tr:eq(1)");var Aw=Ag.find("input").val();if(Aw!=""){Aj["zoom"]=Aw}var Af=Ak.find("tr:eq(2)");var Am=Af.find("input").val();if(Am!=""){Aj.pos=Am}var Ae=Ak.find("tr:eq(3)");var AU=Ae.find("input").val();if(AU!=""){Aj.key=AU}var Ad=Ak.find("tr:eq(4)");var Ax=Ad.find("input.color-select").spectrum("get");if(Ax!=null){Aj["waterColor"]="#"+Ax.toHex(false)}else{Aj["waterColor"]=undefined}var Ab=Ak.find("tr:eq(5)");var Ah=Ab.find("input.color-select").spectrum("get");if(Ah!=null){Aj["landColor"]="#"+Ah.toHex(false)}else{Aj["landColor"]=undefined}var AZ=Ak.find("tr:eq(6)");var AP=AZ.find("input.color-select").spectrum("get");if(AP!=null){Aj["boundaryColor"]="#"+AP.toHex(false)}else{Aj["boundaryColor"]=undefined}var AY=Ak.find("tr:eq(7)");var Ai=AY.find("input.color-select").spectrum("get");if(Ai!=null){Aj["boundaryFillColor"]="#"+Ai.toHex(false)}else{Aj["boundaryFillColor"]=undefined}}var AR=new Array();var A3=$("#win-chart-setting-map").find("table.scatter");A3.find("tr:gt(1)").each(function(){var BB={};var BA=$(this).find("td:eq(0)");var BD=BA.find("input").val();if(BD!=""){BB.size=BD}var A9=$(this).find("td:eq(1)");BB.type=A9.find("select").val();var A7=$(this).find("td:eq(2)");BB.sortType=A7.find("select").val();BB.sortNum=A7.find("input").val();var A6=$(this).find("td:eq(3)");var BC=A6.find("input").spectrum("get");if(BC!=null){BB.color="#"+BC.toHex(false)}else{BB.color=undefined}var A5=$(this).find("td:eq(4)");var A8=A5.find("a").data("scatterLabel");if(A8!=undefined){BB.scatterLabel=A8}AR.push(BB)});Aj.serieScatters=AR;var Al=$("#win-chart-setting-map-pos").find("table");var AX=new Array();Al.find("tr:gt(1)").each(function(){var A7={};var A6=$(this).find("td:eq(0)");A7.pos=A6.find("input").val();var A5=$(this).find("td:eq(1)");A7.name=A5.find("input").val();AX.push(A7)});Aj.items=AX;var AN=$("#win-chart-setting-map-moveline").find("table");var AQ=new Array();AN.find("tr:gt(1)").each(function(){var A5={};var A7=$(this).find("td:eq(0)");A5.fromName=A7.find("input").val();var A6=$(this).find("td:eq(1)");A5.toName=A6.find("input").val();AQ.push(A5)});if(AQ.length>0){Aj.movelines=AQ}F.map=Aj};var AM=function(){var AQ=F.styleMap?F.styleMap:{};var AR=$("#win-chart-setting-style-map").find("table:eq(0)");var AO=new Array();AR.find("tr:gt(1)").each(function(){var AU={};var AT=$(this).find("td:eq(0)");AU.key=AT.find("input").val();var AS=$(this).find("td:eq(1)");AU.data=AS.find("textarea").val();AO.push(AU)});AQ.data=AO;var AP=$("#win-chart-setting-style-map").find("table:eq(1)");var AN=new Array();AP.find("tr:gt(1)").each(function(){var AU={};var AT=$(this).find("td:eq(0)");AU.pos=AT.find("input").val();var AS=$(this).find("td:eq(1)");AU.name=AS.find("input").val();AN.push(AU)});AQ.items=AN;F.styleMap=AQ};var AG=function(AN,AO,AP){AN.find("select.selectpicker").change(function(){var AQ=$(this).val();AN.find("a.only-a").unbind("click");if(AQ==0){AN.find("i").removeClass("icon-down").removeClass("icon-ichanshu24px").addClass("icon-collect");AN.find("a.only-a").bind("click",columnSelectHandler)}else{if(AQ==1){AN.find("i").removeClass("icon-collect").removeClass("icon-ichanshu24px").addClass("icon-down");AN.find("a.only-a").bind("click",cellSelectHandler)}else{AN.find("i").removeClass("icon-collect").removeClass("icon-down").addClass("icon-ichanshu24px");AN.find("a.only-a").bind("click",fxInputSelectHandler)}}AN.find("input[type=text]").val("")});if(AP!=undefined){AN.find("select.selectpicker").selectpicker("val",AP)}else{if(AO!=""&&AO.indexOf(".")==-1){AN.find("select.selectpicker").selectpicker("val",1)}else{AN.find("select.selectpicker").selectpicker("val",0)}}AN.find("select.selectpicker").trigger("change");AN.find("input[name=serieName]").val(AO)};var Y=function(AN,AO,AP){AN.find("select").change(function(){var AQ=$(this).val();AN.find("a.only-a").unbind("click");if(AQ==0){AN.find("i").removeClass("icon-down").removeClass("icon-ichanshu24px").addClass("icon-collect");AN.find("a.only-a").bind("click",columnSelectHandler)}else{if(AQ==1){AN.find("i").removeClass("icon-collect").removeClass("icon-ichanshu24px").addClass("icon-down");AN.find("a.only-a").bind("click",cellSelectHandler)}else{AN.find("i").removeClass("icon-collect").removeClass("icon-down").addClass("icon-ichanshu24px");AN.find("a.only-a").bind("click",fxInputSelectHandler)}}AN.find("input[type=text]").val("")});if(AP!=undefined){AN.find("select").selectpicker("val",AP)}else{if(AO!=""&&AO.indexOf(".")==-1){AN.find("select").selectpicker("val",1)}else{AN.find("select").selectpicker("val",0)}}AN.find("select").trigger("change");AN.find("input[type=text]").val(AO)};var AI=function(AN,AO,AP){AN.find("select").change(function(){var AQ=$(this).val();AN.find("a.only-a").unbind("click");if(AQ==0){AN.find("a.only-a").show();AN.find("i").removeClass("icon-down").removeClass("icon-ichanshu24px").addClass("icon-collect");AN.find("a.only-a").bind("click",columnSelectHandler)}else{if(AQ==1){AN.find("a.only-a").show();AN.find("i").removeClass("icon-collect").removeClass("icon-ichanshu24px").addClass("icon-down");AN.find("a.only-a").bind("click",cellSelectHandler)}else{if(AQ==3){AN.find("a.only-a").show();AN.find("i").removeClass("icon-collect").removeClass("icon-down").addClass("icon-ichanshu24px");AN.find("a.only-a").bind("click",fxInputSelectHandler)}else{AN.find("a.only-a").hide()}}}AN.find("input[type=text]").val("")});if(AP!=undefined){AN.find("select").selectpicker("val",AP)}else{if(AO.startsWith("=")){AN.find("a.only-a").show();if(AO.indexOf(".")!=-1){AN.find("select").selectpicker("val",0)}else{AN.find("select").selectpicker("val",1)}}else{AN.find("a.only-a").hide();AN.find("select").selectpicker("val",2)}}AN.find("select").trigger("change");AN.find("input[type=text]").val(AO)};var t=function(AN,AP,AO){AN.find("select").change(function(){var AQ=$(this).val();AN.find("a.only-a").unbind("click");if(AQ==1){AN.find("a.only-a").show();AN.find("a.only-a").unbind("click").bind("click",fxInputSelectHandler)}else{AN.find("a.only-a").hide()}AN.find("input[type=text]").val("")});if(AO!=undefined){AN.find("select").selectpicker("val",AO)}else{AN.find("select").selectpicker("val",0)}AN.find("select").trigger("change");AN.find("input[type=text]").val(AP)};var A=function(AO){var AN=$("#win-chart-setting-style").find("table:eq(1)");var AP=new Array();AN.find("tr:gt(1)").each(function(){var AV={};var AS=$(this).find("td:eq(0)").find("select");AV.valueType=AS.val();var AW=$(this).find("td:eq(1)").find("input").val();if(AW!=""){AV.value=AW}var AX=$(this).find("td:eq(2)");var AT=AX.find("input").spectrum("get").toHex(false);if(AT!="ffffff"){AV.color="#"+AT}var AR=$(this).find("td:eq(3)").find("input").val();if(AR!=""){AV.width=AR}var AQ=$(this).find("td:eq(4)").find("select");AV.lineStyle=AQ.val();var AU=$(this).find("td:eq(5)").find("input").val();if(AU!=""){AV.name=AU}AP.push(AV)});if(AP.length>0){AO.marklines=AP}};var AB=function(AN,AO){AN.find("a").data("serie",AO);AN.find("a").unbind("click").click(function(){var AQ=$(this);var AR=$(this).data("serie")?$(this).data("serie"):{};var AP=AR.label?AR.label:{};layer.open({type:1,title:"系列样式",zIndex:1025,shadeClose:true,shade:false,area:["600px","380px"],content:$("#win-chart-setting-style"),btn:["确定","取消"],yes:function(AU){var Ah={};Ah.defaultEnabled=AP.defaultEnabled;var Ab=$("#win-chart-setting-style").find("table:eq(0)");var Ag=Ab.find("tr:eq(1)");Ah["enabled"]=Ag.find("input").is(":checked");var Af=Ab.find("tr:eq(2)");Ah["nameEnabled"]=Af.find("input").is(":checked");var Ae=Ab.find("tr:eq(3)");Ah["format"]=Ae.find("select").val();var Ad=Ab.find("tr:eq(4)");Ah["textStyle"]=anyExcel.getTextStyle(Ad);var Ac=Ab.find("tr:eq(5)");var Ak=Ac.find("select").val();if(Ak!=""){Ah.position=Ak}var Aa=Ab.find("tr:eq(6)");var AV=Aa.find("input.color-select").spectrum("get");if(AV!=null){AR["color"]="#"+AV.toHex(false)}else{AR["color"]=undefined}var AZ=Ab.find("tr:eq(7)");AR["opacity"]=AZ.find("input").val();var AY=Ab.find("tr:eq(8)");var AT=AY.find("input.color-select").spectrum("get");if(AT!=null){AR["color1"]="#"+AT.toHex(false)}else{AR["color1"]=undefined}var AW=Ab.find("tr:eq(9)");AR.shadowBlur=AW.find("input").val();var Al=Ab.find("tr:eq(10)");var AS=Al.find("input.color-select").spectrum("get");if(AS!=null){AR.shadowColor="#"+AS.toHex(false)}else{AR.shadowColor=undefined}var Aj=Ab.find("tr:eq(11)");AR.shadowOpacity=Aj.find("input").val();if(l()){var Ai=Ab.find("tr:eq(12)");AR.barMaxWidth=Ai.find("input").val()}if(d==Constant.SUNBURST_DONUT){AR.sunburstRadio=Ab.find("tr.sunburstRadio").find("input").val()}if(AR.type=="pie"||AR.type=="donut"||AR.type=="rose"){var AX=Ab.find("tr.pie");AR.centerX=$(AX[0]).find("input:eq(0)").val();AR.centerY=$(AX[0]).find("input:eq(1)").val();AR.radius=$(AX[1]).find("input").val()}AR.label=Ah;A(AR);layer.close(AU)},success:function(){G(AR)}})})};var d=F["chartType"];var J=(d==17||d==50)?"860px":"700px";formIdx=layer.open({type:1,title:"图表设置",zIndex:1025,shadeClose:true,shade:false,area:[J,"480px"],content:$("#win-chart-setting"),btn:["确定","取消"],yes:function(AP){switch(d){case 1:case 2:case 3:case 4:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 5:case 105:case 6:AF();AA();C();P();z();var AR={};b($("#win-chart-setting-xaxis"),AR);var AO={};b($("#win-chart-setting-yaxis"),AO);F["xAxis"]=AR;F["yAxis"]=AO;break;case 17:Z();AA();C();P();z();var AR={};b($("#win-chart-setting-xaxis"),AR);var AO={};b($("#win-chart-setting-yaxis"),AO);F["xAxis"]=AR;F["yAxis"]=AO;break;case 18:AJ();AA();C();P();z();var AR={};b($("#win-chart-setting-xaxis"),AR);var AO={};b($("#win-chart-setting-yaxis"),AO);F["xAxis"]=AR;F["yAxis"]=AO;break;case 7:case 8:case 9:case 19:case 20:case 21:case 22:case 45:V();AA();C();P();z();break;case 27:case 28:case 29:AH();AA();C();P();z();var AR={};b($("#win-chart-setting-xaxis"),AR);var AO={};b($("#win-chart-setting-yaxis"),AO);var AN={};b($("#win-chart-setting-rightyaxis"),AN);F["xAxis"]=AR;F["yAxis"]=AO;F["yRightAxis"]=AN;break;case 23:case 24:AF();AA();C();P();z();var AQ={};p(AQ);F["axis"]=AQ;break;case 25:K();AA();C();var AQ={};AC(AQ);F["axis"]=AQ;break;case 30:T();AA();C();z();break;case 31:T();AA();C();z();var AO={};b($("#win-chart-setting-yaxis"),AO);F["yAxis"]=AO;break;case 26:case 126:case 130:e();AA();C();P();z();y();break;case 128:case 127:e();AA();C();P();z();y();AM();break;case 40:R();AA();C();P();z();var AR={};b($("#win-chart-setting-xaxis"),AR);var AO={};b($("#win-chart-setting-yaxis"),AO);F["xAxis"]=AR;F["yAxis"]=AO;break;case 50:case 51:case 55:case 56:g();AA();C();P();break;case 60:H();AA();C();P();z();var AR={};b($("#win-chart-setting-xaxis"),AR);var AO={};b($("#win-chart-setting-yaxis"),AO);F["xAxis"]=AR;F["yAxis"]=AO;break}layer.close(AP)},success:function(){o();var AN=$("#win-chart-setting-type");AN.find("li").hide();var AO=F["chartType"];$("#win-chart-setting").find("div.tab-content").children().removeClass("active in");$("#win-chart-setting-type").children().removeClass("active");switch(AO){case 1:case 2:case 3:case 4:case 10:case 11:case 12:case 13:AN.find("li.win-chart-setting-series-pie").show();$("#win-chart-setting-series-pie").find("tr:gt(0)").hide();$("#win-chart-setting-series-pie").find("tr.barAttr").show();case 14:case 15:case 16:case 5:case 105:case 6:AN.find("li.win-chart-setting-data").show().addClass("active");$("#win-chart-setting-data").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-xaxis").show();AN.find("li.win-chart-setting-yaxis").show();AE();O();S();AK();N();L($("#win-chart-setting-xaxis"),"xAxis");L($("#win-chart-setting-yaxis"),"yAxis");break;case 17:AN.find("li.win-chart-setting-data-xy").show().addClass("active");$("#win-chart-setting-data-xy").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-xaxis").show();AN.find("li.win-chart-setting-yaxis").show();s();O();S();AK();N();L($("#win-chart-setting-xaxis"),"xAxis");L($("#win-chart-setting-yaxis"),"yAxis");break;case 18:AN.find("li.win-chart-setting-data-scatterxy").show().addClass("active");$("#win-chart-setting-data-scatterxy").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-xaxis").show();AN.find("li.win-chart-setting-yaxis").show();j();O();S();AK();N();L($("#win-chart-setting-xaxis"),"xAxis");L($("#win-chart-setting-yaxis"),"yAxis");break;case 7:case 8:case 9:case 19:case 20:case 21:case 22:case 45:AN.find("li.win-chart-setting-data-pie").show().addClass("active");$("#win-chart-setting-data-pie").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-series-pie").show();$("#win-chart-setting-series-pie").find("tr:gt(0)").hide();$("#win-chart-setting-series-pie").find("tr.pieAttr").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-legend").show();B();O();S();AK();N();break;case 27:case 28:case 29:AN.find("li.win-chart-setting-data-columnLine").show().addClass("active");$("#win-chart-setting-data-columnLine").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-xaxis").show();AN.find("li.win-chart-setting-yaxis").show();AN.find("li.win-chart-setting-rightyaxis").show();AN.find("li.win-chart-setting-series-pie").show();$("#win-chart-setting-series-pie").find("tr:gt(0)").hide();$("#win-chart-setting-series-pie").find("tr.barAttr").show();I();O();S();AK();N();L($("#win-chart-setting-xaxis"),"xAxis");L($("#win-chart-setting-yaxis"),"yAxis");L($("#win-chart-setting-rightyaxis"),"yRightAxis");break;case 23:case 24:AN.find("li.win-chart-setting-data").show().addClass("active");$("#win-chart-setting-data").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-radar").show();AE();O();S();AK();N();AD();break;case 25:AN.find("li.win-chart-setting-data-gauge").show().addClass("active");$("#win-chart-setting-data-gauge").addClass("active in");AN.find("li.win-chart-setting-series-gauge").show();AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-gauge").show();k();O();S();E();break;case 30:AN.find("li.win-chart-setting-data-percent").show().addClass("active");$("#win-chart-setting-data-percent").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-legend").show();u();O();S();N();break;case 31:AN.find("li.win-chart-setting-data-percent").show().addClass("active");$("#win-chart-setting-data-percent").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-yaxis").show();u();O();S();N();L($("#win-chart-setting-yaxis"),"yAxis");break;case 26:case 126:case 130:AN.find("li.win-chart-setting-data-map").show().addClass("active");$("#win-chart-setting-data-map").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-map").show();AN.find("li.win-chart-setting-map-moveline").show();AN.find("li.win-chart-setting-map-pos").show();M();O();S();AK();N();U();break;case 128:case 127:AN.find("li.win-chart-setting-data-map").show().addClass("active");$("#win-chart-setting-data-map").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-map").show();AN.find("li.win-chart-setting-style-map").show();AN.find("li.win-chart-setting-map-moveline").show();M();O();S();AK();N();U();Q();break;case 40:AN.find("li.win-chart-setting-data-gantt").show().addClass("active");$("#win-chart-setting-data-gantt").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-xaxis").show();AN.find("li.win-chart-setting-yaxis").show();m();O();S();AK();N();L($("#win-chart-setting-xaxis"),"xAxis");L($("#win-chart-setting-yaxis"),"yAxis");break;case 50:case 51:case 55:case 56:AN.find("li.win-chart-setting-data-tree").show().addClass("active");$("#win-chart-setting-data-tree").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();w();O();S();AK();break;case 60:AN.find("li.win-chart-setting-data-multi").show().addClass("active");$("#win-chart-setting-data-multi").addClass("active in");AN.find("li.win-chart-setting-chart").show();AN.find("li.win-chart-setting-title").show();AN.find("li.win-chart-setting-tooltip").show();AN.find("li.win-chart-setting-legend").show();AN.find("li.win-chart-setting-xaxis").show();AN.find("li.win-chart-setting-yaxis").show();f();O();S();AK();N();L($("#win-chart-setting-xaxis"),"xAxis");L($("#win-chart-setting-yaxis"),"yAxis");break}}});function c(){return d==Constant.COLUMN||d==Constant.COLUMN_DIFF||d==Constant.STACKED_COLUMN||d==Constant.LINE||d==Constant.LINE_TIME||d==Constant.STACKED_LINE||d==Constant.BAR||d==Constant.STACKED_BAR||d==Constant.AREA||d==Constant.AREA_TIME||d==Constant.STACKED_AREA}function l(){return d==Constant.COLUMN||d==Constant.COLUMN_DIFF||d==Constant.STACKED_COLUMN||d==Constant.BAR||d==Constant.STACKED_BAR||d==Constant.STACKED_COLUMN_LINE||d==Constant.COLUMN_LINE||d==Constant.PERCENT_DONUT||d==Constant.DONUT||d==Constant.ROSE||d==Constant.SCATTERXY||d==Constant.SCATTER}};AnyExcel.prototype.initFontStyle=function(E,A){var D=function(M){if($(this).hasClass("tl-hover")){$(this).removeClass("tl-hover")}else{$(this).addClass("tl-hover")}};var G=function(M){if($(this).hasClass("tl-hover")){$(this).removeClass("tl-hover")}else{$(this).addClass("tl-hover")}};var B=function(M){if($(this).hasClass("tl-hover")){$(this).removeClass("tl-hover")}else{$(this).addClass("tl-hover")}};var C=E.find("ul.td-list-menu");var J=C.find("li:eq(0)");var K=A["color"]?A["color"]:"#000000";J.find("input.color-select").spectrum("set",K);var I=C.find("li:eq(1)");I.removeClass("tl-hover");if(A["fontWeight"]=="bold"){I.addClass("tl-hover")}I.unbind("click").bind("click",D);var H=C.find("li:eq(2)");H.removeClass("tl-hover");if(A["fontStyle"]=="italic"){H.addClass("tl-hover")}H.unbind("click").bind("click",G);var F=C.find("li:eq(3)");var L=A["fontSize"]?A["fontSize"]:12;F.find("select.selectpicker").selectpicker("val",L)};AnyExcel.prototype.getTextStyle=function(C){var A={};var B=C.find("ul.td-list-menu");var G=B.find("li:eq(0)");var I=G.find("input.color-select").spectrum("get");if(I!=null){A["color"]="#"+I.toHex(false)}else{A["color"]="#000000"}var F=B.find("li:eq(1)");if(F.hasClass("tl-hover")){A["fontWeight"]="bold"}var E=B.find("li:eq(2)");if(E.hasClass("tl-hover")){A["fontStyle"]="italic"}var D=B.find("li:eq(3)");var H=D.find("select.selectpicker").val();if(H!="12"){A["fontSize"]=H}return A};AnyExcel.prototype.addScatterSerie=function(B){var A=B.find("tr:eq(1)").clone().show();B.append(A);A.find("select").addClass("selectpicker").selectpicker("refresh");var E=A.find("td:eq(3)");E.find("input").spectrum({allowEmpty:true,clearText:"清除",color:null,showInput:true,showInitial:true,showPalette:true,showSelectionPalette:true,maxPaletteSize:10,preferredFormat:"hex",chooseText:"确定",cancelText:"取消",replaceInput:colorInput,palette:PALETTE});var D=A.find("td:eq(4)");D.find("a").click(function(){var F=$(this);layer.open({type:1,title:"地图散点样式",zIndex:1025,shadeClose:true,shade:false,area:["600px","380px"],content:$("#win-chart-setting-scatter-style"),btn:["确定","取消"],yes:function(I){var K={};var J=$("#win-chart-setting-scatter-style").find("table:eq(0)");var H=J.find("tr:eq(0)");K.nameEnabled=H.find("input").is(":checked");var G=J.find("tr:eq(1)");K.valueEnabled=G.find("input").is(":checked");var M=J.find("tr:eq(2)");K.sizeEnabled=M.find("input").is(":checked");var L=J.find("tr:eq(3)");K["textStyle"]=anyExcel.getTextStyle(L);F.data("scatterLabel",K);layer.close(I)},success:function(){var J=F.data("scatterLabel");J=J!=undefined?J:{};var I=$("#win-chart-setting-scatter-style").find("table:eq(0)");var H=I.find("tr:eq(0)");H.find("input[type=checkbox]").iCheck(J.nameEnabled?"check":"uncheck");var G=I.find("tr:eq(1)");G.find("input[type=checkbox]").iCheck(J.valueEnabled?"check":"uncheck");var M=I.find("tr:eq(2)");M.find("input[type=checkbox]").iCheck(J.sizeEnabled?"check":"uncheck");var L=I.find("tr:eq(3)");var K=J["textStyle"]?J["textStyle"]:{};anyExcel.initFontStyle(L,K)}})});var C=A.find("td:eq(5)");C.find("a").click(function(){$(this).parent().parent().remove()})};AnyExcel.prototype.addMoveline=function(A,B){var D=A.find("tr:eq(1)").clone().show();A.append(D);var E=D.find("td:eq(0)");if(B!=undefined){E.find("input").val(B.fromName)}var C=D.find("td:eq(1)");if(B!=undefined){C.find("input").val(B.toName)}var F=D.find("td:eq(2)");F.find("a").click(function(){$(this).parent().parent().remove()})};AnyExcel.prototype.initChart=function(C){var E=$(C.o);var A=C.content;var B=A.chart;var D=$("#win-chart").find("img");D.each(function(){if(parseInt($(this).attr("type"))==A.chartType){var G=$("<img>",{src:$(this).attr("big")});G.css("width","100%").css("height","100%");var F=B.width!=undefined?B.width:E.width();var H=B.height!=undefined?B.height:E.height();C.setImage(G,F,H);G.load(function(){grid.syncGrids()})}})};var ConstantData=function(){this.COLUMN=1;this.COLUMN_DIFF=2;this.STACKED_COLUMN=3;this.LINE=5;this.LINE_TIME=6;this.STACKED_LINE=105;this.PIE=7;this.ROSE=8;this.DONUT=9;this.BAR=10;this.STACKED_BAR=12;this.AREA=14;this.AREA_TIME=15;this.STACKED_AREA=16;this.SCATTER=17;this.SCATTERXY=18;this.FUNNEL=19;this.FUNNEL_UP=21;this.RADAR=23;this.RADAR_AREA=24;this.GAUGE=25;this.MAP=26;this.SCATTER_MAP=126;this.BMAP=127;this.STYLE_MAP=128;this.STYLE_BMAP=129;this.WORLD_MAP=130;this.STACKED_COLUMN_LINE=27;this.COLUMN_LINE=28;this.PERCENT_DONUT=30;this.PERCENT_BAR=31;this.GANTT=40;this.WORD_CLOUD=45;this.TREE_MAP=50;this.TREE=51;this.SUNBURST=55;this.SUNBURST_DONUT=56;this.MULTI=60;this.AXIS_TYPE_CATEGORY="category";this.AXIS_TYPE_NUMBER="number";this.AXIS_TYPE_DATETIME="datetime"};var Constant=new ConstantData();$(function(){var J=$("#win-chart-setting-style").find("tr:eq(1)");J.find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-style").find("tr:eq(2)").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-data-tree").find("input[type=radio]").iCheck({radioClass:"iradio_minimal"});$("#win-chart-setting-chart").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-title").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-tooltip").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-legend").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-xaxis").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-yaxis").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-rightyaxis").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-map").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-radar").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});$("#win-chart-setting-scatter-style").find("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_minimal"});var H=$("#win-chart").find("ul.left-menu-ul");H.find("li").click(function(){H.find("li").removeClass("tl-hover");$(this).addClass("tl-hover");var U=$(this).find("a").attr("href");location.href=U});var E=$(window).width()>780?780:$(window).width();var M=$(window).height()>550?550:$(window).height();$("li.tl-chart").click(function(){layer.open({type:1,title:"插入图表",zIndex:1025,shadeClose:true,area:[E+"px",M+"px"],content:$("#win-chart"),btn:["确定","取消"],yes:function(c){var Y=grid;var U=grid.selectedGridCell;if(U==null){layer.alert("请选中一个单元格");return false}if(U.mark==7){U=U.content.grid.selectedGridCell;if(U==null){return false}Y=grid.selectedGridCell.content.grid}var Z=$("#win-chart").find("img.chart-img-active");if(Z.length==0){layer.alert("请选择图表");return false}var W=$(U.o);var X=$("<img>",{src:Z.attr("big")});var a=parseInt(Z.attr("type"));U.mark=3;X.css("width","100%").css("height","100%");var V=$(U.o);U.setImage(X,V.width(),V.height());var b=U.content;b["chartType"]=a;b.initChart();anyExcel.setRightProperty(W);layer.close(c)},success:function(){H.find("li:eq(0)").trigger("click")}})});var G=function(){var U=grid.selectedGridCell;if(U==null){return null}if(U.mark==7){U=U.content.grid.selectedGridCell;if(U==null){return null}}return U};var S=$("#right-property-chart").find("tr:eq(1)");var Q=$("#right-property-chart").find("tr:eq(2)");var P=$("#right-property-chart").find("tr:eq(3)");S.find("input").change(function(){var V=G();if(V==null){return false}var W=V.content;var U=W.chart?W.chart:{};U.width=parseInt($(this).val());W.chart=U});Q.find("input").change(function(){var V=G();if(V==null){return false}var W=V.content;var U=W.chart?W.chart:{};U.height=parseInt($(this).val());W.chart=U});P.find("a").click(function(){var U=G();if(U==null){return false}anyExcel.chartsettting(U.content)});var F=$("#win-chart-setting-style").find("table:eq(1)");var B=$("#win-chart-setting-style").find("ul.top-menu");B.find("li:eq(0)").click(function(){var U=F.find("tr:eq(1)").clone().show();F.append(U);U.find("select").addClass("selectpicker").selectpicker("refresh");var V=U.find("td:eq(6)");V.find("a").click(function(){$(this).parent().parent().remove()});var W=U.find("td:eq(2)");W.find("input").addClass("color-select").spectrum({allowEmpty:false,clearText:"清除",color:"#ffffff",showInput:true,showInitial:true,showPalette:true,showSelectionPalette:true,maxPaletteSize:10,preferredFormat:"hex",chooseText:"确定",cancelText:"取消",replaceInput:colorInput,palette:PALETTE})});var L=$("#win-chart-setting-map").find("a.scatter-attr");var O=$("#win-chart-setting-map").find("table.scatter");L.click(function(){anyExcel.addScatterSerie(O)});var T=$("#win-chart-setting-style-map").find("ul.top-menu:eq(0)");var C=$("#win-chart-setting-style-map").find("table:eq(0)");T.find("a").click(function(){var U=C.find("tr:eq(1)").clone().show();C.append(U);U.find("td:eq(2)").find("input[type=file]").change(function(){var X=this.files[0];var W=new FileReader();var Y=$(this).parent().prev();W.onload=function(){var Z=this.result;Y.find("textarea").val(Z)};W.readAsText(X)});var V=U.find("td:eq(3)");V.find("a").click(function(){$(this).parent().parent().remove()})});var A=$("#win-chart-setting-style-map").find("ul.top-menu:eq(1)");var K=$("#win-chart-setting-style-map").find("table:eq(1)");A.find("a").click(function(){var U=K.find("tr:eq(1)").clone().show();K.append(U);var V=U.find("td:eq(2)");V.find("a").click(function(){$(this).parent().parent().remove()})});var D=$("#win-chart-setting-map-pos").find("ul.top-menu");var N=$("#win-chart-setting-map-pos").find("table");D.find("a").click(function(){var U=N.find("tr:eq(1)").clone().show();N.append(U);var V=U.find("td:eq(2)");V.find("a").click(function(){$(this).parent().parent().remove()})});var I=$("#win-chart-setting-map-moveline").find("a");var R=$("#win-chart-setting-map-moveline").find("table");I.click(function(){anyExcel.addMoveline(R)})});$(function(){var D=function(G){G=G.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);function H(I){return("0"+parseInt(I).toString(16)).slice(-2)}return"#"+H(G[1])+H(G[2])+H(G[3])};var E=function(){var G=$("#win-chart-style-theme").find("table.color");var I=report.chartTheme?report.chartTheme:{};var H=I.name!=undefined?I.name:"default";if(I.colors!=undefined){G.find("div[theme="+H+"]").find("a").find("i").each(function(J){$(this).css("color",I.colors[J])})}G.find("div[theme="+H+"]").find("a").trigger("click")};var F=function(){var I=$("#win-chart-style-theme").find("table.color");var G=I.find("div.theme-active");if(G.attr("theme")=="default"){report.chartTheme=undefined;return }var J={};J.name=G.attr("theme");var H=new Array();G.find("i").each(function(){H.push(D($(this).css("color")))});J.colors=H;report.chartTheme=J};$("li.tl-view-chart-theme").click(function(){layer.open({type:1,title:"图表主题",zIndex:1025,shadeClose:true,area:["780px","480px"],content:$("#win-chart-style-theme"),btn:["确定","取消"],yes:function(G){F();layer.close(G)},success:function(){E()}})});var A=$("#win-chart-style-theme").find("td.colorlist");var C=$("#win-chart-style-theme").find("table.color");C.find("a").click(function(){A.empty();C.find("div").removeClass("theme-active");$(this).parent("div").addClass("theme-active");$(this).find("i").each(function(G){var H=D($(this).css("color"));var I=$("<div><input type='text' style='width:100px;'><input type='text'/></div>");A.append(I);I.attr("idx",G);I.find("input:eq(0)").val(H).change(function(){var J=$(this).parent("div");J.find("input:eq(1)").spectrum("set",$(this).val());C.find("div.theme-active").find("i:eq("+J.attr("idx")+")").css("color",$(this).val());B()});I.find("input:eq(1)").addClass("color-select").spectrum({allowEmpty:false,clearText:"清除",color:H,showInput:true,showInitial:true,showPalette:true,showSelectionPalette:true,maxPaletteSize:10,preferredFormat:"hex",chooseText:"确定",cancelText:"取消",replaceInput:colorInput,change:function(J){var K=$(this).parent("div");K.find("input:eq(0)").val(J);C.find("div.theme-active").find("i:eq("+K.attr("idx")+")").css("color",$(this).val());B()},palette:PALETTE})});B()});function B(){var I=$("#win-chart-style-theme").find("table.color");var G=new Array();I.find("div.theme-active").find("i").each(function(){G.push($(this).css("color"))});var H={"chart":{"type":"pie","width":400,"height":300},"tooltip":{"backgroundColor":"#000000"},"legend":{"enabled":false},"series":[{"name":"销售占比","label":{"enabled":false,"format":"0.0%","textStyle":{"fontWeight":"bold","fontStyle":"italic"}},"data":[{"name":"苏州","value":34.854},{"name":"南京","value":23.8},{"name":"上海","value":29.82},{"name":"北京","value":25},{"name":"深圳","value":28.7409},{"name":"天津","value":25.3},{"name":"其他","value":20.4}]}]};H.chart.colors=G;chart.draw(H,"win-chart-style-theme-demo")}})