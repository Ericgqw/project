(function(A){A.fn.grid=function(E){var M=":",F="=sum",N="=avg",P="=max",O="=min",R="=count",D="=",T="=group";var Q=E.rowNum,H=E.colNum,L=E.id;arg=E.arg;var S=function(){this.isRemove=false;this.mergeCell=null;this.rowSpan=1;this.colSpan=1;this.mark=-2;this.content=new Content()};S.prototype.isValid=function(){if(!A.isEmptyObject(this.borderColor)){return true}if(this.content.available()){return true}var V=this.o;var U=B.style(V);if(U["backgroundColor"]){return true}return false};S.prototype.setCellMark=function(V){var X=this.mark;var U=this.content.disType;var W=A.trim(V);if(W.startsWith("=")){if(X!=1){this.content=new Content();this.content.disType=U}this.mark=1}else{if(W==""){if(this.mark!=-2){this.content=new Content();this.content.disType=U}this.mark=-2}else{if(this.mark!=0){this.content=new Content();this.content.disType=U}this.mark=0}}};S.prototype.acceptDsColumn=function(V){if(V==""){return }if(this.rowNum>0&&this.colNum>0){var X=A(this.o);if(X.children("div").length==0){var W=A("<div></div>").css("overflow","hidden").css("position","relative").width(X.width()).height(X.height());var U=A("<div></div>").addClass("sv").width(X.width()).height(X.height()).append("<span></span>");W.append(U);X.append(W)}X.find("span").html(V);this.setCellMark(V);if(V.substring(0,1)=="="){this.content.disType=1}}};S.prototype.getDsColumn=function(){var Y=A(this.o);var X=Y.find("span").html();if(X&&X.startsWith("=")){var V=X.split(".");var U=report.ds;if(U){for(var W in U){if("="+W==V[0]){return X}}}}return""};S.prototype.setText=function(W){var Y=A(this.o);if(Y.find("div").length==0){var V=A("<span></span>").html(W);var U=A("<div></div>").addClass("sv").append(V);var X=A("<div></div>").append(U);X.css("overflow","hidden").css("position","relative").width(Y.width()).height(Y.height()).appendTo(Y);U.width(Y.width()).height(Y.height())}else{Y.find("span").html(W)}};S.prototype.setImage=function(W,V,X){var Z=A(this.o);if(Z.find("div").length==0){var U=A("<div></div>").addClass("sv").append(W);var Y=A("<div></div>").append(U);Y.css("overflow","hidden").css("position","relative").width(V).height(X).appendTo(Z);U.width(V).height(X)}else{Z.find("div.sv").empty().append(W)}};S.prototype.setFirstColIcon=function(U){var V=A(this.o);V.find("i").remove();V.find("div").append(U)};S.prototype.setIcon=function(U,W){var Y=A(this.o);var V=null;if(Y.children("div").length==0){var X=A("<div></div>").css("overflow","hidden").css("position","relative").width(Y.width()).height(Y.height());V=A("<div></div>").addClass("sv").width(Y.width()).height(Y.height()).append("<span></span>");X.append(V);Y.append(X)}else{V=Y.find("div.sv")}V.find("i").remove();if(V.find("span").length==0){V.append(U)}else{if(!W){A(""+U).insertBefore(V.find("span"))}else{V.append(U)}}};S.prototype.getFormComponent=function(){var V=this.content;var U=V.components;if(U==undefined){var W={};U=new Array();U.push(W);V.components=U;return W}else{return U[0]}};S.prototype.getText=function(){var U=A(this.o);return U.find("span").text()};var K=function(){this.maxNum=0;this.firstRow=0;this.lastRow=0;this.firstCol=0;this.lastCol=0;this.isRectangle=true;this.setRect=function(U){if(U==null){return }if(U.rowNum<this.firstRow){this.firstRow=U.rowNum;this.isRectangle=false}if(U.rowNum+U.rowSpan-1>this.lastRow){this.lastRow=U.rowNum+U.rowSpan-1;this.isRectangle=false}if(U.colNum<this.firstCol){this.firstCol=U.colNum;this.isRectangle=false}if(U.colNum+U.colSpan-1>this.lastCol){this.lastCol=U.colNum+U.colSpan-1;this.isRectangle=false}this.maxNum++};this.isGoRectangle=function(){if(this.isRectangle||this.maxNum>100){return false}return true}};var J=function(V){this.div=V.tbdiv.find(".tdinput");this.texti=this.div.find("textarea");this.editTd=null;var U=this;var W=0;this.texti.keydown(function(){var X=A(this)[0].scrollWidth;if(W==0){W=X}if(X>W){A(this).width(X);W=A(this)[0].scrollWidth}});this.texti.blur(function(){U.div.hide();if(U.editTd!=null){var a=U.texti.val();a=a.replace(/\n/g,"<br/>");a=a.replace(/\s/g,"&nbsp;");if(U.editTd.find("div").length==0){var Y=A("<span></span>").html(a);var X=A("<div></div>").addClass("sv").append(Y);var b=A("<div></div>").append(X);b.css("overflow","hidden").css("position","relative").width(U.editTd.width()).height(U.editTd.height()).appendTo(U.editTd);X.width(U.editTd.width()).height(U.editTd.height())}else{U.editTd.find("span").html(a)}var Z=U.editTd.data("gc");Z.setCellMark(a)}U.texti.val("");B.showBorderColor()})};J.prototype.startEdit=function(W){this.div.show();B.hideBorderColor();this.editTd=W;var U=W.offset();this.div.offset({left:U.left,top:U.top});this.texti.width(W.width()).height(W.height());var V=W.find("span").html();if(V){V=V.replace(/<br>/g,"\n").replace(/<br\/>/g,"\n").replace(/\&nbsp\;/g," ");this.texti.val(V)}this.texti.focus()};var I=function(){this.x=0;this.w=0;this.y=0;this.h=0};var G=function(){var U=this;this.rowNum=Q?Q:26;this.colNum=H?H:12;this.rect=new I();this.colWidth=140;this.firstColWidth=40;this.rowHeight=25;this.d=A(document);this.tb=A("#"+L);this.tbdoc=document.getElementById(L);this.tbdiv=this.tb.parent("div");this.textedit=new J(U);this.selectedGridCell=null;this.shiftGridCell=null;this.tempGridCell=null;this.tempShiftGridCell=null;this.tdClickHandler=function(W){if(cellSelectedFlag){U.tempShiftGridCell=null;var V=A(this).data("gc");if(W.shiftKey){U.tempShiftGridCell=V}else{U.tempGridCell=V}U.cellSelectBorderColor();return false}U.shiftGridCell=null;var V=A(this).data("gc");if(W.shiftKey){U.shiftGridCell=V}else{U.selectedGridCell=V}U.cellBorderColor();anyExcel.setToolMenuStyle(A(this));anyExcel.setRightArgProperty(A(this));if(A("li.tl-cell-line").hasClass("tl-hover")){U.startDrawCellLine(U.selectedGridCell);A("li.tl-cell-line").removeClass("tl-hover")}};this.tddbClickHandler=function(W){var V=U.selectedGridCell;if(V==null){return false}if(V.mark==2){return false}if(V.mark==3){anyExcel.chartsettting(V.content);return false}U.textedit.startEdit(A(this))}};G.prototype={init:function(){this.createFirstGridRow();for(var U=1;U<this.rowNum;U++){this.addGridRow(U)}this.resizable();this.areaDrag();if(!arg){this.syncGridDivs()}},createFirstGridRow:function(){var Y=A("<tr></tr>").addClass("tbheader");var b=0;for(var X=0;X<this.colNum;X++){var W=(X>0)?C.getLetter(X+64):"";var a=A("<td></td>");var Z=A("<div></div>");Z.css("overflow","hidden").html(W).appendTo(a);var V=X==0?this.firstColWidth:this.colWidth;a.width(V).addClass("fr");Y.append(a);b+=V;if(X==0){a.height(this.rowHeight)}var U=new S();U.rowNum=0;U.colNum=X;U.o=a;a.data("gc",U)}this.tb.append(Y);this.tb.parent("div").width(b)},addGridRow:function(Z){var W=document.createDocumentFragment();var X=document.createElement("tr");for(var V=0;V<this.colNum;V++){var b=document.createElement("td");var Y=A(b);if(V==0){var a=document.createElement("div");a.innerHTML=Z;a.style.overflow="hidden";b.appendChild(a);Y.addClass("tbheader").addClass("fc").height(this.rowHeight)}X.appendChild(b);W.appendChild(X);if(V>0){Y.bind("click",this.tdClickHandler);Y.bind("dblclick",this.tddbClickHandler)}var U=new S();U.rowNum=Z;U.colNum=V;U.o=b;Y.data("gc",U)}this.tbdoc.appendChild(W)},insertRow:function(){var Z=this;var V=this.selectedGridCell;if(V==null){return }var d=V.rowNum;var c=Z.tb.find("tr:first").find("td");var e=A("<tr></tr>");for(var W=0;W<c.length;W++){var X=A("<td></td>");if(W>0){X.bind("click",Z.tdClickHandler);X.bind("dblclick",Z.tddbClickHandler)}var Y=new S();Y.rowNum=d;Y.colNum=W;Y.o=X;X.data("gc",Y);if(W==0){var U=A("<div></div>").css("overflow","hidden");U.appendTo(X);U.html(d);X.addClass("tbheader").height(Z.rowHeight);e.append(X);X.on("contextmenu",function(g){anyExcel.fcOnContextmenu(g)});continue}var f=Z.findGridCell(d,W);if(f.isRemove){if(f.rowNum!=f.mergeCell.rowNum){X.hide();Y.isRemove=true;Y.mergeCell=f.mergeCell;if(f.mergeCell.colNum==Y.colNum){f.mergeCell.rowSpan=f.mergeCell.rowSpan+1;var h=A(f.mergeCell.o);h.attr("rowSpan",f.mergeCell.rowSpan)}}}e.append(X)}var b=Z.tb.children(":eq("+d+")");e.insertBefore(b);var a=Z.tb.children(":gt("+d+")");a.each(function(j){var g=A(this);g.children("td").each(function(i){var k=A(this);var l=k.data("gc");l.rowNum=l.rowNum+1;if(i==0){if(k.find("div").length>0){k.find("div").html(l.rowNum)}else{k.html(l.rowNum)}}})});Z.resetResizable();Z.cellBorderColor();Z.rowNum++},insertColumn:function(){var e=this;var X=this.selectedGridCell;if(X==null){return }var V=X.colNum;var f=e.tb.children();for(var d=0;d<f.length;d++){var W=(d==0)?C.getLetter(V+64):"";var b=A("<td></td>");if(d==0){var U=A("<div></div>").css("overflow","hidden");U.appendTo(b);U.html(W)}if(d>0){b.bind("click",e.tdClickHandler);b.bind("dblclick",e.tddbClickHandler)}var c=new S();c.rowNum=d;c.colNum=V;c.o=b;b.data("gc",c);var a=e.findTd(d,V);var h=a.data("gc");if(d==0){b.width(e.colWidth);b.insertBefore(a);continue}if(h.isRemove){if(h.colNum!=h.mergeCell.colNum){b.hide();c.isRemove=true;c.mergeCell=h.mergeCell;if(h.mergeCell.rowNum==c.rowNum){h.mergeCell.colSpan=h.mergeCell.colSpan+1;var j=A(h.mergeCell.o);j.attr("colspan",h.mergeCell.colSpan)}}}b.insertBefore(a)}for(var d=0;d<f.length;d++){var Z=(d==0)?e.tb.find("tr:first"):A(f[d]);Z.children(":gt("+V+")").each(function(){var g=A(this);var i=g.data("gc");i.colNum=i.colNum+1;if(d==0){if(g.find("div").length>0){g.find("div").html(C.getLetter(i.colNum+64))}else{g.html(C.getLetter(i.colNum+64))}}})}var Y=e.tb.parent("div");Y.width(Y.width()+e.colWidth);e.resetResizable();e.cellBorderColor();e.colNum++},newAddRow:function(){var U=this.tb.find("tr");var V=U.length;this.addGridRow(V);this.resetResizable();this.rowNum++},newAddColumn:function(){var a=this;var b=a.tb.children();for(var Z=0;Z<b.length;Z++){var W=A(b[Z]);if(Z==0){W=a.tb.find("tr:first")}var X=A("<td></td>");var Y=0;if(Z==0){var U=A("<div></div>").css("overflow","hidden");U.appendTo(X);Y=W.find("td").length;U.html(C.getLetter(Y+64));X.width(a.colWidth)}else{Y=W.children().length;X.bind("click",a.tdClickHandler);X.bind("dblclick",a.tddbClickHandler)}var c=new S();c.rowNum=Z;c.colNum=Y;c.o=X;X.data("gc",c);W.append(X)}var V=a.tb.parent("div");V.width(V.width()+a.colWidth);a.resetResizable();a.colNum++},deleteRow:function(){var Y=this;var V=this.selectedGridCell;if(V==null){return }var e=V.rowNum;var b=Y.tb.children(":eq("+e+")");var W=b.children("td");for(var X=0;X<W.length;X++){var h=A(W[X]);var f=h.data("gc");if(f.isRemove&&f.colNum==f.mergeCell.colNum){f.mergeCell.rowSpan=f.mergeCell.rowSpan-1;var d=Y.findTd(f.mergeCell.rowNum,f.mergeCell.colNum);if(d){d.attr("rowspan",f.mergeCell.rowSpan)}}}b.remove();var Z=Y.tb.children();for(var U=e;U<Z.length;U++){var W=A(Z[U]).children("td");for(var a=0;a<W.length;a++){var h=A(W[a]);var V=h.data("gc");V.rowNum=V.rowNum-1;if(a==0){h.find("div").empty().html(V.rowNum)}}}Y.rowNum--;Y.resetResizable()},deleteCol:function(){var Y=this;var V=this.selectedGridCell;if(V==null){return }var U=V.colNum;var Z=Y.tb.children();for(var X=0;X<Z.length;X++){var W=A(Z[X]);var f=null;if(X==0){f=W.find("td:eq("+U+")")}else{f=W.children("td:eq("+U+")")}var e=f.data("gc");if(e.colNum==0){continue}if(e.isRemove&&e.rowNum==e.mergeCell.rowNum){e.mergeCell.colSpan=e.mergeCell.colSpan-1;var d=Y.findTd(e.mergeCell.rowNum,e.mergeCell.colNum);if(d){d.attr("colspan",e.mergeCell.colSpan)}}f.remove()}for(var X=0;X<Z.length;X++){var W=A(Z[X]);var a=null;if(X==0){a=W.find("td")}else{a=W.children()}for(var b=U;b<a.length;b++){var f=A(a[b]);var V=f.data("gc");V.colNum=V.colNum-1;if(X==0){f.find("div").empty().html(C.getLetter(V.colNum+64))}}}Y.colNum--;Y.resetResizable()},resetResizable:function(){var U=this.tbdiv.find("div.JCLRgrips");var V=this.tbdiv.find("div.JRWRgrips");U.empty();V.empty();this.resizable()}};G.prototype.isMergeFlag=function(){if(this.selectedGridCell==null){return false}if(this.selectedGridCell.rowSpan>1||this.selectedGridCell.colSpan>1){if(this.shiftGridCell!=null&&this.shiftGridCell!=this.selectedGridCell){return false}return true}return false};G.prototype.cellBorderColor=function(){var Z=this;if(Z.selectedGridCell==null){return }if(Z.shiftGridCell!=null){var U=C.calMergeGridCell(Z.selectedGridCell,Z.shiftGridCell,Z.tb.find("tr"));Z.selectedGridCell=Z.findGridCell(U.firstRow,U.firstCol);Z.shiftGridCell=Z.findGridCell(U.lastRow,U.lastCol)}var X=Z.findTd(Z.selectedGridCell.rowNum,Z.selectedGridCell.colNum);var e=X.offset();var c=X.width();var Y=X.height();if(Z.shiftGridCell!=null){var b=Z.shiftGridCell.isRemove?Z.shiftGridCell.mergeCell:Z.shiftGridCell;var d=Z.findTd(b.rowNum,b.colNum);c=d.offset().left-e.left+d.width();Y=d.offset().top-e.top+d.height()}var a=Z.tbdiv.find(".selected").find("div.tdborder");for(var W=0;W<a.length;W++){var V=A(a[W]);if(W==0){V.offset({left:e.left,top:e.top}).height(2).width(c)}else{if(W==1){V.offset({left:e.left+c,top:e.top}).height(Y).width(2)}else{if(W==2){V.offset({left:e.left,top:e.top+Y}).height(2).width(c)}else{if(W==3){V.offset({left:e.left,top:e.top}).height(Y).width(2)}else{if(W==4){if(!V.is(":visible")){V.show()}V.offset({left:e.left+c-3,top:e.top+Y-3}).height(5).width(5)}}}}}}Z.rect.x=e.left;Z.rect.y=e.top;Z.rect.w=c;Z.rect.h=Y;Z.selectRowColBgColor();if(Z.selectedGridCell!=null){anyExcel.cellContent(C.getLetter(Z.selectedGridCell.colNum+64)+Z.selectedGridCell.rowNum)}};G.prototype.hideBorderColor=function(){this.tbdiv.find(".selected").hide()};G.prototype.showBorderColor=function(){this.tbdiv.find(".selected").show()};G.prototype.canBorderColor=function(e,V,a){var b=this;if(V!=null){var U=C.calMergeGridCell(e,V,b.tb.find("tr"));e=b.findGridCell(U.firstRow,U.firstCol);V=b.findGridCell(U.lastRow,U.lastCol)}a.startCell=e;a.endCell=V;var Z=b.findTd(e.rowNum,e.colNum);var k=Z.offset();var f=Z.outerWidth(false);var Y=Z.height();if(V!=null){var d=V.isRemove?V.mergeCell:V;var j=b.findTd(d.rowNum,d.colNum);f=j.offset().left-k.left+j.outerWidth(false);Y=j.offset().top-k.top+j.height()}var c=b.tbdiv.find(".canselected").find("div.tdborder");for(var X=0;X<c.length;X++){var W=A(c[X]);if(X==0){W.offset({left:k.left,top:k.top}).height(1).width(f)}else{if(X==1){W.offset({left:k.left+f,top:k.top}).height(Y+1).width(1)}else{if(X==2){W.offset({left:k.left,top:k.top+Y}).height(1).width(f+1)}else{if(X==3){W.offset({left:k.left,top:k.top}).height(Y).width(1)}}}}}};G.prototype.clearCanBorderColor=function(){var W=this.tbdiv.find(".canselected").find("div.tdborder");for(var V=0;V<W.length;V++){var U=A(W[V]);U.offset({left:0,top:0});U.height(0).width(0)}};G.prototype.cellSelectBorderColor=function(Y){var b=this;if(b.tempGridCell==null){return }if(b.tempShiftGridCell!=null){var W=C.calMergeGridCell(b.tempGridCell,b.tempShiftGridCell,b.tb.find("tr"));b.tempGridCell=b.findGridCell(W.firstRow,W.firstCol);b.tempShiftGridCell=b.findGridCell(W.lastRow,W.lastCol)}var Z=b.findTd(b.tempGridCell.rowNum,b.tempGridCell.colNum);var i=Z.offset();var e=Z.width();var a=Z.height();if(b.tempShiftGridCell!=null){var c=b.tempShiftGridCell.isRemove?b.tempShiftGridCell.mergeCell:b.tempShiftGridCell;var f=b.findTd(c.rowNum,c.colNum);e=f.offset().left-i.left+f.width();a=f.offset().top-i.top+f.height()}var V=this.tbdiv.find(".cellselected").find("div.tdborder-dashed");V.show().offset({left:i.left,top:i.top}).height(a).width(e);var d=b.tempGridCell.rowNum;var U=b.tempGridCell.colNum;var X=C.getLetter(U+64)+d;if(b.tempShiftGridCell!=null){d=b.tempShiftGridCell.rowNum;U=b.tempShiftGridCell.colNum;X+=":"+C.getLetter(U+64)+d}anyExcel.setSelectCellText(X)};G.prototype.clearSelectBorderColor=function(){this.tempGridCell=null;this.tempShiftGridCell=null;var U=this.tbdiv.find(".cellselected").find("div.tdborder-dashed");U.hide()};G.prototype.selectRowColBgColor=function(){this.tb.find("td").removeClass("td-active");var V=this.tb.find("tr:first");var W=this.selectedGridCell.colNum;var Y=this.shiftGridCell!=null?this.shiftGridCell.colNum:W+this.selectedGridCell.colSpan-1;var U=this.selectedGridCell.rowNum;var X=this.shiftGridCell!=null?this.shiftGridCell.rowNum:U+this.selectedGridCell.rowSpan-1;V.find("td").each(function(Z){if(Z>=W&&Z<=Y){A(this).addClass("td-active")}});this.tb.find("tr").each(function(a){if(a>=U&&a<=X){var Z=A(this).find("td:first");Z.addClass("td-active")}})};G.prototype.findGridCell=function(W,U){var V=this.tb.find("tr:eq("+W+")");var X=V.find("td:eq("+U+")");return X.data("gc")};G.prototype.findTd=function(V,U){return this.tb.find("tr:eq("+V+") td:eq("+U+")")};G.prototype.mergeCell=function(){var Y=this;if(Y.selectedGridCell==null){return }if(Y.shiftGridCell==null){return }var U=C.calMergeGridCell(Y.selectedGridCell,Y.shiftGridCell,Y.tb.find("tr"));Y.selectedGridCell=Y.findGridCell(U.firstRow,U.firstCol);Y.shiftGridCell=Y.findGridCell(U.lastRow,U.lastCol);for(var X=U.firstRow;X<=U.lastRow;X++){for(var V=U.firstCol;V<=U.lastCol;V++){var W=Y.findTd(X,V);if(X==U.firstRow&&V==U.firstCol){Y.selectedGridCell.rowSpan=U.lastRow-X+1;Y.selectedGridCell.colSpan=U.lastCol-V+1;if(W.length>0){W.attr("rowspan",Y.selectedGridCell.rowSpan).attr("colspan",Y.selectedGridCell.colSpan);var a=W.children("div");a.height(W.height());a.width(W.width());W.find("div.sv").height(W.height());W.find("div.sv").width(W.width())}}else{if(W.length>0){var Z=W.data("gc");Z.isRemove=true;Z.mergeCell=Y.selectedGridCell;W.hide()}}}}};G.prototype.mergeTdCell=function(Y){if(Y.rowSpan>1||Y.colSpan>1){for(var X=Y.rowNum;X<Y.rowNum+Y.rowSpan;X++){for(var V=Y.colNum;V<Y.colNum+Y.colSpan;V++){var W=this.findTd(X,V);if(X==Y.rowNum&&V==Y.colNum){W.attr("rowspan",Y.rowSpan).attr("colspan",Y.colSpan)}else{var U=W.data("gc");U.isRemove=true;U.mergeCell=Y;W.hide()}}}}};G.prototype.divideCell=function(){var X=this;if(X.selectedGridCell.rowSpan>1||X.selectedGridCell.colSpan>1){for(var W=X.selectedGridCell.rowNum;W<X.selectedGridCell.rowNum+X.selectedGridCell.rowSpan;W++){for(var U=X.selectedGridCell.colNum;U<X.selectedGridCell.colNum+X.selectedGridCell.colSpan;U++){var V=X.findTd(W,U);if(V.length==0){continue}var Y=V.data("gc");if(W==X.selectedGridCell.rowNum&&U==X.selectedGridCell.colNum){this.syncGridRowDivs(V,this.getFirstGridCellHeight(Y),true);this.syncGridColDivs(V,this.getFirstGridCellWidth(Y),true);V.attr("rowspan",1).attr("colspan",1)}else{Y.isRemove=false;Y.mergeCell=null;Y.rowSpan=1;Y.colSpan=1;V.attr("rowspan",1).attr("colspan",1);V.show()}}}X.selectedGridCell.rowSpan=1;X.selectedGridCell.colSpan=1;return }};G.prototype.unMergeCell=function(Z){var Y=this;for(var X=Z.rowNum;X<=Z.rowNum+Z.rowSpan;X++){for(var V=Z.colNum;V<=Z.colNum+Z.colSpan;V++){var W=Y.findTd(X,V);if(W.length==0){continue}var U=W.data("gc");if(X==U.rowNum&&V==U.colNum){this.syncGridRowDivs(W,this.getFirstGridCellHeight(U),true);this.syncGridColDivs(W,this.getFirstGridCellWidth(U),true);W.attr("rowspan",1).attr("colspan",1)}else{U.isRemove=false;U.mergeCell=null;W.show()}}}Z.rowSpan=1;Z.colSpan=1};G.prototype.resizable=function(){var V=this;var f="JColResizer";var a="JRWResizer";var d=null;var e=function(m){var l=A(this);l.ox=m.pageX;l.l=l.position().left;l.x=l.l;l.w=l.data("c").width();var n=V.tb.parent("div");l.tw=n.width();V.d.bind("mousemove."+f,h).bind("mouseup."+f,j);d=l};var k=this.tb.find("tr:first");var i=this.tbdiv.find("div.JCLRgrips");k.find("td").each(function(l){var n=A(this);var m=A('<div class="JCLRgrip"></div>');m.append('<div class="'+f+'"></div>');i.append(m);if(l>0){m.bind("mousedown",e)}m.height(n.outerHeight(false));m.css({left:n.offset().left-V.tb.offset().left+n.outerWidth(false)});m.data("c",n)});var b=function(m){var l=A(this);l.oy=m.pageY;l.top=l.position().top;l.y=l.top;var n=l.data("c");l.rh=n.height();V.d.bind("mousemove.JRWResizer",X).bind("mouseup.JRWResizer",U);d=l};var g=this.tbdiv.find("div.JRWRgrips");var k=this.tb.find("tr");k.each(function(l){var p=A(this);var n=document.createElement("div");n.setAttribute("class","JRWRgrip");var m=document.createElement("div");m.setAttribute("class","JRWResizer");n.appendChild(m);g.append(n);var o=A(n);if(l>0){o.bind("mousedown",b)}var q=p.find("td:first");o.width(q.outerWidth());o.css({top:p.offset().top-V.tb.offset().top+q.outerHeight(false)+"px"});o.data("c",q)});var h=function(n){if(!d){return }var m=n.pageX;var l=m-d.ox+d.l;d.x=l;d.css("left",l+"px");Y();W();V.cellBorderColor();n.preventDefault();return false};var j=function(n){V.d.unbind("mousemove."+f,h).unbind("mouseup."+f,j);if(!d){return }var m=n.pageX;var l=m-d.ox+d.l;d.x=l;d.css("left",l+"px");Y();W();V.cellBorderColor();d=null};var X=function(n){if(!d){return }var l=n.pageY;var o=l-d.oy+d.top;var m=5;o=Math.max(m,o);d.y=o;d.css("top",o+"px");c();Z();V.cellBorderColor();n.preventDefault();return false};var U=function(l){V.d.unbind("mouseup.JRWResizer",U).unbind("mousemove.JRWResizer",X);if(!d){return }if(!(d.y-d.top==0)){c();Z();V.cellBorderColor()}d=null};var Y=function(){var m=d.x-d.l;var l=d.w+m;var o=V.tb.parent("div");o.width(d.tw+m);var n=d.data("c");n.width(d.w+m);V.syncGridColDivs(n,d.w+m)};var W=function(){var l=V.tb.find("tr:first");var m=V.tbdiv.find(".JCLRgrips>div");l.find("td").each(function(n){var o=A(this);A(m[n]).css({left:o.offset().left-V.tb.offset().left+o.outerWidth(false)})})};var c=function(){var m=d.y-d.top;var l=d.rh;var n=d.data("c");n.height(l+m);V.syncGridRowDivs(n,l+m)};var Z=function(){var l=V.tb.find("tr");var m=V.tbdiv.find(".JRWRgrips>div");l.each(function(n){var p=A(this);var q=p.find("td:first");var o=A(m[n]);o.css({top:p.offset().top-V.tb.offset().top+q.outerHeight(false)+"px"})})}};G.prototype.syncArgGrips=function(){var U=this.tb.find("tr:first");var V=this.tbdiv.find("div.JCLRgrip");U.find("td").each(function(X){var Z=A(this);var Y=A(V[X]);Y.height(Z.outerHeight(false));Y.css({left:Z.offset().left-B.tb.offset().left+Z.outerWidth(false)})});U=this.tb.find("tr");var W=this.tbdiv.find("div.JRWRgrip");U.each(function(X){var Z=A(this);var Y=A(W[X]);var a=Z.find("td:first");Y.width(a.outerWidth());Y.css({top:Z.offset().top-B.tb.offset().top+a.outerHeight(false)+"px"})})};G.prototype.syncGrids=function(){var U=this.tb.find("tr:first");var V=this.tbdiv.find("div.JCLRgrip");U.find("td").each(function(X){var Z=A(this);var Y=A(V[X]);Y.height(Z.outerHeight(false));Y.css({left:Z.offset().left-B.tb.offset().left+Z.outerWidth(false)})});U=this.tb.find("tr");var W=this.tbdiv.find("div.JRWRgrip");U.each(function(X){var Z=A(this);var Y=A(W[X]);var a=Z.find("td:first");Y.width(a.outerWidth());Y.css({top:Z.offset().top-B.tb.offset().top+a.outerHeight(false)+"px"})});this.cellBorderColor()};G.prototype.syncGridDivs=function(){var U=this.tb.find("td");U.each(function(){var V=A(this).children("div");if(V.length>0){V.width(A(this).width());V.height(A(this).height())}A(this).find("div.sv").width(A(this).width()).height(A(this).height())})};G.prototype.syncGridRowDivs=function(a,V,U){var W=this;var Y=a.data("gc");var Z=Y.rowNum;var X=this.tb.find("tr:eq("+Z+")");X.find("td").each(function(){var b=A(this).children("div");b.height(V);b.find("div.sv").height(V);if(!U){W.syncMergeGridRowDivs(A(this),V)}})};G.prototype.syncMergeGridRowDivs=function(X,b){var W=X.data("gc");var Y=null;if(W.isRemove){Y=W.mergeCell}if(W.rowSpan>1){Y=W}if(Y==null){return }var U=0;for(var Z=Y.rowNum;Z<Y.rowNum+Y.rowSpan;Z++){var c=this.findTd(Z,Y.colNum);var a=c.data("gc");if(a.rowNum!=W.rowNum){U+=this.getFirstGridCellHeight(a)}else{U+=b}}var d=A(Y.o);var V=d.children("div");V.height(U);V.find("div.sv").height(U)};G.prototype.syncGridColDivs=function(a,W,U){var X=this;var Z=a.data("gc");var V=Z.colNum;var Y=this.tb.find("tr");Y.each(function(){var c=A(this).find("td:eq("+V+")");var b=c.children("div");b.width(W);b.find("div.sv").width(W);if(!U){X.syncMergeGridColDivs(c,W)}})};G.prototype.syncMergeGridColDivs=function(X,V){var W=X.data("gc");var Z=null;if(W.isRemove){Z=W.mergeCell}if(W.colSpan>1){Z=W}if(Z==null){return }var Y=0;for(var a=Z.colNum;a<Z.colNum+Z.colSpan;a++){var c=this.findTd(Z.rowNum,a);var b=c.data("gc");if(b.colNum!=W.colNum){Y+=this.getFirstGridCellWidth(b)}else{Y+=V}}var d=A(Z.o);var U=d.children("div");U.width(Y);U.find("div.sv").width(Y)};G.prototype.areaDrag=function(){var V=this;var W=null;var U=function(b){V.d.bind("mouseup.area",Z).bind("mousemove.area",Y);var a=A(this);W=a;W.x=A(this).offset().left;W.y=A(this).offset().top};V.tbdiv.find("div.area").mousedown(U);var Y=function(d){if(!W){return }var b=d.pageX;var a=d.pageY;var c=Math.abs(b-W.x);var f=Math.abs(a-W.y);V.drawCanSelectedBorder(b,a,c,f,W);d.preventDefault()};var Z=function(a){V.d.unbind("mouseup.area",Z).unbind("mousemove.area",Y);V.clearCanBorderColor();if(!W){return }if(W.startCell){V.selectedGridCell=W.startCell;V.shiftGridCell=W.endCell;V.cellBorderColor()}W=null};var X=V.tbdiv.find(".tdborders").find(".area");X.bind("mousedown",U)};G.prototype.drawCanSelectedBorder=function(Z,Y,g,d,b){var V=this;var U=this.rect;if(Z>=U.x&&Z<=U.x+U.w&&Y>=U.y&&Y<=U.y+U.h){V.clearCanBorderColor();b.startCell=V.selectedGridCell;b.endCell=V.shiftGridCell;return }var X=null;if(g<d){if(Y>U.y+U.h){var f=this.selectedGridCell;var a=this.shiftGridCell!=null?this.shiftGridCell:f;var e=a.rowNum;var W=a.colNum;var c=this.tb.find("tr:gt("+e+")");c.each(function(h){var j=A(this).find("td:eq("+W+")");if(j.offset().top+A(this).height()/2>Y){return false}X=j.data("gc")});if(X!=null){V.canBorderColor(f,X,b)}}if(Y<U.y){var f=this.shiftGridCell!=null?this.shiftGridCell:this.selectedGridCell;var e=this.selectedGridCell.rowNum;var W=this.selectedGridCell.colNum;var c=this.tb.find("tr:lt("+e+")");c.each(function(j){var k=A(this).find("td:eq("+W+")");if(k.offset().top+A(this).height()/2>Y){var h=k.data("gc");if(h.rowNum==0){return false}X=h;return false}});if(X!=null){V.canBorderColor(f,X,b)}}}else{if(Z>U.x+U.w){var f=this.selectedGridCell;var a=this.shiftGridCell!=null?this.shiftGridCell:f;var e=a.rowNum;var W=a.colNum;if(e==0||W==0){return }var c=this.tb.find("tr:eq("+e+")");c.find("td:gt("+W+")").each(function(h){if(A(this).offset().left+A(this).width()/2>Z){return false}X=A(this).data("gc")});if(X!=null){V.canBorderColor(f,X,b)}}if(Z<U.x){var f=this.shiftGridCell!=null?this.shiftGridCell:this.selectedGridCell;var e=this.selectedGridCell.rowNum;var W=this.selectedGridCell.colNum;var c=this.tb.find("tr:eq("+e+")");c.find("td:lt("+W+")").each(function(j){if(A(this).offset().left+A(this).width()/2>Z){var h=A(this).data("gc");if(h.colNum==0){return false}X=h;return false}});if(X!=null){V.canBorderColor(f,X,b)}}}};G.prototype.font=function(W,U){if(this.selectedGridCell==null){return }var a=this.selectedGridCell;var Z=this.shiftGridCell!=null?this.shiftGridCell:a;for(var Y=a.rowNum;Y<=Z.rowNum+Z.rowSpan-1;Y++){for(var V=a.colNum;V<=Z.colNum+Z.colSpan-1;V++){var X=this.findTd(Y,V);if(W==0){if(U){X.addClass("bold")}else{X.removeClass("bold")}}else{if(W==1){if(U){X.addClass("italic")}else{X.removeClass("italic")}}else{if(W==2){if(U){X.addClass("underline")}else{X.removeClass("underline")}}}}}}};G.prototype.fontColor=function(W){if(this.selectedGridCell==null){return }var b=this.selectedGridCell;var U=this.shiftGridCell!=null?this.shiftGridCell:b;for(var Z=b.rowNum;Z<=U.rowNum+U.rowSpan-1;Z++){for(var Y=b.colNum;Y<=U.colNum+U.colSpan-1;Y++){var c=this.findTd(Z,Y);if(W!=""){c.css("color",W);continue}var X="";var V=c.attr("style");if(V!=undefined&&V!=""){var a=V.split(";");for(var d=0;Z<a.length;d++){if(a[d].indexOf("color")!=-1){continue}if(a[d]==""){continue}X+=a[d]+";"}if(X==""){c.removeAttr("style")}else{c.attr("style",X)}}}}};G.prototype.fontSize=function(d){if(this.selectedGridCell==null){return }var a=this.selectedGridCell;var U=this.shiftGridCell!=null?this.shiftGridCell:a;for(var Y=a.rowNum;Y<=U.rowNum+U.rowSpan-1;Y++){for(var X=a.colNum;X<=U.colNum+U.colSpan-1;X++){var b=this.findTd(Y,X);if(d!=12){b.css("font-size",d);continue}var W="";var V=b.attr("style");if(V!=undefined&&V!=""){var Z=V.split(";");for(var c=0;c<Z.length;c++){if(Z[c].indexOf("font-size")!=-1){continue}if(Z[c]==""){continue}W+=Z[c]+";"}if(W==""){b.removeAttr("style")}else{b.attr("style",W)}}}}};G.prototype.backgroundColor=function(W){if(this.selectedGridCell==null){return }var b=this.selectedGridCell;var U=this.shiftGridCell!=null?this.shiftGridCell:b;for(var Z=b.rowNum;Z<=U.rowNum+U.rowSpan-1;Z++){for(var Y=b.colNum;Y<=U.colNum+U.colSpan-1;Y++){var c=this.findTd(Z,Y);if(W!=""){c.css("background",W);continue}var X="";var V=c.attr("style");if(V!=undefined&&V!=""){var a=V.split(";");for(var d=0;d<a.length;d++){if(a[d].indexOf("background")!=-1){continue}if(a[d]==""){continue}X+=a[d]+";"}if(X==""){c.removeAttr("style")}else{c.attr("style",X)}}}}};G.prototype.style=function(a){var W={};var Z=A(a).attr("style");if(Z!=undefined&&Z!=""){var Y=Z.split(";");for(var V=0;V<Y.length;V++){var U=Y[V].split(":");var X=A.trim(U[1]);if(X.indexOf("rgb")!=-1){X=this.colorRGB2Hex(X)}W[A.trim(U[0])]=X}}return W};G.prototype.colorRGB2Hex=function(V){var W=V.split(",");var Z=parseInt(W[0].split("(")[1]);var Y=parseInt(W[1]);var U=parseInt(W[2].split(")")[0]);var X="#"+((1<<24)+(Z<<16)+(Y<<8)+U).toString(16).slice(1);return X};G.prototype.align=function(Z){if(this.selectedGridCell==null){return }var Y=this.selectedGridCell;var X=this.shiftGridCell!=null?this.shiftGridCell:Y;for(var W=Y.rowNum;W<=X.rowNum+X.rowSpan-1;W++){for(var U=Y.colNum;U<=X.colNum+X.colSpan-1;U++){var V=this.findTd(W,U);V.attr("align",Z)}}};G.prototype.valign=function(X){if(this.selectedGridCell==null){return }var Z=this.selectedGridCell;var Y=this.shiftGridCell!=null?this.shiftGridCell:Z;for(var W=Z.rowNum;W<=Y.rowNum+Y.rowSpan-1;W++){for(var U=Z.colNum;U<=Y.colNum+Y.colSpan-1;U++){var V=this.findTd(W,U);V.attr("valign",X);V.removeClass("vtop").removeClass("vmiddle").removeClass("vbottom");if(X=="top"){V.addClass("vtop")}else{if(X=="middle"){V.addClass("vmiddle")}else{if(X=="bottom"){V.addClass("vbottom")}}}}}};G.prototype.clearCell=function(X){var W=A(X.o);if(X.drawing){X.drawing=undefined;var Y=X.rowNum;var V=X.colNum;A("#"+Y+"-"+V).remove();var U=X.celllines;if(U){for(var Z=0;Z<U.length;Z++){A(U[Z]).remove()}}X.celllines=undefined}W.removeAttr("align");W.removeAttr("valign");W.removeAttr("class");W.removeAttr("style");W.empty();X.borderColor=undefined;X.mark=-2;X.isRemove=false;X.mergeCell=null;X.content=new Content()};G.prototype.clear=function(){if(this.selectedGridCell==null){return }var Y=this.selectedGridCell;var X=this.shiftGridCell!=null?this.shiftGridCell:Y;for(var W=Y.rowNum;W<=X.rowNum+X.rowSpan-1;W++){for(var U=Y.colNum;U<=X.colNum+X.colSpan-1;U++){var V=this.findTd(W,U);this.clearCell(V.data("gc"))}}};G.prototype.formatId=function(a){if(this.selectedGridCell==null){return }var Z=this.selectedGridCell;var X=this.shiftGridCell!=null?this.shiftGridCell:Z;for(var W=Z.rowNum;W<=X.rowNum+X.rowSpan-1;W++){for(var U=Z.colNum;U<=X.colNum+X.colSpan-1;U++){var V=this.findTd(W,U);var Y=V.data("gc");Y.content["formatId"]=a}}};G.prototype.cellAreaBorderColor=function(h,X){if(this.selectedGridCell==null){return }var f=function(i){var j=i.data("gc");var k=j.borderColor;if(k){return k}j.borderColor={};return j.borderColor};var c=this.selectedGridCell;var U=this.shiftGridCell!=null?this.shiftGridCell:c;if(h==0){for(var a=c.rowNum;a<=U.rowNum+U.rowSpan-1;a++){for(var Z=c.colNum;Z<=U.colNum+U.colSpan-1;Z++){if(a==U.rowNum+U.rowSpan-1){var g=this.findTd(a,Z);var V=g.data("gc");if(V.isRemove){g=A(V.mergeCell.o)}var W=f(g);W[h]=X;g.css("border-bottom","1px solid "+X)}}}}else{if(h==1){for(var a=c.rowNum;a<=U.rowNum+U.rowSpan-1;a++){for(var Z=c.colNum;Z<=U.colNum+U.colSpan-1;Z++){if(a==c.rowNum){var g=this.findTd(a,Z);var V=g.data("gc");if(V.isRemove){g=A(V.mergeCell.o)}var W=f(g);W[h]=X;g.css("border-top","1px solid "+X)}}}}else{if(h==2){for(var a=c.rowNum;a<=U.rowNum+U.rowSpan-1;a++){for(var Z=c.colNum;Z<=U.colNum+U.colSpan-1;Z++){if(Z==c.colNum){var g=this.findTd(a,Z);var V=g.data("gc");if(V.isRemove){g=A(V.mergeCell.o)}var W=f(g);W[h]=X;g.css("border-left","1px solid "+X)}}}}else{if(h==3){for(var a=c.rowNum;a<=U.rowNum+U.rowSpan-1;a++){for(var Z=c.colNum;Z<=U.colNum+U.colSpan-1;Z++){if(Z==U.colNum+U.colSpan-1){var g=this.findTd(a,Z);var V=g.data("gc");if(V.isRemove){g=A(V.mergeCell.o)}var W=f(g);W[h]=X;g.css("border-right","1px solid "+X)}}}}else{if(h==4){for(var a=c.rowNum;a<=U.rowNum+U.rowSpan-1;a++){for(var Z=c.colNum;Z<=U.colNum+U.colSpan-1;Z++){var g=this.findTd(a,Z);var V=g.data("gc");if(V.isRemove){g=A(V.mergeCell.o)}var e=g.attr("style");var V=g.data("gc");V.borderColor=undefined;if(!C.isUndefined(e)){var Y="";var b=e.split(";");for(var d=0;d<b.length;d++){if(b[d]==""){continue}if(b[d].indexOf("border-bottom")!=-1||b[d].indexOf("border-top")!=-1||b[d].indexOf("border-left")!=-1||b[d].indexOf("border-right")!=-1||b[d].indexOf("border")!=-1){continue}Y+=(b[d]+";")}if(Y==""){g.removeAttr("style")}else{g.attr("style",Y)}}}}}else{if(h==5){for(var a=c.rowNum;a<=U.rowNum+U.rowSpan-1;a++){for(var Z=c.colNum;Z<=U.colNum+U.colSpan-1;Z++){var g=this.findTd(a,Z);var V=g.data("gc");var V=g.data("gc");if(V.isRemove){g=A(V.mergeCell.o)}var W={};W[h]=X;V.borderColor=W;g.css("border","1px solid "+X)}}}else{if(h==6){this.cellAreaBorderColor(0,X);this.cellAreaBorderColor(1,X);this.cellAreaBorderColor(2,X);this.cellAreaBorderColor(3,X)}}}}}}}};G.prototype.tdBorderColor=function(X){if(!X.borderColor){return }var V=A(X.o);var Y=X.borderColor;for(var W in Y){var U=Y[W];this.tdDrawBorderColor(V,W,U)}};G.prototype.tdDrawBorderColor=function(V,W,U){U=U.startsWith("#")?U:"#"+U;if(W==0){V.css("border-bottom","1px solid "+U)}else{if(W==1){V.css("border-top","1px solid "+U)}else{if(W==2){V.css("border-left","1px solid "+U)}else{if(W==3){V.css("border-right","1px solid "+U)}else{if(W==5){V.css("border","1px solid "+U)}else{if(W==6){this.tdDrawBorderColor(V,0,U);this.tdDrawBorderColor(V,1,U);this.tdDrawBorderColor(V,2,U);this.tdDrawBorderColor(V,3,U)}}}}}}};G.prototype.setDyncBackground=function(X){if(this.selectedGridCell==null){return }var b=this.selectedGridCell;var Y=this.shiftGridCell!=null?this.shiftGridCell:b;for(var W=b.rowNum;W<=Y.rowNum+Y.rowSpan-1;W++){for(var U=b.colNum;U<=Y.colNum+Y.colSpan-1;U++){var V=this.findTd(W,U);var a=V.data("gc");var Z={};Z.oddBackgroundColor=X.oddBackgroundColor;Z.evenBackgroundColor=X.evenBackgroundColor;a.content.cellSelectStyle=X}}};G.prototype.getMaxMinCellNum=function(){var a=1;var c=1;var Z=this.tb.find("tr");for(var Y=1;Y<Z.length;Y++){var X=A(Z[Y]).find("td");for(var W=1;W<X.length;W++){var V=A(X[W]);var U=V.data("gc");if(U.mark!=-2||U.isValid()){a=Math.max(a,U.rowNum+U.rowSpan-1);c=Math.max(c,U.colNum+U.colSpan-1)}if(U.mark!=1){continue}var b=V.text()}}return[a,c]};G.prototype.getSelectComps=function(U){var f=new Array();if(!U){return f}var d=this.tb.find("tr");for(var a=1;a<d.length;a++){var Z=A(d[a]).find("td");for(var Y=1;Y<Z.length;Y++){var W=A(Z[Y]);var V=W.data("gc");if(V.isRemove){continue}if(V.mark!=2){continue}var e=V.content;var b=e.components;if(b==undefined||b.length==0){continue}var X=b[0];if(X.name==undefined||X.name==""){continue}if(U==X.name){continue}f.push(X.name)}}var c=jform.hiddens;if(c){for(var a=0;a<c.length;a++){f.push(c[a].name)}}return f};G.prototype.getHtmlCells=function(){var Y=new Array();var U=this.tb.find("tr");for(var W=1;W<U.length;W++){var X=A(U[W]).find("td");for(var V=1;V<X.length;V++){var b=A(X[V]);var Z=b.data("gc");if(Z.isRemove){continue}if(Z.mark==0){var a=b.find("span").html();Y.push({colNum:Z.colNum,text:a})}}}return Y};G.prototype.getFormComponentByName=function(X){var U=this.tb.find("tr");for(var W=1;W<U.length;W++){var Y=A(U[W]).find("td");for(var V=1;V<Y.length;V++){var b=A(Y[V]);var a=b.data("gc");if(a.isRemove){continue}if(a.mark!=2){continue}var Z=a.getFormComponent();if(Z!=null&&X==Z.name){return Z}}}return null};G.prototype.getFormHiddenByName=function(W){var V=jform.hiddens;if(V==undefined){return null}for(var U=0;U<V.length;U++){var X=V[U];if(X.name==W){return X}}return null};G.prototype.getComponentCell=function(X){var U=this.tb.find("tr");for(var W=1;W<U.length;W++){var Y=A(U[W]).find("td");for(var V=1;V<Y.length;V++){var b=A(Y[V]);var a=b.data("gc");if(a.isRemove){continue}if(a.mark!=2){continue}var Z=a.getFormComponent();if(Z!=null&&X==Z.name){return a}}}return null};G.prototype.isConditionType=function(V){var U=V.editStyle;if(U==1||U==2||U==3||U==4||U==21||U==10||U==20||U==7||U==5||U==17){return true}return false};G.prototype.getComponentCells=function(){var W=new Array();var U=this.tb.find("tr");for(var X=1;X<U.length;X++){var Y=A(U[X]).find("td");for(var V=1;V<Y.length;V++){var a=A(Y[V]);var Z=a.data("gc");if(Z.isRemove){continue}if(Z.mark!=2){continue}W.push(Z)}}return W};G.prototype.getArgNames=function(){var c=new Array();c.push("");var b=this.tb.find("tr");for(var Z=1;Z<b.length;Z++){var Y=A(b[Z]).find("td");for(var X=1;X<Y.length;X++){var W=A(Y[X]);var U=W.data("gc");if(U.isRemove){continue}if(U.mark!=2){continue}var V=U.content;if(V.name!=undefined&&V.name!=""){c.push("$"+V.name)}}}var a=jform.hiddens;if(a){for(var Z=0;Z<a.length;Z++){c.push("$"+a[Z].name)}}c.push("$_userId");c.push("$_userName");c.push("$_personName");c.push("$_orgId");c.push("$_orgName");c.push("$_userPhone");c.push("$_userEmail");return c};G.prototype.startDrawCellLine=function(o,a,Z){var e=a!=undefined?a:50;var d=Z!=undefined?Z:10;var U=this;var Y=A(o.o);var V=Y.position();var p=null;var n=null;var j=this.tbdiv.find(".celllines");if(o.drawing||o.drawing!=null){p=o.drawing;n=o.celllines}else{var m=o.rowNum;var W=o.colNum;var f=A("<div></div>").attr("id",m+"-"+W).css("position","absolute").css("pointer-events","none").css("left",V.left).css("top",V.top);j.append(f);var b=SVG(m+"-"+W);b.attr({"width":Y.outerWidth(),"height":Y.outerHeight()});o.drawing=b;p=b;n=new Array()}var X=A("<div></div>").css("position","absolute").width(6).height(6).css("border","1px solid red");X.css("left",V.left+e).css("top",V.top+d);j.append(X);var h="M"+0+","+0+"L"+e+","+d;var c=p.path(h);c.attr({"stroke":"#000000","stroke-width":1});X.data("l",c);X.data("t",Y);n.push(X);o.celllines=n;var k=null;var g=function(t){var r=t.position();var s=t.data("l");var v=A(t.data("t"));var u=v.position();var q="M"+0+","+0+"L"+(r.left-u.left)+","+(r.top-u.top);s.attr({"d":q})};var i=function(r){if(k==null){return false}var q=k.posix;k.css({"top":r.pageY-q.y,"left":r.pageX-q.x});g(k);return false};var l=function(r){A(document).unbind("mousemove",i).unbind("mouseup",l);if(k==null){return false}var q=k.posix;k.css({"top":r.pageY-q.y,"left":r.pageX-q.x});g(k);k=null};X.mousedown(function(t){var w=A("#report-excel").scrollLeft();var s=A("#report-excel").scrollTop();var v=A(this).position();k=A(this);k.posix={x:t.pageX-v.left-w,y:t.pageY-v.top-s};A(document).bind("mousemove",i).bind("mouseup",l);var x=A(A(this).data("t"));var q=m+"-"+W;var u=A("#"+q);u.width(x.width()).height(x.height());var r=x.data("gc");if(r.drawing){r.drawing.attr({"width":x.outerWidth(),"height":x.outerHeight()})}})};G.prototype.setGridCellWidth=function(W){if(this.selectedGridCell==null){return }var U=this.selectedGridCell.colNum;var V=this.tb.find("tr:first");var X=V.find("td:eq("+U+")");this.syncGridColDivs(X,W);X.width(W);this.syncGrids()};G.prototype.getFirstGridCellWidth=function(W){var U=W.colNum;var V=this.tb.find("tr:first");var X=V.find("td:eq("+U+")");return X.width()};G.prototype.setFirstGridCellWidth=function(X,W){var U=X.colNum;var V=this.tb.find("tr:first");var Y=V.find("td:eq("+U+")");this.syncGridColDivs(Y,W);Y.width(W);this.syncGrids()};G.prototype.setGridCellHeight=function(U){if(this.selectedGridCell==null){return }var W=this.selectedGridCell.rowNum;var V=this.tb.find("tr:eq("+W+")");var X=V.find("td:first");this.syncGridRowDivs(X,U);X.height(U);this.syncGrids()};G.prototype.setFirstGridCellHeight=function(W,U){var X=W.rowNum;var V=this.tb.find("tr:eq("+X+")");var Y=V.find("td:first");this.syncGridRowDivs(Y,U);Y.height(U);this.syncGrids()};G.prototype.getFirstGridCellHeight=function(V){var W=V.rowNum;var U=this.tb.find("tr:eq("+W+")");var X=U.find("td:first");return X.height()};G.prototype.getGridCell=function(b,U,a,Z){b=b+1;U=U+1;var c=this.tb.find("tr").length;var W=this.tb.find("tr:eq(0)").children("td").length;if(b+a>=c){for(var Y=0;Y<=((b+a)-c);Y++){this.newAddRow()}}if(U+Z>=W){for(var Y=0;Y<=((U+Z)-W);Y++){this.newAddColumn()}}var X=this.findTd(b,U);var V=X.data("gc");V.rowSpan=a;V.colSpan=Z;V.rowNum=b;V.colNum=U;this.mergeTdCell(V);return V};G.prototype.clearAll=function(){var a=this;var U=this.tb.find("tr");for(var Y=1;Y<U.length;Y++){var Z=A(U[Y]).find("td");for(var W=1;W<Z.length;W++){var X=A(Z[W]);var b=X.data("gc");this.clearCell(b);if(b.rowSpan>1||b.colSpan>1){this.unMergeCell(b)}}}var V=this.tb.find("tr:eq(0)");V.find("td").each(function(c){var d=A(this);d.find("i").remove();if(c>0){d.width(a.colWidth);d.find("div").width(a.colWidth)}});var U=this.tb.find("tr");for(var Y=1;Y<U.length;Y++){var Z=A(U[Y]).find("td");var X=A(Z[0]);X.find("i").remove();X.height(a.rowHeight);X.find("div").height(a.rowHeight)}jform=new Jform();anyExcel.clearLeftDatasetTree()};var C={isUndefined:function(U){return U==null||U==undefined},getLetter:function(W){var U=64,X=26;if(W<=U){return""}if(W<=U+X){return String.fromCharCode(W)}var Y=W-U;var V=Math.floor(Y/X);if(V>=X){return""}var Z=W-V*X;if(Z==U){Z=U+X;V=V-1}return String.fromCharCode(U+V)+String.fromCharCode(Z)},getCellReference:function(U){var W=U.length;var a=0;for(;a<W;a++){var V=U.charAt(a);if(!isNaN(Number(V))){break}}var X=U.substring(0,a);var Z=U.substr(a);var Y=new Array();Y.push(parseInt(Z));Y.push(C.convertColStringToIndex(X));return Y},convertColStringToIndex:function(X){var Y=0;var V=0;for(var W=X.length-1;W>=0;W--){var U=parseInt(Math.pow(26,Y));V+=(X.charCodeAt(W)-63)*U;Y++}return V-1},calMergeGridCell:function(Z,a,V){var b=0;var Y=0;var W=0;var U=0;if(a.rowNum+a.rowSpan-1>=Z.rowNum+Z.rowSpan-1){b=Z.rowNum+Z.rowSpan-1;Y=a.rowNum+a.rowSpan-1}else{b=a.rowNum+a.rowSpan-1;Y=Z.rowNum+Z.rowSpan-1}if(a.colNum+a.colSpan-1>=Z.colNum+Z.colSpan-1){W=Z.colNum+Z.colSpan-1;U=a.colNum+a.colSpan-1}else{W=a.colNum+a.colSpan-1;U=Z.colNum+Z.colSpan-1}var X=new K();X.firstRow=b;X.lastRow=Y;X.firstCol=W;X.lastCol=U;C.rectangleGridCell(X,V);return X},rectangleGridCell:function(a,U){var Y=A(U[a.firstRow]).find("td");var b;for(var V=a.firstCol;V<=a.lastCol;V++){b=A(Y[V]).data("gc");if(b.isRemove){a.setRect(b.mergeCell)}if(b.mergeCell){a.setRect(b)}}for(var W=a.firstRow+1;W<=a.lastRow;W++){Y=A(U[a.firstRow]).find("td");b=A(Y[a.firstCol]).data("gc");if(b.isRemove){a.setRect(b.mergeCell)}if(b.mergeCell){a.setRect(b)}}for(var X=a.firstRow+1;X<=a.lastRow;X++){Y=A(U[X]).find("td");b=A(Y[a.lastCol]).data("gc");if(b.isRemove){a.setRect(b.mergeCell)}if(b.mergeCell){a.setRect(b)}}for(var Z=a.firstCol+1;Z<a.lastCol;Z++){Y=A(U[a.lastRow]).find("td");b=A(Y[Z]).data("gc");if(b.isRemove){a.setRect(b.mergeCell)}if(b.mergeCell){a.setRect(b)}}if(a.isGoRectangle()){a.isRectangle=true;C.rectangleGridCell(a,U)}}};var B=new G();B.init();return B}})(jQuery)