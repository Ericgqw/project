var FormXml=function(){this.findName="form.xml"};FormXml.prototype.htmlEncode=function(A){return $("<div/>").text(A).html()};FormXml.prototype.stringify=function(I){var G=grid.getMaxMinCellNum();var J=G[0];var R=G[1];var O=JSXML.fromString('<?xml version="1.0" encoding="UTF-8"?><jform/>');var K=O.createElement("name");K.textContent=I.name!=undefined?I.name:"";O.documentElement.appendChild(K);if(I.relative!=undefined){var D=O.createElement("relative");D.textContent=I.relative;O.documentElement.appendChild(D)}if(I.developer!=undefined){var N=this.createDeveloperNode(I.developer,O);if(N.childNodes.length>0){O.documentElement.appendChild(N)}}if(I.ds){var B=this.createDataSetNode(I.ds,O);if(B.childNodes.length>0){O.documentElement.appendChild(B)}}var C=O.createElement("canvas");C.appendChild(this.createColumns(J,R,O));C.appendChild(this.createRows(J,R,O));O.documentElement.appendChild(C);var P=this.createHiddens(O);if(P!=null){O.documentElement.appendChild(P)}var M=this.createCellsNode(J,R,O);if(M.childNodes.length>0){O.documentElement.appendChild(M)}var L=I.database;if(L!=null){var A=O.createElement("mapping");this.createMappingXmlNode(A,L,O);O.documentElement.appendChild(A)}if(I.fileImport!=undefined){var Q=this.createFileImportNode(I.fileImport,O);if(Q.childNodes.length>0){O.documentElement.appendChild(Q)}}if(I.attr!=undefined){var H=this.createAttr(I.attr,O);if(H.childNodes.length>0){O.documentElement.appendChild(H)}}var F=I.reportXml;if(F!=undefined){var E=O.createElement("list");E.textContent=F;O.documentElement.appendChild(E)}return JSXML.stringify(O)};FormXml.prototype.stringRptXml=function(X){var Z=X.dataList;if(Z==null){return""}var B=JSXML.fromString('<?xml version="1.0" encoding="UTF-8"?><report/>');var M=B.createElement("name");M.textContent="";var Y=B.createElement("pageSize");Y.textContent=20;var d=B.createElement("exportFlag");d.textContent=590;var O=B.createElement("reportType");O.textContent=1;B.documentElement.appendChild(M);B.documentElement.appendChild(Y);B.documentElement.appendChild(d);var Q=Z.table;var L=Z.conditions;var P=function(){var m=Q.columns;for(var k=0;k<m.length;k++){var n=m[k];if(n.isPk==1){return n}}return null};var W=this.buildDataSet(Q,L);if(W!=undefined&&W.length>0){var I=this.createDataSetNodes(W,B);if(I.childNodes.length>0){B.documentElement.appendChild(I)}}var C=B.createElement("cells");var A=B.createElement("args");if(L!=null){var b=0;var h=0;var V=false;for(var e=0;e<L.length;e++){var c=L[e];var J=grid.getComponentCell(c.formName);var l=grid.getFormComponentByName(c.formName);if(J==null||l==null){continue}if(!grid.isConditionType(l)){continue}if(V){b++;if(b==6){b=0;h++}}var G={};G.rowNum=h;G.colNum=b;G.rowSpan=1;G.colSpan=1;G.width=100;G.height=20;var K=this.createRptHtmlCellXmlNode(G,c.formNameDesc,B);A.appendChild(K);b++;var D=this.createRptConditionCellXmlNode(J,l,h,b,B);A.appendChild(D);V=true}B.documentElement.appendChild(A)}var E=Z.lists;for(var g=0;g<E.length;g++){var c=E[g];if(g==0){var N=P();if(N!=null){var R={};R.rowNum=0;R.colNum=0;R.rowSpan=1;R.colSpan=1;R.width=100;var S={};S.printerFlag=1;S.fileOutFlag=1;R.content=S;var j=this.createRptHtmlCellXmlNode(R,"",B);C.appendChild(j);var U={};U.rowNum=1;U.colNum=0;U.rowSpan=1;U.colSpan=1;U.width=100;var T={};T.columnType=2;T.disType=1;T.printerFlag=1;T.fileOutFlag=1;T.contentType=2;T.expression="<input type='checkbox' value='${fm."+N.columnName+"}'/>";U.content=T;var a=this.createRptColumnCellXmlNode(U,"=fm."+N.columnName,B);C.appendChild(a)}}var R={};R.rowNum=0;R.colNum=g+1;R.rowSpan=1;R.colSpan=1;R.width=100;var j=this.createRptHtmlCellXmlNode(R,c.formNameDesc,B);C.appendChild(j);var f={};f.rowNum=1;f.colNum=g+1;f.rowSpan=1;f.colSpan=1;f.width=100;var F={};F.columnType=2;F.disType=1;f.content=F;var H=this.createRptColumnCellXmlNode(f,"=fm."+c.columnName,B);C.appendChild(H)}B.documentElement.appendChild(C);return JSXML.stringify(B)};FormXml.prototype.stringMappingXml=function(A){var B=JSXML.fromString('<?xml version="1.0" encoding="UTF-8"?><mapping/>');this.createMappingXmlNode(B.documentElement,A,B);return JSXML.stringify(B)};FormXml.prototype.buildDataSet=function(K,J){var L="SELECT * FROM "+K.name;if(J!=null&&J.length>0){L=L+" WHERE ";for(var G=0;G<J.length;G++){var C=J[G];L=L+C.columnName+"="+(C.dataType==1?"':"+C.formName+"'":":"+C.formName);if(G<J.length-1){L+=" and "}}}var D=new Array();var H={};H.name="fm";H.sourceName=jform.database.sourceName;H.sql=L;H.pageSize=20;D.push(H);if(J!=null){for(var E=0;E<J.length;E++){var B=J[E];var A=grid.getFormComponentByName(B.formName);if(A==null){continue}var F=A.data;if(F==undefined){continue}var I=F.dataSql;if(I==undefined){continue}if(I.dsName!=undefined){var H=jform.ds[I.dsName];if(H!=undefined){D.push(H)}}}}return D};FormXml.prototype.createDeveloperNode=function(I,D){var G=D.createElement("developer");if(I.jsCode!=undefined){var B=D.createElement("jsCode");B.textContent=I.jsCode;G.appendChild(B)}if(I.cssCode!=undefined){var H=D.createElement("cssCode");H.textContent=I.cssCode;G.appendChild(H)}if(I.files!=undefined){var A=I.files;for(var E=0;E<A.length;E++){var C=A[E];var F=D.createElement("file");F.setAttribute("jslib",C.jslib);F.setAttribute("jsPath",C.jsPath);G.appendChild(F)}}return G};FormXml.prototype.createRptHtmlCellXmlNode=function(D,H,F){var B=F.createElement("htmlcell");B.setAttribute("w",D.width);B.setAttribute("h",D.height);B.setAttribute("rowNum",D.rowNum);B.setAttribute("colNum",D.colNum);B.setAttribute("rowSpan",D.rowSpan);B.setAttribute("colSpan",D.colSpan);var C=F.createElement("orgName");C.textContent=H;B.appendChild(C);var A=F.createElement("name");A.textContent=H;B.appendChild(A);var G=D.content;if(G!=undefined){if(G.printerFlag!=undefined){var I=F.createElement("printerFlag");I.textContent=G.printerFlag;B.appendChild(I)}if(G.fileOutFlag!=undefined){var E=F.createElement("fileOutFlag");E.textContent=G.fileOutFlag;B.appendChild(E)}}return B};FormXml.prototype.createRptColumnCellXmlNode=function(D,L,F){var B=F.createElement("columncell");B.setAttribute("w",D.width);B.setAttribute("h",D.height);B.setAttribute("rowNum",D.rowNum);B.setAttribute("colNum",D.colNum);B.setAttribute("rowSpan",D.rowSpan);B.setAttribute("colSpan",D.colSpan);var C=F.createElement("orgName");C.textContent=L;B.appendChild(C);var A=F.createElement("name");A.textContent=L;B.appendChild(A);var I=D.content;if(I.contentType!=undefined){var G=F.createElement("contentType");G.textContent=I.contentType;B.appendChild(G)}if(I.columnType!=undefined){var J=F.createElement("columnType");J.textContent=I.columnType;B.appendChild(J)}if(I.disType!=undefined){var H=F.createElement("disType");H.textContent=I.disType;B.appendChild(H)}if(I.expression!=undefined){var M=F.createElement("expression");M.textContent=I.expression;B.appendChild(M)}if(I.printerFlag!=undefined){var K=F.createElement("printerFlag");K.textContent=I.printerFlag;B.appendChild(K)}if(I.fileOutFlag!=undefined){var E=F.createElement("fileOutFlag");E.textContent=I.fileOutFlag;B.appendChild(E)}return B};FormXml.prototype.createRptConditionCellXmlNode=function(V,j,h,X,B){var i=B.createElement("conditioncell");i.setAttribute("w",j.width+10);i.setAttribute("h",V.height);i.setAttribute("rowNum",h);i.setAttribute("colNum",X);i.setAttribute("rowSpan",1);i.setAttribute("colSpan",1);if(j.width!=undefined){var A=B.createElement("width");A.textContent=j.width;i.appendChild(A)}if(j.height!=undefined){var P=B.createElement("height");P.textContent=j.height;i.appendChild(P)}if(j.name!=undefined){var d=B.createElement("name");d.textContent=j.name;i.appendChild(d)}if(j.dataType!=undefined){var E=B.createElement("dataType");E.textContent=j.dataType;i.appendChild(E)}if(j.defaultValue!=undefined){var K=B.createElement("defaultValue");K.textContent=j.defaultValue;i.appendChild(K);if(j.defaultValueType!=undefined){var f=B.createElement("defaultValueType");f.textContent=j.defaultValueType;i.appendChild(f)}}var U=j.editStyle;if(U==17){U=1}var e=B.createElement("editStyle");e.textContent=U;i.appendChild(e);var g=j.data;if(U==2||U==10){var b=B.createElement("select");if(U==2){var W=g.dataMap;b.setAttribute("datatype",1);for(var Q in W){var H=B.createElement("option");H.setAttribute("value",Q);H.textContent=W[Q];b.appendChild(H)}}else{b.setAttribute("datatype",2);var C=g.dataSql;var F=B.createElement("code");F.textContent=C.code;var a=B.createElement("label");a.textContent=C.label;var c=B.createElement("dsName");c.textContent=C.dsName;b.appendChild(F);b.appendChild(a);b.appendChild(c)}i.appendChild(b)}else{if(U==3){if(j.dateFormat!=undefined){var M=B.createElement("dateFormat");M.textContent=j.dateFormat;i.appendChild(M)}}else{if(U==4){var L=g.dataSql;var I=B.createElement("tree");var T=B.createElement("code");T.textContent=L.code;var S=B.createElement("pcode");S.textContent=L.pcode;var D=B.createElement("queryCode");D.textContent=L.queryCode;var G=B.createElement("label");G.textContent=L.label;var J=B.createElement("dsName");J.textContent=L.dsName;I.appendChild(T);I.appendChild(S);I.appendChild(D);I.appendChild(G);I.appendChild(J);i.appendChild(I)}else{if(U==5){var R=g.dataMap;if(R){var Y=U==5?"radio":"check";var Z=B.createElement("group");for(var O in R){var N=B.createElement(Y);N.setAttribute("label",R[O]);N.setAttribute("value",O);Z.appendChild(N)}i.appendChild(Z)}}}}}return i};FormXml.prototype.stringifyDataSet=function(A){var C=JSXML.fromString('<?xml version="1.0" encoding="UTF-8"?><datasets/>');var B=this.createDataset(A,C);C.documentElement.appendChild(B);return JSXML.stringify(C)};FormXml.prototype.createDataSetNode=function(C,E){var B=E.createElement("datasets");for(var D in C){var A=C[D];if(A!=undefined){B.appendChild(this.createDataset(A,E))}}return B};FormXml.prototype.createDataSetNodes=function(D,E){var C=E.createElement("datasets");for(var B=0;B<D.length;B++){var A=D[B];if(A!=undefined){C.appendChild(this.createDataset(A,E))}}return C};FormXml.prototype.createDataset=function(Q,S){var L=S.createElement("dataset");var T=S.createElement("name");T.textContent=Q.name;var U=S.createElement("source");U.textContent=Q.sourceName;var W=S.createElement("sql");W.textContent=Q.sql;var O=S.createElement("pageSize");O.textContent=Q.pageSize!=undefined?Q.pageSize:0;var E=S.createElement("type");E.textContent=Q.type!=undefined?Q.type:0;L.appendChild(T);L.appendChild(U);L.appendChild(W);L.appendChild(O);L.appendChild(E);if(Q.parser!=undefined){var C=S.createElement("parser");C.textContent=Q.parser;L.appendChild(C)}var D=Q.columns;if(D&&D.length>0){var H=S.createElement("columns");for(var R=0;R<D.length;R++){var V=S.createElement("column");V.textContent=D[R];H.appendChild(V)}if(H.childNodes.length>0){L.appendChild(H)}}var F=Q.args;if(F!=undefined&&F.length>0){var B=S.createElement("args");for(var R=0;R<F.length;R++){var J=F[R];var I=S.createElement("arg");if(J.name!=undefined){var P=S.createElement("name");P.textContent=J.name;I.appendChild(P)}if(J.dataType!=undefined){var G=S.createElement("dataType");G.textContent=J.dataType;I.appendChild(G)}if(J.dateFormat!=undefined){var X=S.createElement("dateFormat");X.textContent=J.dateFormat;I.appendChild(X)}if(J.value!=undefined){var K=S.createElement("value");K.textContent=J.value;I.appendChild(K)}if(J.defaultValueType!=undefined){var M=S.createElement("defaultValueType");M.textContent=J.defaultValueType;I.appendChild(M)}if(J.defaultValue!=undefined){var A=S.createElement("defaultValue");A.textContent=J.defaultValue;I.appendChild(A)}if(J.modelType!=undefined){var N=S.createElement("modelType");N.textContent=J.modelType;I.appendChild(N)}B.appendChild(I)}L.appendChild(B)}return L};FormXml.prototype.createColumns=function(B,E,F){var D=F.createElement("columns");for(var A=1;A<=E;A++){var G=grid.findTd(0,A);var C=F.createElement("column");C.setAttribute("w",Math.round(G.width()));D.appendChild(C)}return D};FormXml.prototype.createRows=function(B,E,F){var A=F.createElement("rows");for(var C=1;C<=B;C++){var G=grid.findTd(C,0);var D=F.createElement("row");D.setAttribute("h",Math.round(G.height()));A.appendChild(D)}return A};FormXml.prototype.createCellsNode=function(J,K,D){var L=D.createElement("cells");var I=grid.tb.find("tr");for(var F=1;F<=J;F++){var E=$(I[F]).find("td");var G=jform.rowType!=undefined?jform.rowType:{};var H=G[F]!=undefined?G[F]:0;for(var C=1;C<=K;C++){var B=$(E[C]);var A=B.data("gc");if(A.isRemove){continue}if(A.mark==2){L.appendChild(this.createCellXmlNode(A,H,D))}else{if(A.mark==0||A.mark==-1||A.mark==1){L.appendChild(this.createCellXmlNode(A,H,D))}}}}return L};FormXml.prototype.createHiddens=function(D){var H=jform.hiddens?jform.hiddens:{};var J=D.createElement("args");if(!$.isEmptyObject(H)){for(var E=0;E<H.length;E++){var C=D.createElement("hidden");var G=H[E];if(G.name!=undefined){var A=D.createElement("name");A.textContent=G.name;C.appendChild(A)}if(G.dataType!=undefined){var I=D.createElement("dataType");I.textContent=G.dataType;C.appendChild(I)}if(G.dateFormat!=undefined){var K=D.createElement("dateFormat");K.textContent=G.dateFormat;C.appendChild(K)}if(G.defaultValueType!=undefined){var B=D.createElement("defaultValueType");B.textContent=G.defaultValueType;C.appendChild(B)}if(G.defaultValue!=undefined){var F=D.createElement("defaultValue");F.textContent=G.defaultValue;C.appendChild(F)}J.appendChild(C)}}if(J.childNodes.length==0){return null}return J};FormXml.prototype.createCellXmlNode=function(C,I,G){var J=C.content;var M=J.contentType;var L="";var F=C.mark;var D=$(C.o);var B=D.find("span").html();var K=B;var E=null;if(F==0||F==-1){L="htmlcell";E=G.createElement(L);var A=G.createElement("name");if(C.celllines==undefined||C.celllines.length==0){B=B.replace(/&nbsp;/g," ")}A.textContent=B;E.appendChild(A)}else{if(F==1){L="columncell";E=G.createElement(L);var A=G.createElement("name");B=B.replace(/&nbsp;/g," ");A.textContent=B;E.appendChild(A);if(J.formatId!=undefined){var N=G.createElement("formatId");N.textContent=J.formatId;E.appendChild(N)}}else{L="compcell";B=J.columnName;E=G.createElement(L);this.createComponentXmlNode(C.content,E,G);if(I!=0){var H=G.createElement("verticalCount");H.textContent=I;E.appendChild(H)}}}E.setAttribute("w",Math.round(D.width()));E.setAttribute("h",Math.round(D.height()));E.setAttribute("rowNum",C.rowNum-1);E.setAttribute("colNum",C.colNum-1);E.setAttribute("rowSpan",C.rowSpan);E.setAttribute("colSpan",C.colSpan);this.createCellStyle(C,E,G);this.setBorderStyle(E,C,G);this.setCellLines(E,C,G);return E};FormXml.prototype.createComponentXmlNode=function(S,r,D){var E=S;var f=E.components;for(var AE=0;AE<f.length;AE++){var V=f[AE];var u=D.createElement("form");if(V.name!=undefined){var AI=D.createElement("name");AI.textContent=V.name;u.appendChild(AI)}if(V.desc!=undefined){var AA=D.createElement("desc");AA.textContent=V.desc;u.appendChild(AA)}if(V.dataType!=undefined){var L=D.createElement("dataType");L.textContent=V.dataType;u.appendChild(L)}if(V.width!=undefined){var A=D.createElement("width");A.textContent=V.width;u.appendChild(A)}if(V.widthUnit!=undefined){var AF=D.createElement("widthUnit");AF.textContent=V.widthUnit;u.appendChild(AF)}if(V.height!=undefined){var e=D.createElement("height");e.textContent=V.height;u.appendChild(e)}if(V.heightUnit!=undefined){var F=D.createElement("heightUnit");F.textContent=V.heightUnit;u.appendChild(F)}if(V.readOnly!=undefined){var AC=D.createElement("readOnly");AC.textContent=V.readOnly;u.appendChild(AC)}if(V.display!=undefined){var AG=D.createElement("display");AG.textContent=V.display;u.appendChild(AG)}if(V.defaultValueType!=undefined){var AL=D.createElement("defaultValueType");AL.textContent=V.defaultValueType;u.appendChild(AL)}if(V.defaultValue!=undefined){var U=D.createElement("defaultValue");U.textContent=V.defaultValue;u.appendChild(U)}if(V.formatId!=undefined){var O=D.createElement("formatId");O.textContent=V.formatId;u.appendChild(O)}if(V.multiselect!=undefined){var g=D.createElement("multiselect");g.textContent=V.multiselect;u.appendChild(g)}if(V.nowUpload!=undefined){var J=D.createElement("nowUpload");J.textContent=V.nowUpload;u.appendChild(J)}var n=V.editStyle;var AJ=D.createElement("editStyle");AJ.textContent=V.editStyle;u.appendChild(AJ);if(n==2){var AM=V.data;var z=D.createElement("select");var p=AM.dataMap;if(p!=undefined&&p!=null){for(var h in p){if(h==""){continue}var R=D.createElement("option");R.setAttribute("value",h);R.textContent=p[h];z.appendChild(R)}}if(V.linkCmopName!=undefined&&V.linkCmopName!=""){var a=D.createElement("linkCmopName");a.textContent=V.linkCmopName;u.appendChild(a)}u.appendChild(z)}else{if(n==3){if(V.dateFormat!=undefined){var d=D.createElement("dateFormat");d.textContent=V.dateFormat;u.appendChild(d)}}else{if(n==4){var W=V.data.dataSql;var T=D.createElement("tree");var l=D.createElement("code");l.textContent=W.code;var AO=D.createElement("pcode");AO.textContent=W.pcode;var N=D.createElement("label");N.textContent=W.label;var b=D.createElement("saveCode");b.textContent=W.saveCode;var AP=D.createElement("dsName");AP.textContent=W.dsName;T.appendChild(l);T.appendChild(AO);T.appendChild(N);T.appendChild(AP);T.appendChild(b);u.appendChild(T)}else{if(5==n){var AH=V.data;if(AH!=undefined){var j=AH.dataMap;var v=D.createElement("group");if(j!=undefined&&j!=null){for(var Y in j){if(Y==""){continue}var X=D.createElement("radio");X.setAttribute("label",j[Y]);X.setAttribute("value",Y);v.appendChild(X)}}u.appendChild(v)}}else{if(6==n){var AN=V.data;if(AN!=undefined){var AB=AN.dataMap;var C=D.createElement("group");if(AB!=null){for(var B in AB){if(B==""){continue}var t=D.createElement("check");t.setAttribute("label",AB[B]);t.setAttribute("value",B);C.appendChild(t)}}u.appendChild(C)}}else{if(10==n){var x=V.data;var m=D.createElement("select");var H=x.dataSql;var M=D.createElement("code");M.textContent=H.code;var w=D.createElement("label");w.textContent=H.label;var I=D.createElement("dsName");I.textContent=H.dsName;m.appendChild(M);m.appendChild(w);m.appendChild(I);u.appendChild(m);if(V.linkCmopName!=undefined&&V.linkCmopName!=""){var a=D.createElement("linkCmopName");a.textContent=V.linkCmopName;u.appendChild(a)}}else{if(17==n){var k=V.formSequence;if(k!=null&&k.sequences.length>0){var K=D.createElement("sequences");var q=D.createElement("createType");q.textContent=k.createType!=undefined?k.createType:0;K.appendChild(q);for(var AE=0;AE<k.sequences.length;AE++){var c=k.sequences[AE];var s=D.createElement("sequence");var Z=D.createElement("type");Z.textContent=c.type;s.appendChild(Z);var AD=D.createElement("id");AD.textContent=c.id;s.appendChild(AD);if(c.type==0){var y=D.createElement("text");y.textContent=c.text;s.appendChild(y)}else{if(c.type==1){var G=D.createElement("dateFormat");G.textContent=c.dateFormat;s.appendChild(G)}else{if(c.type==2){var Q=D.createElement("numCount");Q.textContent=c.numCount;s.appendChild(Q);var AK=D.createElement("isPrefixZero");AK.textContent=c.isPrefixZero;s.appendChild(AK);var o=D.createElement("isResetTime");o.textContent=c.isResetTime;s.appendChild(o);var P=D.createElement("resetTimeUnit");P.textContent=c.resetTimeUnit;s.appendChild(P)}}}K.appendChild(s)}u.appendChild(K)}}}}}}}}if(V.cmpStyle!=undefined){this.setCmpStyle(u,V.cmpStyle,D)}if(V.validator!=undefined){this.setValidate(u,V.validator,D)}if(V.event!=undefined){this.setEvent(u,V.event,D)}r.appendChild(u)}};FormXml.prototype.createMappingXmlNode=function(D,H,M){var G=H.tables;if(G==undefined){return }var N=function(b){var a=grid.tb.find("tr");for(var Z=1;Z<a.length;Z++){var Y=$(a[Z]).find("td");for(var X=1;X<Y.length;X++){var W=$(Y[X]);var U=W.data("gc");if(U.isRemove){continue}if(U.mark==2){var V=U.getFormComponent();if(V==null){continue}if(V.name!=b){continue}var T=V.validator;if(T==undefined||T.isNull==undefined){return 0}return T.isNull}}}return 0};for(var L=0;L<G.length;L++){var R=G[L];var P=M.createElement("table");P.setAttribute("name",R.name);P.setAttribute("source",H.sourceName);var B=H.schemaName!=undefined?H.schemaName:"";P.setAttribute("schema",B);var C=R.columns;for(var K=0;K<C.length;K++){var E=C[K];var O=M.createElement("column");O.setAttribute("isNull",N(E.formName));O.setAttribute("name",E.columnName);O.setAttribute("formName",E.formName);var Q=E.formNameDesc!=undefined?E.formNameDesc:"";O.setAttribute("formNameDesc",Q);O.setAttribute("length",E.length);O.setAttribute("ispk",E.isPk);O.setAttribute("dataType",E.dataType);var S=(E.optAdd!=undefined&&E.optAdd!=null)?E.optAdd:0;var A=(E.optEdit!=undefined&&E.optEdit!=null)?E.optEdit:0;O.setAttribute("optAdd",E.optAdd);O.setAttribute("optEdit",E.optEdit);P.appendChild(O)}var F=R.fks;if(F!=undefined&&F.length>0){for(var K=0;K<F.length;K++){var I=F[K];var J=M.createElement("ref");J.setAttribute("column",I.column);J.setAttribute("refTable",I.refTable);J.setAttribute("refColumn",I.refColumn);P.appendChild(J)}}D.appendChild(P)}};FormXml.prototype.setValidate=function(C,M,O){var N=O.createElement("validator");if(M.isNull!=undefined&&M.isNull!=""&&M.isNull!=0){var H=O.createElement("isNull");H.textContent=M.isNull;N.appendChild(H)}if(M.nullMsg!=undefined&&M.nullMsg!=""){var I=O.createElement("nullMsg");I.textContent=M.nullMsg;N.appendChild(I)}if(M.maxLength!=undefined&&M.maxLength!=""){var E=O.createElement("maxLength");E.textContent=M.maxLength;N.appendChild(E)}if(M.maxLengthMsg!=undefined&&M.maxLengthMsg!=""){var L=O.createElement("maxLengthMsg");L.textContent=M.maxLengthMsg;N.appendChild(L)}if(M.minLength!=undefined&&M.minLength!=""){var F=O.createElement("minLength");F.textContent=M.minLength;N.appendChild(F)}if(M.minLengthMsg!=undefined&&M.minLengthMsg!=""){var B=O.createElement("minLengthMsg");B.textContent=M.minLengthMsg;N.appendChild(B)}if(M.maxValue!=undefined&&M.maxValue!=""){var R=O.createElement("maxValue");R.textContent=M.maxValue;N.appendChild(R)}if(M.maxValueMsg!=undefined&&M.maxValueMsg!=""){var G=O.createElement("maxValueMsg");G.textContent=M.maxValueMsg;N.appendChild(G)}if(M.minValue!=undefined&&M.minValue!=""){var P=O.createElement("minValue");P.textContent=M.minValue;N.appendChild(P)}if(M.minValueMsg!=undefined&&M.minValueMsg!=""){var D=O.createElement("minValueMsg");D.textContent=M.minValueMsg;N.appendChild(D)}if(M.regexp!=undefined&&M.regexp!=""){var Q=O.createElement("regexp");Q.textContent=M.regexp;N.appendChild(Q)}if(M.regexpMsg!=undefined&&M.regexpMsg!=""){var J=O.createElement("regexpMsg");J.textContent=M.regexpMsg;N.appendChild(J)}if(M.specialReg!=undefined&&M.specialReg!=""){var A=O.createElement("specialReg");A.textContent=M.specialReg;N.appendChild(A)}if(M.specialRegMsg!=undefined&&M.specialRegMsg!=""){var K=O.createElement("specialRegMsg");K.textContent=M.specialRegMsg;N.appendChild(K)}if(N.childNodes.length>0){C.appendChild(N)}};FormXml.prototype.setCmpStyle=function(G,D,C){if(D==null){return }var H=C.createElement("cmpStyle");if(D.border!=undefined&&D.border!=""){var F=C.createElement("border");F.textContent=D.border;H.appendChild(F)}if(D.percentWidth!=undefined&&D.percentWidth!=""){var B=C.createElement("percentWidth");B.textContent=D.percentWidth;H.appendChild(B)}if(D.percentHeight!=undefined&&D.percentHeight!=""){var J=C.createElement("percentHeight");J.textContent=D.percentHeight;H.appendChild(J)}if(D.background!=undefined&&D.background!=null){var A=C.createElement("background");A.textContent=D.background;H.appendChild(A)}if(D.borderColor!=undefined&&D.borderColor!=null){var I=C.createElement("borderColor");I.textContent=D.borderColor;H.appendChild(I)}if(D.iconColor!=undefined&&D.iconColor!=null){var E=C.createElement("iconColor");E.textContent=D.iconColor;H.appendChild(E)}if(H.childNodes.length>0){G.appendChild(H)}};FormXml.prototype.setEvent=function(L,I,D){var E=D.createElement("event");if(I.init!=undefined&&I.init!=""){var J=D.createElement("init");J.textContent=I.init;E.appendChild(J)}if(I.click!=undefined&&I.click!=""){var A=D.createElement("click");A.textContent=I.click;E.appendChild(A)}if(I.change!=undefined&&I.change!=""){var F=D.createElement("change");F.textContent=I.change;E.appendChild(F)}if(I.focus!=undefined&&I.focus!=""){var C=D.createElement("focus");C.textContent=I.focus;E.appendChild(C)}if(I.submit!=undefined&&I.submit!=""){var B=D.createElement("submit");B.textContent=I.submit;E.appendChild(B)}if(I.keyup!=undefined&&I.keyup!=""){var H=D.createElement("keyup");H.textContent=I.keyup;E.appendChild(H)}if(I.keydown!=undefined&&I.keydown!=""){var K=D.createElement("keydown");K.textContent=I.keydown;E.appendChild(K)}if(I.blur!=undefined&&I.blur!=""){var G=D.createElement("blur");G.textContent=I.blur;E.appendChild(G)}if(E.childNodes.length>0){L.appendChild(E)}};FormXml.prototype.createAttr=function(M,F){var P=F.createElement("attr");var J=M.validates;if(J!=undefined){var D=F.createElement("validates");for(var G=0;G<J.length;G++){var N=J[G];var Q=F.createElement("validate");var E=F.createElement("exeType");E.textContent=N.exeType;Q.appendChild(E);var I=F.createElement("exp");I.textContent=N.exp;Q.appendChild(I);var A=F.createElement("msg");A.textContent=N.msg;Q.appendChild(A);D.appendChild(Q)}P.appendChild(D)}var B=M.sqlCommands;if(B!=undefined){var C=F.createElement("sqlCommands");for(var G=0;G<B.length;G++){var O=B[G];var L=F.createElement("sqlCommand");var E=F.createElement("exeType");E.textContent=O.exeType;L.appendChild(E);var H=F.createElement("exePoint");H.textContent=O.exePoint;L.appendChild(H);var K=F.createElement("dsName");K.textContent=O.dsName;L.appendChild(K);C.appendChild(L)}P.appendChild(C)}return P};FormXml.prototype.createFileImportNode=function(C,G){var E=G.createElement("fileImport");if(C.xlsEnabled){if(C.type!=undefined){var D=G.createElement("type");D.textContent=C.type;E.appendChild(D)}if(C.xlsEnabled!=undefined){var A=G.createElement("xlsEnabled");A.textContent=C.xlsEnabled;E.appendChild(A)}if(C.startRow!=undefined){var B=G.createElement("startRow");B.textContent=C.startRow;E.appendChild(B)}if(C.mappingType!=undefined){var F=G.createElement("mappingType");F.textContent=C.mappingType;E.appendChild(F)}}return E};FormXml.prototype.createCellStyle=function(E,G,H){var F=$(E.o);if(F.hasClass("bold")){var I=H.createElement("fontWeight");I.textContent="bold";G.appendChild(I)}if(F.hasClass("italic")){var K=H.createElement("fontStyle");K.textContent="italic";G.appendChild(K)}if(F.hasClass("underline")){var P=H.createElement("textDecoration");P.textContent="underline";G.appendChild(P)}var C=grid.style(F);if(C["font-size"]){var O=C["font-size"];if(O!="12px"){var N=H.createElement("fontSize");N.textContent=O.substring(0,O.length-2);G.appendChild(N)}}if(C["background"]){var B=H.createElement("backgroundColor");B.textContent=C["background"];G.appendChild(B)}if(C["color"]){var D=H.createElement("color");D.textContent=C["color"];G.appendChild(D)}var M=F.attr("valign");if(M!=undefined&&M!=""&&M!="top"){var L=H.createElement("verticalAlign");L.textContent=M;G.appendChild(L)}var J=F.attr("align");if(J!=undefined&&J!=""&&J!="left"){var A=H.createElement("horizontalAlign");A.textContent=J;G.appendChild(A)}};FormXml.prototype.setBorderStyle=function(A,D,E){var F=D.borderColor;if(!D.borderColor){return }for(var B in F){var C=E.createElement("border");C.setAttribute("side",B);C.setAttribute("color",F[B]);A.appendChild(C)}};FormXml.prototype.setCellLines=function(K,A,E){var H=A.content;if(!A.celllines||A.celllines==null){return }var D=A.celllines;for(var F=0;F<D.length;F++){var G=$(D[F]);var C=$(G.data("t"));var B=G.position().left-C.position().left;var J=G.position().top-C.position().top;var I=E.createElement("point");I.setAttribute("x",Math.round(B));I.setAttribute("y",Math.round(J));I.setAttribute("sx",0);I.setAttribute("sy",0);K.appendChild(I)}};FormXml.prototype.parse=function(H){if(H==""){return }if(!H.startsWith("<?xml")){H='<?xml version="1.0" encoding="UTF-8"?>'+H}var E=JSXML.fromString(H);var M=E.childNodes;var N=M[0];var K=N.childNodes;for(var G=0;G<K.length;G++){var B=K[G];if(B.nodeName=="name"){jform.name=B.textContent}else{if(B.nodeName=="relative"){jform.relative=this.getNodeInt(B)}else{if(B.nodeName=="cells"){this.parseCells(B)}else{if(B.nodeName=="mapping"){this.parseMapping(B)}else{if(B.nodeName=="datasets"){this.parseDatasets(B)}else{if(B.nodeName=="report"){this.parseJformReport(B)}else{if(B.nodeName=="list"){jform.reportXml=B.textContent}else{if(B.nodeName=="args"){this.parseHiddens(B)}else{if(B.nodeName=="attr"){this.parseJformAttr(B)}else{if(B.nodeName=="canvas"){this.parseCanvas(B,grid)}else{if(B.nodeName=="fileImport"){this.parseFileImport(B)}else{if(B.nodeName=="developer"){jform.developer=this.parseDeveloper(B)}}}}}}}}}}}}}var J=jform.rowType;if(J!=undefined){for(var L in J){var A=grid.getGridCell(parseInt(L)-1,-1,1,1);A.setFirstColIcon("<i class='icon iconfont icon-arrowsdownline red'></i>")}}var I=grid.tb.children();for(var G=1;G<I.length;G++){var F=$(I[G]).children("td");for(var D=1;D<F.length;D++){var C=$(F[D]);var A=C.data("gc");grid.tdBorderColor(A)}}};FormXml.prototype.parseShareDataSet=function(D){var E=JSXML.fromString(D);var C=E.childNodes;var B=C[0];var A=B.childNodes[0];return this.parseDataset(A)};FormXml.prototype.parseDatasets=function(C){var F=C.childNodes;var D={};for(var B=0;B<F.length;B++){var A=F[B];if(A.nodeName=="dataset"){var E=this.parseDataset(A);D[E.name]=E}}jform.ds=D;anyExcel.initLeftDatasetTree()};FormXml.prototype.parseDataset=function(E){var I={};var K=E.childNodes;for(var J=0;J<K.length;J++){var A=K[J];var N=A.nodeName;if(N=="name"){I.name=A.textContent}else{if(N=="source"){I.sourceName=A.textContent}else{if(N=="sql"){I.sql=A.textContent}else{if(N=="pageSize"){I.pageSize=this.getNodeInt(A)}else{if(N=="type"){I.type=this.getNodeInt(A)}else{if(N=="parser"){I.parser=this.getNodeInt(A)}else{if(N=="columns"){var B=A.childNodes;var F=new Array();for(var H=0;H<B.length;H++){var G=B[H];F.push(G.textContent)}I.columns=F}else{if(N=="args"){var P=A.childNodes;var L=new Array();for(var H=0;H<P.length;H++){var O={};var D=P[H];var C=D.childNodes;for(var M=0;M<C.length;M++){var Q=C[M];if(Q.nodeName=="name"){O.name=Q.textContent}else{if(Q.nodeName=="dataType"){O.dataType=this.getNodeInt(Q)}else{if(Q.nodeName=="value"){O.value=Q.textContent}else{if(Q.nodeName=="modelType"){O.modelType=Q.textContent}else{if(Q.nodeName=="dateFormat"){O.dateFormat=Q.textContent}else{if(Q.nodeName=="defaultValueType"){O.defaultValueType=this.getNodeInt(Q)}else{if(Q.nodeName=="defaultValue"){O.defaultValue=Q.textContent}}}}}}}}L.push(O)}I.args=L}}}}}}}}}return I};FormXml.prototype.parseDeveloper=function(G){var E={};var F=new Array();var A=G.childNodes;for(var D=0;D<A.length;D++){var C=A[D];var H=C.nodeName;if(H=="jsCode"){E.jsCode=C.textContent}else{if(H=="cssCode"){E.cssCode=C.textContent}else{if(H=="file"){var B={};B.jslib=C.getAttribute("jslib");B.jsPath=C.getAttribute("jsPath");F.push(B)}}}}if(F.length>0){E.files=F}return E};FormXml.prototype.parseCells=function(D){var B=D.childNodes;for(var C=0;C<B.length;C++){var A=B[C];if(A.nodeName=="htmlcell"){this.parseHtmlCell(A,grid)}else{if(A.nodeName=="columncell"){this.parseColumnCell(A)}else{if(A.nodeName=="compcell"){this.parseComponentCell(A)}}}}};FormXml.prototype.parseCanvas=function(D,A){var F=D.childNodes;for(var C=0;C<F.length;C++){var B=F[C];var E=B.nodeName;if(E=="columns"){this.parseColumns(B,A)}else{if(E=="rows"){this.parseRows(B,A)}}}};FormXml.prototype.parseColumns=function(E,B){var H=E.childNodes;var C=0;for(var G=0;G<H.length;G++){var A=H[G];if(A.nodeName=="column"){var I=parseInt(A.getAttribute("w"));var D=B.getGridCell(-1,C,1,1);var F=$(D.o);F.width(I);B.syncGridColDivs(F,I);B.syncGrids();C++}}};FormXml.prototype.parseRows=function(D,B){var H=D.childNodes;var I=0;for(var F=0;F<H.length;F++){var A=H[F];if(A.nodeName=="row"){var G=parseInt(A.getAttribute("h"));var C=B.getGridCell(F,-1,1,1);var E=$(C.o);E.height(G);B.syncGridRowDivs(E,G);B.syncGrids();I++}}};FormXml.prototype.parseHtmlCell=function(H,C){var P=parseInt(H.getAttribute("rowNum"));var D=parseInt(H.getAttribute("colNum"));var M=parseInt(H.getAttribute("rowSpan"));var K=parseInt(H.getAttribute("colSpan"));var F=C.getGridCell(P,D,M,K);F.mark=0;var L=F.content;var I=$(F.o);var B=H.childNodes;for(var J=0;J<B.length;J++){var E=B[J];if(E.nodeName=="#text"){continue}if(E.nodeName=="name"){F.name=E.textContent;F.setText(F.name)}else{if(E.nodeName=="point"){var O=parseInt(E.getAttribute("x"));var N=parseInt(E.getAttribute("y"));grid.startDrawCellLine(F,O,N)}else{if(E.nodeName=="border"){var G=F.borderColor?F.borderColor:{};var Q=E.getAttribute("side");var A=E.getAttribute("color");G[Q]=A;F.borderColor=G}else{this.parseStyle(E,F)}}}}};FormXml.prototype.parseColumnCell=function(F){var M=parseInt(F.getAttribute("rowNum"));var C=parseInt(F.getAttribute("colNum"));var K=parseInt(F.getAttribute("rowSpan"));var I=parseInt(F.getAttribute("colSpan"));var D=grid.getGridCell(M,C,K,I);D.mark=1;var O=D.content;var G=$(D.o);var J=F.childNodes;for(var H=0;H<J.length;H++){var B=J[H];var L=B.nodeName;if(L=="#text"){continue}if(L=="name"){O.name=B.textContent}else{if(L=="expression"){O.expression=B.textContent}else{if(L=="formatId"){O.formatId=B.textContent}else{if(L=="border"){var E=D.borderColor?D.borderColor:{};var N=B.getAttribute("side");var A=B.getAttribute("color");E[N]=A;D.borderColor=E}else{this.parseStyle(B,D)}}}}}if(O.name!=undefined){D.setText(O.name)}};FormXml.prototype.parseComponentCell=function(G){var P=parseInt(G.getAttribute("rowNum"));var C=parseInt(G.getAttribute("colNum"));var N=parseInt(G.getAttribute("rowSpan"));var L=parseInt(G.getAttribute("colSpan"));var E=grid.getGridCell(P,C,N,L);E.mark=2;var I=E.content;var M=G.childNodes;for(var H=0;H<M.length;H++){var B=M[H];var O=B.nodeName;if(O=="verticalCount"){I.verticalCount=this.getNodeInt(B)}else{if(O=="form"){var D=this.parseFormComponent(B);var J=I.components!=undefined?I.components:new Array();J.push(D);I.components=J}else{if(O=="border"){var F=E.borderColor?E.borderColor:{};var Q=B.getAttribute("side");var A=B.getAttribute("color");F[Q]=A;E.borderColor=F}else{this.parseStyle(B,E)}}}}if(I.verticalCount!=undefined){var K=jform.rowType!=undefined?jform.rowType:{};K[P+1]=I.verticalCount;jform.rowType=K}anyExcel.initComponent(E)};FormXml.prototype.parseFormComponent=function(C){var D={};var F=C.childNodes;for(var B=0;B<F.length;B++){var A=F[B];var E=A.nodeName;if(E=="name"){D.name=A.textContent}else{if(E=="desc"){D.desc=A.textContent}else{if(E=="height"){D.height=this.getNodeInt(A)}else{if(E=="heightUnit"){D.heightUnit=A.textContent}else{if(E=="width"){D.width=this.getNodeInt(A)}else{if(E=="widthUnit"){D.widthUnit=A.textContent}else{if(E=="readOnly"){D.readOnly=this.getNodeInt(A)}else{if(E=="display"){D.display=this.getNodeInt(A)}else{if(E=="dataType"){D.dataType=this.getNodeInt(A)}else{if(E=="defaultValueType"){D.defaultValueType=this.getNodeInt(A)}else{if(E=="defaultValue"){D.defaultValue=A.textContent}else{if(E=="editStyle"){D.editStyle=this.getNodeInt(A)}else{if(E=="dateFormat"){D.dateFormat=A.textContent}else{if(E=="formatId"){D.formatId=A.textContent}else{if(E=="linkCmopName"){D.linkCmopName=A.textContent}else{if(E=="multiselect"){D.multiselect=this.getNodeInt(A)}else{if(E=="nowUpload"){D.nowUpload=this.getNodeInt(A)}else{if(E=="select"){this.parseSelect(A,D)}else{if(E=="tree"){this.parseTree(A,D)}else{if(E=="group"){this.parseGroup(A,D)}else{if(E=="cmpStyle"){this.parseCmpStyle(A,D)}else{if(E=="validator"){this.parseValidator(A,D)}else{if(E=="event"){this.parseEvent(A,D)}else{if(E=="sequences"){this.parseSequences(A,D)}}}}}}}}}}}}}}}}}}}}}}}}}return D};FormXml.prototype.parseSelect=function(A,C){var E=C.data!=undefined?C.data:{};var H=A.childNodes;if(C.editStyle==2){var J={};for(var F=0;F<H.length;F++){var B=H[F];if(B.nodeName=="#text"){continue}var K=B.getAttribute("value");var L=B.textContent;J[K]=L}E.dataMap=J}else{var G={};for(var D=0;D<H.length;D++){var M=H[D];var I=M.nodeName;if(I=="code"){G.code=M.textContent}else{if(I=="label"){G.label=M.textContent}else{if(I=="dsName"){G.dsName=M.textContent}}}}E.dataSql=G}C.data=E};FormXml.prototype.parseTree=function(B,G){var E=G.data!=undefined?G.data:{};var D={};var H=B.childNodes;for(var A=0;A<H.length;A++){var F=H[A];var C=F.nodeName;if(C=="code"){D.code=F.textContent}else{if(C=="pcode"){D.pcode=F.textContent}else{if(C=="label"){D.label=F.textContent}else{if(C=="saveCode"){D.saveCode=F.textContent}else{if(C=="dsName"){D.dsName=F.textContent}}}}}}E.dataSql=D;G.data=E};FormXml.prototype.parseGroup=function(A,B){var C=B.data!=undefined?B.data:{};var E=A.childNodes;var F={};for(var D=0;D<E.length;D++){var G=E[D];if(G.nodeName=="#text"){continue}var I=G.getAttribute("value");var H=G.getAttribute("label");F[I]=H}if($.isEmptyObject(F)){F[""]=""}C.dataMap=F;B.data=C};FormXml.prototype.parseCmpStyle=function(C,E){var D={};var G=C.childNodes;for(var B=0;B<G.length;B++){var A=G[B];var F=A.nodeName;if(F=="border"){D.border=A.textContent}else{if(F=="percentWidth"){D.percentWidth=this.getNodeInt(A)}else{if(F=="percentHeight"){D.percentHeight=this.getNodeInt(A)}else{if(F=="background"){D.background=A.textContent}else{if(F=="borderColor"){D.borderColor=A.textContent}else{if(F=="iconColor"){D.iconColor=A.textContent}}}}}}}E.cmpStyle=D};FormXml.prototype.parseValidator=function(C,E){var B={};var G=C.childNodes;for(var A=0;A<G.length;A++){var D=G[A];var F=D.nodeName;if(F=="isNull"){B.isNull=this.getNodeInt(D)}else{if(F=="nullMsg"){B.nullMsg=D.textContent}else{if(F=="maxLength"){B.maxLength=this.getNodeInt(D)}else{if(F=="maxLengthMsg"){B.maxLengthMsg=D.textContent}else{if(F=="minLength"){B.minLength=this.getNodeInt(D)}else{if(F=="minLengthMsg"){B.minLengthMsg=D.textContent}else{if(F=="maxValue"){B.maxValue=D.textContent}else{if(F=="maxValueMsg"){B.maxValueMsg=D.textContent}else{if(F=="minValue"){B.minValue=D.textContent}else{if(F=="minValueMsg"){B.minValueMsg=D.textContent}else{if(F=="regexp"){B.regexp=D.textContent}else{if(F=="regexpMsg"){B.regexpMsg=D.textContent}else{if(F=="specialReg"){B.specialReg=D.textContent}else{if(F=="specialRegMsg"){B.specialRegMsg=D.textContent}}}}}}}}}}}}}}}E.validator=B};FormXml.prototype.parseEvent=function(B,E){var D={};var G=B.childNodes;for(var A=0;A<G.length;A++){var C=G[A];var F=C.nodeName;if(F=="init"){D.init=C.textContent}else{if(F=="click"){D.click=C.textContent}else{if(F=="change"){D.change=C.textContent}else{if(F=="focus"){D.focus=C.textContent}else{if(F=="submit"){D.submit=C.textContent}else{if(F=="keyup"){D.keyup=C.textContent}else{if(F=="keydown"){D.keydown=C.textContent}else{if(F=="blur"){D.blur=C.textContent}}}}}}}}}E.event=D};FormXml.prototype.parseSequences=function(B,C){var D={};var J=new Array();var I=B.childNodes;for(var G=0;G<I.length;G++){var F=I[G];var K=F.nodeName;if(K=="createType"){D.createType=this.getNodeInt(F)}else{if(K=="sequence"){var E={};var L=F.childNodes;for(var M=0;M<L.length;M++){var A=L[M];var H=A.nodeName;if(H=="type"){E.type=this.getNodeInt(A)}else{if(H=="id"){E.id=A.textContent}else{if(H=="text"){E.text=A.textContent}else{if(H=="dateFormat"){E.dateFormat=A.textContent}else{if(H=="numCount"){E.numCount=this.getNodeInt(A)}else{if(H=="isPrefixZero"){E.isPrefixZero=this.getNodeBoolean(A)}else{if(H=="isResetTime"){E.isResetTime=this.getNodeBoolean(A)}else{if(H=="resetTimeUnit"){E.resetTimeUnit=this.getNodeInt(A)}}}}}}}}}J.push(E)}}}D.sequences=J;C.formSequence=D};FormXml.prototype.parseMapping=function(E){var G=E.childNodes;var K=jform.database!=undefined?jform.database:{};var H=new Array();for(var N=0;N<G.length;N++){var P=G[N];var A=P.nodeName;if(A=="table"){var Q={};var R=P.getAttribute("name");var L=P.getAttribute("source");var F=P.getAttribute("schema");Q.name=R;Q.schema=F;Q.source=L;K.sourceName=L;K.schemaName=F;var C=P.childNodes;var B=new Array();var I=new Array();for(var O=0;O<C.length;O++){var M=C[O];var A=M.nodeName;if(A=="column"){var D={};D.length=M.getAttribute("length");D.formName=M.getAttribute("formName");D.columnName=M.getAttribute("name");D.formNameDesc=M.getAttribute("formNameDesc");D.isPk=M.getAttribute("ispk");D.dataType=M.getAttribute("dataType");D.optAdd=M.getAttribute("optAdd");if(D.optAdd==null||D.optAdd=="null"){D.optAdd=0}D.optEdit=M.getAttribute("optEdit");if(D.optEdit==null||D.optEdit=="null"){D.optEdit=0}B.push(D)}else{if(A=="ref"){var J={};J.column=M.getAttribute("column");J.refColumn=M.getAttribute("refColumn");J.refTable=M.getAttribute("refTable");I.push(J)}}}Q.columns=B;Q.fks=I;H.push(Q)}}K.tables=H;jform.database=K};FormXml.prototype.parseHiddens=function(D){var F=D.childNodes;for(var C=0;C<F.length;C++){var B=F[C];var E=B.nodeName;if(E=="hidden"){var A=jform.hiddens?jform.hiddens:new Array();A.push(this.parseHidden(B));jform.hiddens=A}}};FormXml.prototype.parseHidden=function(C){var D={};var F=C.childNodes;for(var B=0;B<F.length;B++){var A=F[B];var E=A.nodeName;if(E=="name"){D.name=A.textContent}else{if(E=="dataType"){D.dataType=this.getNodeInt(A)}else{if(E=="dateFormat"){D.dateFormat=A.textContent}else{if(E=="defaultValueType"){D.defaultValueType=this.getNodeInt(A)}else{if(E=="defaultValue"){D.defaultValue=A.textContent}}}}}}return D};FormXml.prototype.parseJformAttr=function(D){var H=D.childNodes;var I=jform.attr!=undefined?jform.attr:{};for(var F=0;F<H.length;F++){var A=H[F];var J=A.nodeName;if(J=="validates"){var G=new Array();var C=A.childNodes;for(var E=0;E<C.length;E++){G.push(this.parseAttrValidate(C[E]))}I.validates=G}else{if(J=="sqlCommands"){var B=new Array();var K=A.childNodes;for(var E=0;E<K.length;E++){B.push(this.parseAttrSql(K[E]))}I.sqlCommands=B}}}jform.attr=I};FormXml.prototype.parseFileImport=function(D){var F=D.childNodes;var C={};for(var B=0;B<F.length;B++){var A=F[B];var E=A.nodeName;if(E=="type"){C.type=A.textContent}else{if(E=="xlsEnabled"){C.xlsEnabled=this.getNodeBoolean(A)}else{if(E=="startRow"){C.startRow=this.getNodeInt(A)}else{if(E=="mappingType"){C.mappingType=this.getNodeInt(A)}}}}}jform.fileImport=C};FormXml.prototype.parseAttrValidate=function(C){var F=C.childNodes;var D={};for(var B=0;B<F.length;B++){var A=F[B];var E=A.nodeName;if(E=="exp"){D.exp=A.textContent}else{if(E=="exeType"){D.exeType=A.textContent}else{if(E=="msg"){D.msg=A.textContent}}}}return D};FormXml.prototype.parseAttrSql=function(D){var F=D.childNodes;var C={};for(var B=0;B<F.length;B++){var A=F[B];var E=A.nodeName;if(E=="exeType"){C.exeType=this.getNodeInt(A)}else{if(E=="exePoint"){C.exePoint=this.getNodeInt(A)}else{if(E=="dsName"){C.dsName=A.textContent}}}}return C};FormXml.prototype.parseDataFilter=function(B){var G=B.childNodes;var F=new Array();for(var C=0;C<G.length;C++){var A=G[C];if(A.nodeName=="#text"){continue}var D=this.parseConditionContent(A);F.push(D)}var E={};E.conditions=F;return E};FormXml.prototype.parseConditionContent=function(A){var D={};var F=A.childNodes;for(var C=0;C<F.length;C++){var B=F[C];var E=B.nodeName;if(E=="symbol"){D.symbol=this.getNodeInt(B)}else{if(E=="column"){D.column=B.textContent}else{if(E=="type"){D.type=this.getNodeInt(B)}else{if(E=="logic"){D.logic=this.getNodeInt(B)}else{if(E=="value"){D.value=B.textContent}}}}}}return D};FormXml.prototype.parseStyle=function(G,F){var C=$(F.o);if(G.nodeName=="fontWeight"){if(G.textContent=="bold"){C.addClass("bold")}}else{if(G.nodeName=="fontStyle"){if(G.textContent=="italic"){C.addClass("italic")}}else{if(G.nodeName=="textDecoration"){if(G.textContent=="underline"){C.addClass("underline")}}else{if(G.nodeName=="fontSize"){var E=this.getNodeInt(G,12);C.css("font-size",E)}else{if(G.nodeName=="verticalAlign"){var B=G.textContent;C.attr("valign",B);if(B=="top"){C.addClass("vtop")}else{if(B=="middle"){C.addClass("vmiddle")}else{if(B=="bottom"){C.addClass("vbottom")}}}}else{if(G.nodeName=="horizontalAlign"){C.attr("align",G.textContent)}else{if(G.nodeName=="backgroundColor"){var D=G.textContent.startsWith("#")?G.textContent:"#"+G.textContent;C.css("background",D)}else{if(G.nodeName=="color"){var A=G.textContent.startsWith("#")?G.textContent:"#"+G.textContent;C.css("color",A)}}}}}}}}};FormXml.prototype.parseJformReport=function(B){var K=jform.database;var E=function(N){var P=K.tables;for(var O=0;O<P.length;O++){if(N==P[O].name){return P[O]}}return null};var G={};var I=new Array();var L=new Array();var F=B.childNodes;for(var D=0;D<F.length;D++){var A=F[D];var H=A.nodeName;if(H=="table"){var J=A.getAttribute("name");var M=E(J);if(M==null){M=new Table();M.name=J}G.table=M}if(H=="condition"){if(G.table!=null){var C=A.getAttribute("columnName");I.push(C)}}if(H=="list"){if(G.table!=null){var C=A.getAttribute("columnName");L.push(C)}}}G.conditions=I;G.lists=L;jform.dataList=G};FormXml.prototype.parseView=function(D){var I=D.childNodes;for(var G=0;G<I.length;G++){var A=I[G];var J=A.nodeName;if(J=="fixed"){this.parseFixed(A)}else{if(J=="divide"){var H=report.reportView?report.reportView:{};var C=this.parseDivide(A);H.columnDivide=C;report.reportView=H}}}if(!report.reportView){return }if(!report.reportView.fixedCell){return }var K=report.reportView.fixedCell;var L=K.rows;if(L!=undefined&&L.length>0){for(var G=0;G<L.length;G++){var B=grid.getGridCell(L[G]-1,-1,1,1);var F=$(B.o);F.find("div").append("<i class='icon iconfont icon-dongjiexing icon-size-12'></i>")}}var E=K.columns;if(E!=undefined&&E.length>0){for(var G=0;G<E.length;G++){var B=grid.getGridCell(-1,E[G]-1,1,1);var F=$(B.o);F.find("div").append("<i class='icon iconfont icon-liedongjie- icon-size-12'></i>")}}};FormXml.prototype.parseFixed=function(D){var I=D.childNodes;for(var G=0;G<I.length;G++){var B=I[G];var N=B.nodeName;if(N=="rows"){var J=B.textContent;var P=J.split(",");for(var A=0;A<P.length;A++){var M=parseInt(P[A]);var H=report.reportView?report.reportView:{};var O=H.fixedCell?H.fixedCell:{};var Q=O.rows?O.rows:new Array();Q.push(M+1);O.rows=Q;H.fixedCell=O;report.reportView=H}}else{if(N=="cols"){var F=B.textContent;var L=F.split(",");for(var K=0;K<L.length;K++){var C=parseInt(L[K]);var H=report.reportView?report.reportView:{};var O=H.fixedCell?H.fixedCell:{};var E=O.columns?O.columns:new Array();E.push(C+1);O.columns=E;H.fixedCell=O;report.reportView=H}}}}};FormXml.prototype.getNodeInt=function(C,B){var A=parseInt(C.textContent);if(isNaN(A)){return B!=undefined?B:0}return A};FormXml.prototype.getNodeNumber=function(C,B){var A=parseFloat(C.textContent);if(isNaN(A)){return B!=undefined?B:0}return A};FormXml.prototype.getNodeBoolean=function(C,B){var A=C.textContent;if(A=="true"){return true}if(A==""){return B!=undefined?B:false}return false}